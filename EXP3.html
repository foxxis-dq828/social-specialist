<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>data_analysis tau for social agent exp3 (revise expertise information)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="data_analysis tau for social agent exp3_files/libs/clipboard/clipboard.min.js"></script>
<script src="data_analysis tau for social agent exp3_files/libs/quarto-html/quarto.js"></script>
<script src="data_analysis tau for social agent exp3_files/libs/quarto-html/popper.min.js"></script>
<script src="data_analysis tau for social agent exp3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="data_analysis tau for social agent exp3_files/libs/quarto-html/anchor.min.js"></script>
<link href="data_analysis tau for social agent exp3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="data_analysis tau for social agent exp3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="data_analysis tau for social agent exp3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="data_analysis tau for social agent exp3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="data_analysis tau for social agent exp3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">data_analysis tau for social agent exp3 (revise expertise information)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">Load the Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/Users/foxxis/Documents/social induction/experiment data/exp3/final_data.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="descriptive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-analysis">Descriptive Analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">age =</span> <span class="fu">as.numeric</span>(age),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">education =</span> <span class="fu">as.numeric</span>(education),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Group =</span> <span class="fu">as.factor</span>(Group),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">gender =</span> <span class="fu">as.factor</span>(gender)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(final_data[, <span class="fu">c</span>(<span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"totalcorrect"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      age          education      totalcorrect   
 Min.   :19.00   Min.   :2.000   Min.   :0.2000  
 1st Qu.:30.00   1st Qu.:3.000   1st Qu.:0.6000  
 Median :37.50   Median :4.000   Median :0.8000  
 Mean   :39.72   Mean   :3.792   Mean   :0.7688  
 3rd Qu.:50.00   3rd Qu.:4.000   3rd Qu.:0.9000  
 Max.   :74.00   Max.   :5.000   Max.   :1.2000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(final_data<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
female   male 
    49     47 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(final_data<span class="sc">$</span>Group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2 
47 49 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 转换为 numeric 类型（强制转换为数值）</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ear =</span> <span class="fu">as.numeric</span>(Ear),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Foot =</span> <span class="fu">as.numeric</span>(Foot),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">div =</span> <span class="fu">as.numeric</span>(div),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodiv1 =</span> <span class="fu">as.numeric</span>(nodiv1),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">nodiv2 =</span> <span class="fu">as.numeric</span>(nodiv2)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择需要统计的列</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>rate_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Ear, Foot, div, nodiv1, nodiv2)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 基本描述性统计</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="ot">&lt;-</span> <span class="fu">summary</span>(rate_data)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(summary_stats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Ear             Foot            div           nodiv1          nodiv2     
 Min.   :25.00   Min.   :10.00   Min.   : 2.0   Min.   : 1.00   Min.   : 1.00  
 1st Qu.:50.00   1st Qu.:40.00   1st Qu.:33.0   1st Qu.:20.00   1st Qu.:15.00  
 Median :50.00   Median :50.00   Median :50.0   Median :30.00   Median :25.00  
 Mean   :53.78   Mean   :46.22   Mean   :49.6   Mean   :27.22   Mean   :23.18  
 3rd Qu.:60.00   3rd Qu.:50.00   3rd Qu.:60.0   3rd Qu.:35.00   3rd Qu.:30.75  
 Max.   :90.00   Max.   :75.00   Max.   :98.0   Max.   :70.00   Max.   :50.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ear_bigger <span class="ot">&lt;-</span> <span class="fu">sum</span>(final_data<span class="sc">$</span>Ear <span class="sc">&gt;</span> final_data<span class="sc">$</span>Foot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>foot_bigger <span class="ot">&lt;-</span> <span class="fu">sum</span>(final_data<span class="sc">$</span>Ear <span class="sc">&lt;</span> final_data<span class="sc">$</span>Foot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>equal <span class="ot">&lt;-</span> <span class="fu">sum</span>(final_data<span class="sc">$</span>Ear <span class="sc">==</span> final_data<span class="sc">$</span>Foot, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ear &gt; Foot:"</span>, ear_bigger<span class="sc">/</span><span class="dv">96</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ear &gt; Foot: 0.3958333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Foot &gt; Ear:"</span>, foot_bigger<span class="sc">/</span><span class="dv">96</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Foot &gt; Ear: 0.15625 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Foot = Ear:"</span>, equal<span class="sc">/</span><span class="dv">96</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Foot = Ear: 0.4479167 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 转为长格式</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ip, div, nodiv1, nodiv2) <span class="sc">%&gt;%</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(div, nodiv1, nodiv2),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"type"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive stats by condition</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>desc_stats <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_summary_stats</span>(value, </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">"mean_sd"</span>) <span class="sc">%&gt;%</span>      <span class="co"># mean ± SD</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>     plot_data <span class="sc">%&gt;%</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">median =</span> <span class="fu">median</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">min    =</span> <span class="fu">min</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">max    =</span> <span class="fu">max</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci_low =</span> <span class="fu">mean_cl_normal</span>(value)<span class="sc">$</span>ymin,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">ci_up  =</span> <span class="fu">mean_cl_normal</span>(value)<span class="sc">$</span>ymax,</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"type"</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>desc_stats</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  type   variable     n  mean    sd median   min   max ci_low ci_up
  &lt;chr&gt;  &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 div    value       96  49.6  22.1     50     2    98   45.1  54.1
2 nodiv1 value       96  27.2  13.4     30     1    70   24.5  29.9
3 nodiv2 value       96  23.2  11.5     25     1    50   20.8  25.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Assumption checks (optional but recommended) ----</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Normality (per condition)</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plot_data  <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> <span class="fu">shapiro_test</span>(value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  type   variable statistic        p
  &lt;chr&gt;  &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 div    value        0.942 0.000369
2 nodiv1 value        0.969 0.0233  
3 nodiv2 value        0.968 0.0203  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Repeated-measures ANOVA ----</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Mauchly’s test for sphericity &amp; GG/HF corrections</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>anova_res <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> plot_data, <span class="at">dv =</span> value, <span class="at">wid =</span> ip, <span class="at">within =</span> type,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">effect.size =</span> <span class="st">"pes"</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(anova_res, <span class="at">correction =</span> <span class="st">"GG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

  Effect  DFn    DFd      F        p p&lt;.05   pes
1   type 1.18 111.98 48.641 1.72e-11     * 0.339</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Post hoc: paired t-tests with multiplicity control ----</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(value <span class="sc">~</span> type, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_significance</span>()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect sizes (paired Cohen's d)</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>es <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cohens_d</span>(value <span class="sc">~</span> type, <span class="at">paired =</span> <span class="cn">TRUE</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>pwc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  .y.   group1 group2    n1    n2 statistic    df        p    p.adj p.adj.signif
  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
1 value div    nodiv1    96    96      6.33    95 8.16e- 9 2.45e- 8 ****        
2 value div    nodiv2    96    96      7.95    95 3.83e-12 1.15e-11 ****        
3 value nodiv1 nodiv2    96    96      3.38    95 1   e- 3 3   e- 3 **          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>es</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  .y.   group1 group2 effsize    n1    n2 magnitude
* &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;ord&gt;    
1 value div    nodiv1   0.646    96    96 moderate 
2 value div    nodiv2   0.811    96    96 large    
3 value nodiv1 nodiv2   0.345    96    96 small    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- (Optional) Pretty plot with p-values overlaid ----</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(plot_data, <span class="at">x =</span> <span class="st">"type"</span>, <span class="at">y =</span> <span class="st">"value"</span>, <span class="at">add =</span> <span class="st">"point"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># position labels for stat_pvalue_manual</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>pwc_plot <span class="ot">&lt;-</span> pwc <span class="sc">%&gt;%</span> <span class="fu">add_xy_position</span>(<span class="at">x =</span> <span class="st">"type"</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>bxp <span class="sc">+</span> <span class="fu">stat_pvalue_manual</span>(pwc_plot, <span class="at">tip.length =</span> <span class="fl">0.01</span>, <span class="at">hide.ns =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Combination"</span>, <span class="at">y =</span> <span class="st">"Rating"</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"ANOVA (GG-corrected): F ="</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">round</span>(<span class="fu">get_anova_table</span>(anova_res, <span class="at">correction =</span> <span class="st">"GG"</span>)<span class="sc">$</span>F[<span class="dv">1</span>], <span class="dv">2</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">", p ="</span>,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">signif</span>(<span class="fu">get_anova_table</span>(anova_res, <span class="at">correction =</span> <span class="st">"GG"</span>)<span class="sc">$</span>p[<span class="dv">1</span>], <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘图：每个参与者一条线</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> value, <span class="at">group =</span> ip)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"div"</span> <span class="ot">=</span> <span class="st">"Ear + Foot"</span>, <span class="st">"nodiv1"</span> <span class="ot">=</span> <span class="st">"2 Ear"</span>, <span class="st">"nodiv2"</span> <span class="ot">=</span> <span class="st">"2 Foot"</span>)) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Each Participant's Line Across div, nodiv1, nodiv2"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Rate Type"</span>, <span class="at">y =</span> <span class="st">"Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regression" class="level2">
<h2 class="anchored" data-anchor-id="regression">Regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lmerTest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>condition_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trial=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">A1_knowledge =</span> <span class="fu">c</span>(<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>),</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">A2_knowledge =</span> <span class="fu">c</span>(<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Foot"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>,<span class="st">"Ear"</span>,<span class="st">"Ear"</span>,<span class="st">"Foot"</span>,<span class="st">"Foot"</span>),</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">A1_judgment =</span> <span class="fu">c</span>(<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">A2_judgment =</span> <span class="fu">c</span>(<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>,<span class="st">"Type1"</span>,<span class="st">"Type2"</span>),</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">NB_predict =</span> <span class="fu">c</span>(</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.9999958</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.2735507</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.7765487</span>,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.4667553</span>,</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5992063</span>,</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.9999958</span>,</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.2735507</span>,</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.7765487</span>,</span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.4667553</span>,</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.5992063</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) If you don't already have a participant id, make one</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>participant_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">participant =</span> <span class="fu">row_number</span>())</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Long-format: one row = 1 participant × 1 trial</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a><span class="co">#    Assumes columns p1, p2, ..., p16 are the responses/ratings</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> participant_data <span class="sc">%&gt;%</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">"^p</span><span class="sc">\\</span><span class="st">d+$"</span>)) <span class="sc">%&gt;%</span>               <span class="co"># keep only p1–p16 columns</span></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">participant =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span>       <span class="co"># add participant ID</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">matches</span>(<span class="st">"^p</span><span class="sc">\\</span><span class="st">d+$"</span>),</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to   =</span> <span class="st">"trial"</span>,</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to  =</span> <span class="st">"rating"</span></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trial =</span> <span class="fu">as.integer</span>(<span class="fu">sub</span>(<span class="st">"^p"</span>, <span class="st">""</span>, trial))) <span class="co"># turn "p1" into 1</span></span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Join the trial-level condition table (your condition_df)</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(condition_df, <span class="at">by =</span> <span class="st">"trial"</span>)</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Derive predictors for regression</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>to01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">"Type1"</span>, <span class="sc">-</span><span class="dv">1</span>L, <span class="dv">1</span>L)</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Votes from the two experts (Type1=1, Type2=0)</span></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">Vote1 =</span> <span class="fu">to01</span>(A1_judgment),</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Vote2 =</span> <span class="fu">to01</span>(A2_judgment),</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># NB posterior (rename for clarity + optional z-score)</span></span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">NB =</span> NB_predict,</span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">NB_z =</span> <span class="fu">as.numeric</span>(<span class="fu">scale</span>(NB)),</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">VoteEar  =</span> <span class="fu">ifelse</span>(A1_knowledge <span class="sc">==</span> <span class="st">"Ear"</span>, Vote1, <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">ifelse</span>(A2_knowledge <span class="sc">==</span> <span class="st">"Ear"</span>, Vote2, <span class="dv">0</span>),</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">VoteFoot =</span> <span class="fu">ifelse</span>(A1_knowledge <span class="sc">==</span> <span class="st">"Foot"</span>, Vote1, <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">ifelse</span>(A2_knowledge <span class="sc">==</span> <span class="st">"Foot"</span>, Vote2, <span class="dv">0</span>),</span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">PureVote =</span> Vote1<span class="sc">+</span>Vote2</span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Done. This is your regression-ready table:</span></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a><span class="co">#    rating ~ NB_z + Vote1*Info1 + Vote2*Info2  + (1|participant)</span></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,536
Columns: 15
$ participant  &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, …
$ trial        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1,…
$ rating       &lt;dbl&gt; 1, 2, 6, 6, 2, 4, 2, 5, 1, 1, 6, 6, 2, 5, 2, 5, 2, 4, 2, …
$ A1_knowledge &lt;chr&gt; "Foot", "Foot", "Foot", "Foot", "Ear", "Ear", "Foot", "Fo…
$ A2_knowledge &lt;chr&gt; "Ear", "Ear", "Ear", "Ear", "Ear", "Ear", "Foot", "Foot",…
$ A1_judgment  &lt;chr&gt; "Type1", "Type2", "Type2", "Type1", "Type1", "Type2", "Ty…
$ A2_judgment  &lt;chr&gt; "Type1", "Type2", "Type1", "Type2", "Type1", "Type2", "Ty…
$ NB_predict   &lt;dbl&gt; 0.0000000, 0.0000000, 0.9999958, 1.0000000, 0.2735507, 0.…
$ Vote1        &lt;int&gt; -1, 1, 1, -1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -…
$ Vote2        &lt;int&gt; -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -…
$ NB           &lt;dbl&gt; 0.0000000, 0.0000000, 0.9999958, 1.0000000, 0.2735507, 0.…
$ NB_z         &lt;dbl&gt; -1.3643046, -1.3643046, 1.2873573, 1.2873684, -0.6389376,…
$ VoteEar      &lt;dbl&gt; -1, 1, -1, 1, -2, 2, 0, 0, -1, 1, 1, -1, -2, 2, 0, 0, -1,…
$ VoteFoot     &lt;dbl&gt; -1, 1, 1, -1, 0, 0, -2, 2, -1, 1, -1, 1, 0, 0, -2, 2, -1,…
$ PureVote     &lt;int&gt; -2, 2, 0, 0, -2, 2, -2, 2, -2, 2, 0, 0, -2, 2, -2, 2, -2,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_long, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 15
   participant trial rating A1_knowledge A2_knowledge A1_judgment A2_judgment
         &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;      
 1           1     1      1 Foot         Ear          Type1       Type1      
 2           1     2      2 Foot         Ear          Type2       Type2      
 3           1     3      6 Foot         Ear          Type2       Type1      
 4           1     4      6 Foot         Ear          Type1       Type2      
 5           1     5      2 Ear          Ear          Type1       Type1      
 6           1     6      4 Ear          Ear          Type2       Type2      
 7           1     7      2 Foot         Foot         Type1       Type1      
 8           1     8      5 Foot         Foot         Type2       Type2      
 9           1     9      1 Ear          Foot         Type1       Type1      
10           1    10      1 Ear          Foot         Type2       Type2      
# ℹ 8 more variables: NB_predict &lt;dbl&gt;, Vote1 &lt;int&gt;, Vote2 &lt;int&gt;, NB &lt;dbl&gt;,
#   NB_z &lt;dbl&gt;, VoteEar &lt;dbl&gt;, VoteFoot &lt;dbl&gt;, PureVote &lt;int&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m_wvnb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  rating <span class="sc">~</span> NB_z <span class="sc">+</span> VoteEar <span class="sc">+</span> VoteFoot <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_long</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>m_wv <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  rating <span class="sc">~</span> VoteEar <span class="sc">+</span> VoteFoot <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_long</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>m_nb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  rating <span class="sc">~</span> NB_z <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_long</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>m_voteinfo <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  rating <span class="sc">~</span> PureVote  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_long</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>m_votenb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  rating <span class="sc">~</span>  NB_z <span class="sc">+</span> PureVote  <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_long</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_wvnb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: rating ~ NB_z + VoteEar + VoteFoot + (1 | participant)
   Data: df_long

REML criterion at convergence: 5140.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2288 -0.6364  0.1063  0.7614  3.2639 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.000    0.000   
 Residual                1.645    1.283   
Number of obs: 1536, groups:  participant, 96

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept) 3.499e+00  3.272e-02 1.532e+03 106.912  &lt; 2e-16 ***
NB_z        1.321e-01  3.412e-02 1.532e+03   3.873 0.000112 ***
VoteEar     7.753e-01  2.778e-02 1.532e+03  27.914  &lt; 2e-16 ***
VoteFoot    7.292e-01  2.679e-02 1.532e+03  27.216  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
         (Intr) NB_z   VoteEr
NB_z      0.000              
VoteEar   0.000 -0.273       
VoteFoot  0.000 -0.075  0.020
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: rating ~ NB_z + (1 | participant)
   Data: df_long

REML criterion at convergence: 6171.4

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.71346 -1.00819 -0.04683  1.06425  1.73435 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.00     0.0     
 Residual                3.24     1.8     
Number of obs: 1536, groups:  participant, 96

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept) 3.499e+00  4.593e-02 1.534e+03  76.176   &lt;2e-16 ***
NB_z        4.549e-01  4.594e-02 1.534e+03   9.901   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
     (Intr)
NB_z 0.000 
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_voteinfo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: rating ~ PureVote + (1 | participant)
   Data: df_long

REML criterion at convergence: 5148.7

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-3.13374 -0.74228  0.03333  0.74430  3.13576 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.000    0.000   
 Residual                1.662    1.289   
Number of obs: 1536, groups:  participant, 96

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept) 3.499e+00  3.290e-02 1.534e+03  106.35   &lt;2e-16 ***
PureVote    7.708e-01  1.899e-02 1.534e+03   40.58   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
         (Intr)
PureVote 0.000 
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_votenb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: rating ~ NB_z + PureVote + (1 | participant)
   Data: df_long

REML criterion at convergence: 5136.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.1944 -0.6305  0.0721  0.7542  3.2685 

Random effects:
 Groups      Name        Variance Std.Dev.
 participant (Intercept) 0.000    0.000   
 Residual                1.645    1.283   
Number of obs: 1536, groups:  participant, 96

Fixed effects:
             Estimate Std. Error        df t value Pr(&gt;|t|)    
(Intercept) 3.499e+00  3.273e-02 1.533e+03 106.896  &lt; 2e-16 ***
NB_z        1.381e-01  3.375e-02 1.533e+03   4.092 4.49e-05 ***
PureVote    7.514e-01  1.948e-02 1.533e+03  38.571  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
         (Intr) NB_z  
NB_z      0.000       
PureVote  0.000 -0.243
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_wvnb, m_nb)          <span class="co"># 检验 WeightedVote 在 NB_z 基础上的额外作用</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: df_long
Models:
m_nb: rating ~ NB_z + (1 | participant)
m_wvnb: rating ~ NB_z + VoteEar + VoteFoot + (1 | participant)
       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
m_nb      4 6170.7 6192.1 -3081.4   6162.7                         
m_wvnb    6 5131.4 5163.5 -2559.7   5119.4 1043.3  2  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_votenb, m_nb)   <span class="co"># 检验 PureVote 在 NB_z 基础上的额外作用</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: df_long
Models:
m_nb: rating ~ NB_z + (1 | participant)
m_votenb: rating ~ NB_z + PureVote + (1 | participant)
         npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
m_nb        4 6170.7 6192.1 -3081.4   6162.7                         
m_votenb    5 5130.9 5157.6 -2560.4   5120.9 1041.8  1  &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_votenb, m_voteinfo) <span class="co"># 检验 NB_z 在 PureVote 基础上的额外作用</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: df_long
Models:
m_voteinfo: rating ~ PureVote + (1 | participant)
m_votenb: rating ~ NB_z + PureVote + (1 | participant)
           npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
m_voteinfo    4 5145.6 5166.9 -2568.8   5137.6                         
m_votenb      5 5130.9 5157.6 -2560.4   5120.9 16.689  1  4.404e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_wvnb, m_wv)          <span class="co"># 检验 NB 在 WV 基础上的额外作用</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: df_long
Models:
m_wv: rating ~ VoteEar + VoteFoot + (1 | participant)
m_wvnb: rating ~ NB_z + VoteEar + VoteFoot + (1 | participant)
       npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)    
m_wv      5 5144.4 5171.1 -2567.2   5134.4                         
m_wvnb    6 5131.4 5163.5 -2559.7   5119.4 14.962  1  0.0001097 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m_wv,m_voteinfo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>refitting model(s) with ML (instead of REML)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: df_long
Models:
m_voteinfo: rating ~ PureVote + (1 | participant)
m_wv: rating ~ VoteEar + VoteFoot + (1 | participant)
           npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
m_voteinfo    4 5145.6 5166.9 -2568.8   5137.6                       
m_wv          5 5144.4 5171.1 -2567.2   5134.4 3.1845  1    0.07434 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1️⃣ Fit models</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>m_purevote <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rating <span class="sc">~</span> PureVote <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>m_purevote_nb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rating <span class="sc">~</span> PureVote <span class="sc">+</span> NB_z <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>m_weightedvote <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rating <span class="sc">~</span>  VoteEar <span class="sc">+</span> VoteFoot <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>m_weightedvote_nb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rating <span class="sc">~</span>  VoteEar <span class="sc">+</span> VoteFoot <span class="sc">+</span> NB_z <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>m_nb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(rating <span class="sc">~</span> NB_z <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> participant), <span class="at">data =</span> df_long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2️⃣ Add predictions to df_long</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_purevote =</span> <span class="fu">predict</span>(m_purevote),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_purevote_nb =</span> <span class="fu">predict</span>(m_purevote_nb),</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_weightedvote =</span> <span class="fu">predict</span>(m_weightedvote),</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_weightedvote_nb =</span> <span class="fu">predict</span>(m_weightedvote_nb),</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_nb =</span> <span class="fu">predict</span>(m_nb)</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 3️⃣ Gather into long format</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(participant, trial, rating,</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>         pred_purevote, pred_purevote_nb,</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>         pred_weightedvote, pred_weightedvote_nb,</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>         pred_nb) <span class="sc">%&gt;%</span></span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"pred_"</span>),</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"model"</span>,</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"prediction"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">recode</span>(model,</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pred_purevote =</span> <span class="st">"PureVote"</span>,</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pred_purevote_nb =</span> <span class="st">"PureVote + NB"</span>,</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pred_weightedvote =</span> <span class="st">"WeightedVote"</span>,</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pred_weightedvote_nb =</span> <span class="st">"WeightedVote + NB"</span>,</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pred_nb =</span> <span class="st">"Pure NB"</span>))</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 4️⃣ Compute mean &amp; CI for plotting</span></span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>summary_df <span class="ot">&lt;-</span> plot_df <span class="sc">%&gt;%</span></span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trial, model) <span class="sc">%&gt;%</span></span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_pred =</span> <span class="fu">mean</span>(prediction),</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(prediction) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> mean_pred <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> mean_pred <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 5️⃣ Participant means per trial</span></span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>obs_df <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trial) <span class="sc">%&gt;%</span></span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_rating =</span> <span class="fu">mean</span>(rating),</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> <span class="fu">sd</span>(rating) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> mean_rating <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se,</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> mean_rating <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a><span class="co"># ✅ Plot with predictions + observed means</span></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_df, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> mean_pred, <span class="at">color =</span> model, <span class="at">fill =</span> model)) <span class="sc">+</span></span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">alpha =</span> <span class="fl">0.15</span>, <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add observed means (black points and line)</span></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> obs_df, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> mean_rating),</span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> obs_df, <span class="fu">aes</span>(<span class="at">x =</span> trial, <span class="at">y =</span> mean_rating),</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>             <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Rating / Predicted rating"</span>, <span class="at">x =</span> <span class="st">"Trial"</span>,</span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Model Predictions vs Observed Ratings"</span>,</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"PureVote, WeightedVote, NB and combinations"</span>) <span class="sc">+</span></span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova" class="level2">
<h2 class="anchored" data-anchor-id="anova">ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ readr     2.1.5
✔ lubridate 1.9.3     ✔ stringr   1.5.1
✔ purrr     1.0.2     ✔ tibble    3.2.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ Matrix::expand()  masks tidyr::expand()
✖ rstatix::filter() masks dplyr::filter(), stats::filter()
✖ dplyr::lag()      masks stats::lag()
✖ Matrix::pack()    masks tidyr::pack()
✖ Matrix::unpack()  masks tidyr::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ANOVA</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p1<span class="sc">+</span>final_data<span class="sc">$</span>p9)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p2<span class="sc">+</span>final_data<span class="sc">$</span>p10)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p3<span class="sc">+</span>final_data<span class="sc">$</span>p12)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p4<span class="sc">+</span>final_data<span class="sc">$</span>p11)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>t5 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p5<span class="sc">+</span>final_data<span class="sc">$</span>p13)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>t6 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p6<span class="sc">+</span>final_data<span class="sc">$</span>p14)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>t7 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p7<span class="sc">+</span>final_data<span class="sc">$</span>p15)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>t8 <span class="ot">&lt;-</span> (final_data<span class="sc">$</span>p8<span class="sc">+</span>final_data<span class="sc">$</span>p16)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the difference within pairs</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t2, <span class="at">mu=</span><span class="fl">3.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t2
t = 10.454, df = 95, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 3.5
95 percent confidence interval:
 4.634976 5.167107
sample estimates:
mean of x 
 4.901042 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t2, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t2
t = 10.454, df = 95, p-value = 1
alternative hypothesis: true mean is less than 3.5
95 percent confidence interval:
     -Inf 5.123657
sample estimates:
mean of x 
 4.901042 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t2, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t2
t = 10.454, df = 95, p-value &lt; 2.2e-16
alternative hypothesis: true mean is greater than 3.5
95 percent confidence interval:
 4.678426      Inf
sample estimates:
mean of x 
 4.901042 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t3, <span class="at">mu=</span><span class="fl">3.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t3
t = 0.58492, df = 95, p-value = 0.56
alternative hypothesis: true mean is not equal to 3.5
95 percent confidence interval:
 3.350373 3.774627
sample estimates:
mean of x 
   3.5625 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t3, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t3
t = 0.58492, df = 95, p-value = 0.72
alternative hypothesis: true mean is less than 3.5
95 percent confidence interval:
     -Inf 3.739986
sample estimates:
mean of x 
   3.5625 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t3, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t3
t = 0.58492, df = 95, p-value = 0.28
alternative hypothesis: true mean is greater than 3.5
95 percent confidence interval:
 3.385014      Inf
sample estimates:
mean of x 
   3.5625 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t4, <span class="at">mu=</span> <span class="fl">3.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t4
t = 4.1445, df = 95, p-value = 7.393e-05
alternative hypothesis: true mean is not equal to 3.5
95 percent confidence interval:
 3.727935 4.147065
sample estimates:
mean of x 
   3.9375 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t4, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t4
t = 4.1445, df = 95, p-value = 1
alternative hypothesis: true mean is less than 3.5
95 percent confidence interval:
     -Inf 4.112842
sample estimates:
mean of x 
   3.9375 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(t4, <span class="at">mu =</span> <span class="fl">3.5</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  t4
t = 4.1445, df = 95, p-value = 3.697e-05
alternative hypothesis: true mean is greater than 3.5
95 percent confidence interval:
 3.762158      Inf
sample estimates:
mean of x 
   3.9375 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.901042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(t2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.313132</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(t3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.5625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(t3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.046925</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(t4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.9375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(t4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.034281</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>nsubj <span class="ot">&lt;-</span> <span class="fu">length</span>(t1)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>participant <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nsubj, <span class="at">times =</span> <span class="dv">6</span>)   <span class="co"># 被试ID</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">participant =</span> participant,</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">diff =</span> <span class="fu">c</span>(t1, t2, t5, t6, t7, t8),</span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">vote =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"jar1"</span>, <span class="st">"jar2"</span>), <span class="at">each =</span> nsubj, <span class="at">times =</span> <span class="dv">3</span>),</span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"earfoot"</span>, <span class="st">"2ear"</span>, <span class="st">"2foot"</span>), <span class="at">each =</span> <span class="dv">2</span><span class="sc">*</span>nsubj)</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co">#remove participants with extreme outliers</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>extreme_outliers <span class="ot">&lt;-</span>long_data  <span class="sc">%&gt;%</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vote, model) <span class="sc">%&gt;%</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">identify_outliers</span>(diff)<span class="sc">%&gt;%</span> </span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(is.extreme)</span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="co">#remove participants with extreme outliers</span></span>
<span id="cb124-22"><a href="#cb124-22" aria-hidden="true" tabindex="-1"></a>participants_to_remove <span class="ot">&lt;-</span> extreme_outliers <span class="sc">%&gt;%</span></span>
<span id="cb124-23"><a href="#cb124-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(participant)</span>
<span id="cb124-24"><a href="#cb124-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-25"><a href="#cb124-25" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> long_data <span class="sc">%&gt;%</span></span>
<span id="cb124-26"><a href="#cb124-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(participants_to_remove, <span class="at">by =</span> <span class="st">"participant"</span>)</span>
<span id="cb124-27"><a href="#cb124-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-28"><a href="#cb124-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-29"><a href="#cb124-29" aria-hidden="true" tabindex="-1"></a><span class="co">#descriptive analysis</span></span>
<span id="cb124-30"><a href="#cb124-30" aria-hidden="true" tabindex="-1"></a>long_data  <span class="sc">%&gt;%</span></span>
<span id="cb124-31"><a href="#cb124-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vote, model) <span class="sc">%&gt;%</span></span>
<span id="cb124-32"><a href="#cb124-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_summary_stats</span>(diff, <span class="at">type =</span> <span class="st">"mean_sd"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  vote  model   variable     n  mean    sd
  &lt;chr&gt; &lt;chr&gt;   &lt;fct&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 jar1  2ear    diff        96  1.84 0.844
2 jar1  2foot   diff        96  1.97 1.03 
3 jar1  earfoot diff        96  1.81 0.98 
4 jar2  2ear    diff        96  4.93 1.18 
5 jar2  2foot   diff        96  5.04 1.06 
6 jar2  earfoot diff        96  4.90 1.31 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  long_data, <span class="at">x =</span> <span class="st">"vote"</span>, <span class="at">y =</span> <span class="st">"diff"</span>,</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">"model"</span>, <span class="at">palette =</span> <span class="st">"jco"</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>bxp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#shapiro test</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>long_data <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vote,model) <span class="sc">%&gt;%</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">shapiro_test</span>(diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  vote  model   variable statistic        p
  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 jar1  2ear    diff         0.860 4.55e- 8
2 jar1  2foot   diff         0.849 1.83e- 8
3 jar1  earfoot diff         0.794 2.96e-10
4 jar2  2ear    diff         0.829 3.77e- 9
5 jar2  2foot   diff         0.836 6.23e- 9
6 jar2  earfoot diff         0.793 2.72e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggqqplot</span>(long_data, <span class="st">"diff"</span>, <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()) <span class="sc">+</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(vote <span class="sc">~</span> model, <span class="at">labeller =</span> <span class="st">"label_both"</span>) <span class="co">#Although the normality assumption is violated, the deviation is not severe. Given the large sample size (n = 101 ≫ 30), we proceeded with the analysis under the assumption of normality.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ANOVA Result</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>aov_results <span class="ot">&lt;-</span> long_data <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dv =</span> diff,</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wid =</span> participant,</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">within =</span> <span class="fu">c</span>(vote, model)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normative-model" class="level2">
<h2 class="anchored" data-anchor-id="normative-model">Normative Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>compute_posterior <span class="ot">&lt;-</span> <span class="cf">function</span>(a1, b2, s1, s2, tau) {</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate Participants' knowledge kn</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        small ear     big ear    small ear   big ear</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#        small feet    small feet  big feet   big feet</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type1    a1            b1          c1          d1</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Type2    a2            b2          c2          d2   </span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>  d1 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> a1</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> b2</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>  ear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>  foot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>  kn <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">ear =</span> ear, <span class="at">foot =</span> foot)</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>  kn<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1, b1, c1, d1)</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>  kn<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2, b2, c2, d2)</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate Ear experts' knowledge</span></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>  kn_ear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ear =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>  kn_ear<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1 <span class="sc">+</span> c1, b1 <span class="sc">+</span> d1)</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>  kn_ear<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2 <span class="sc">+</span> c2, b2 <span class="sc">+</span> d2)</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate Foot experts' knowledge</span></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>  kn_foot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">foot =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>  kn_foot<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1 <span class="sc">+</span> b1, c1 <span class="sc">+</span> d1)</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>  kn_foot<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2 <span class="sc">+</span> b2, c2 <span class="sc">+</span> d2)</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate a list of hypotheses</span></span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>  hy_ear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#observation of ear feature</span></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>  hy_feet <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#observation of foot feature</span></span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>  hy_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>) <span class="co">#type of alien</span></span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>  hy_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (h1 <span class="cf">in</span> hy_ear) {</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (h2 <span class="cf">in</span> hy_feet) {</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (h3 <span class="cf">in</span> hy_type) {</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>        hy_list[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">h1 =</span> h1, <span class="at">h2 =</span> h2, <span class="at">type =</span> h3)</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define a softmax transformation for expert responses. </span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a>  softmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rtau) {</span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>    exps <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(x) <span class="sc">*</span> rtau)</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="ot">&lt;-</span> exps <span class="sc">/</span> <span class="fu">sum</span>(exps)</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(probabilities)</span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over hypothesis space to compute probabilities</span></span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For each hypothesis:</span></span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># P(hy|s1,s2) ~ P(s1,s2|hy) * P(hy)</span></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Here hy = ob_ear(observation of ear feature), ob_foot(observation of foot feature), type(I or II)</span></span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="fu">seq_along</span>(hy_list)) {</span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>    hyp <span class="ot">&lt;-</span> hy_list[[item]]</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>    ob_ear <span class="ot">&lt;-</span> hyp<span class="sc">$</span>h1</span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a>    ob_foot <span class="ot">&lt;-</span> hyp<span class="sc">$</span>h2</span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>    type <span class="ot">&lt;-</span> hyp<span class="sc">$</span>type</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> kn<span class="sc">$</span>ear <span class="sc">==</span> ob_ear <span class="sc">&amp;</span> kn<span class="sc">$</span>foot <span class="sc">==</span> ob_foot</span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prior: P(ob_ear, ob_foot, type) </span></span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Notably, since we only have a limited observation, we calculate through Bayesian Probability rather than Frequency Probability</span></span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a>    alpha_ob <span class="ot">=</span> kn[[type]][idx] <span class="co"># trials where we observe the combination c(ob_ear, ob_foot, type)</span></span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a>    beta_ob <span class="ot">=</span> <span class="dv">20</span><span class="sc">-</span>kn[[type]][idx]  <span class="co"># trials where we don't observe the combination c(ob_ear, ob_foot, type)</span></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a>    prior <span class="ot">&lt;-</span> alpha_ob<span class="sc">/</span>(alpha_ob<span class="sc">+</span>beta_ob)</span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in item = 1; the result prior = 0.1363636</span></span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">#another way of calculation: </span></span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Prior = P(ob_ear, ob_foot, type) = P(ob_ear, ob_foot|type) * P(type)</span></span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For P(ob_ear, ob_foot|type)</span></span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>    alpha_ob <span class="ot">=</span> kn[[type]][idx] <span class="co"># trials where we observe the combination c(ob_ear, ob_foot) in certain type</span></span>
<span id="cb131-79"><a href="#cb131-79" aria-hidden="true" tabindex="-1"></a>    beta_ob <span class="ot">=</span> <span class="dv">10</span><span class="sc">-</span>kn[[type]][idx]  <span class="co"># trials where we don't observe the combination c(ob_ear, ob_foot) in certain type</span></span>
<span id="cb131-80"><a href="#cb131-80" aria-hidden="true" tabindex="-1"></a>    P_ob <span class="ot">&lt;-</span> alpha_ob<span class="sc">/</span>(alpha_ob<span class="sc">+</span>beta_ob)</span>
<span id="cb131-81"><a href="#cb131-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-82"><a href="#cb131-82" aria-hidden="true" tabindex="-1"></a>    <span class="co">#For P(type)</span></span>
<span id="cb131-83"><a href="#cb131-83" aria-hidden="true" tabindex="-1"></a>    P_type <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb131-84"><a href="#cb131-84" aria-hidden="true" tabindex="-1"></a>    prior <span class="ot">&lt;-</span> P_ob <span class="sc">*</span> P_type</span>
<span id="cb131-85"><a href="#cb131-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># in item = 1; the result prior = 0.125</span></span>
<span id="cb131-86"><a href="#cb131-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-87"><a href="#cb131-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-88"><a href="#cb131-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute P(s1, s2|ob_ear, ob_foot, type)</span></span>
<span id="cb131-89"><a href="#cb131-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For ear expert, use kn_ear:</span></span>
<span id="cb131-90"><a href="#cb131-90" aria-hidden="true" tabindex="-1"></a>    ear_idx <span class="ot">&lt;-</span> kn_ear<span class="sc">$</span>ear <span class="sc">==</span> ob_ear</span>
<span id="cb131-91"><a href="#cb131-91" aria-hidden="true" tabindex="-1"></a>    alpha_ear<span class="ot">=</span> kn_ear[[<span class="st">'Type1'</span>]][ear_idx]</span>
<span id="cb131-92"><a href="#cb131-92" aria-hidden="true" tabindex="-1"></a>    beta_ear <span class="ot">=</span> kn_ear<span class="sc">$</span>Type2[ear_idx] </span>
<span id="cb131-93"><a href="#cb131-93" aria-hidden="true" tabindex="-1"></a>    P_s1_ob_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-94"><a href="#cb131-94" aria-hidden="true" tabindex="-1"></a>      alpha_ear<span class="sc">/</span>(alpha_ear<span class="sc">+</span>beta_ear),</span>
<span id="cb131-95"><a href="#cb131-95" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">-</span>alpha_ear<span class="sc">/</span>(alpha_ear<span class="sc">+</span>beta_ear)</span>
<span id="cb131-96"><a href="#cb131-96" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-97"><a href="#cb131-97" aria-hidden="true" tabindex="-1"></a>    P_s1_ob_list_sf <span class="ot">&lt;-</span> <span class="fu">softmax</span>(<span class="fu">unlist</span>(P_s1_ob_list), tau)</span>
<span id="cb131-98"><a href="#cb131-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s1 <span class="sc">==</span> <span class="st">"Type1"</span>) {</span>
<span id="cb131-99"><a href="#cb131-99" aria-hidden="true" tabindex="-1"></a>      P_s1_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">1</span>]</span>
<span id="cb131-100"><a href="#cb131-100" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (s1 <span class="sc">==</span> <span class="st">"Type2"</span>) {</span>
<span id="cb131-101"><a href="#cb131-101" aria-hidden="true" tabindex="-1"></a>      P_s1_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">2</span>]</span>
<span id="cb131-102"><a href="#cb131-102" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-103"><a href="#cb131-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For foot expert, use kn_foot:</span></span>
<span id="cb131-104"><a href="#cb131-104" aria-hidden="true" tabindex="-1"></a>    foot_idx <span class="ot">&lt;-</span> kn_foot<span class="sc">$</span>foot <span class="sc">==</span> ob_foot</span>
<span id="cb131-105"><a href="#cb131-105" aria-hidden="true" tabindex="-1"></a>    alpha_foot <span class="ot">&lt;-</span> kn_foot[[<span class="st">'Type1'</span>]][foot_idx]</span>
<span id="cb131-106"><a href="#cb131-106" aria-hidden="true" tabindex="-1"></a>    beta_foot <span class="ot">&lt;-</span> kn_foot[[<span class="st">'Type2'</span>]][foot_idx]</span>
<span id="cb131-107"><a href="#cb131-107" aria-hidden="true" tabindex="-1"></a>    P_s2_ob_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-108"><a href="#cb131-108" aria-hidden="true" tabindex="-1"></a>      alpha_foot<span class="sc">/</span>(alpha_foot<span class="sc">+</span>beta_foot),</span>
<span id="cb131-109"><a href="#cb131-109" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">-</span>alpha_foot<span class="sc">/</span>(alpha_foot<span class="sc">+</span>beta_foot)</span>
<span id="cb131-110"><a href="#cb131-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-111"><a href="#cb131-111" aria-hidden="true" tabindex="-1"></a>    P_s2_ob_list_sf <span class="ot">&lt;-</span> <span class="fu">softmax</span>(<span class="fu">unlist</span>(P_s2_ob_list), tau)</span>
<span id="cb131-112"><a href="#cb131-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s2 <span class="sc">==</span> <span class="st">"Type1"</span>) {</span>
<span id="cb131-113"><a href="#cb131-113" aria-hidden="true" tabindex="-1"></a>      P_s2_ob <span class="ot">&lt;-</span> P_s2_ob_list_sf[<span class="dv">1</span>]</span>
<span id="cb131-114"><a href="#cb131-114" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (s2 <span class="sc">==</span> <span class="st">"Type2"</span>) {</span>
<span id="cb131-115"><a href="#cb131-115" aria-hidden="true" tabindex="-1"></a>      P_s2_ob <span class="ot">&lt;-</span> P_s2_ob_list_sf[<span class="dv">2</span>]</span>
<span id="cb131-116"><a href="#cb131-116" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-117"><a href="#cb131-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-118"><a href="#cb131-118" aria-hidden="true" tabindex="-1"></a>    P_s1_s2_ob <span class="ot">&lt;-</span> P_s1_ob <span class="sc">*</span> P_s2_ob</span>
<span id="cb131-119"><a href="#cb131-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-120"><a href="#cb131-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P(ob_ear, ob_foot, type | s1, s2)</span></span>
<span id="cb131-121"><a href="#cb131-121" aria-hidden="true" tabindex="-1"></a>    P_ob_s1_s2 <span class="ot">&lt;-</span>  prior <span class="sc">*</span> P_s1_s2_ob</span>
<span id="cb131-122"><a href="#cb131-122" aria-hidden="true" tabindex="-1"></a>    hy_list[[item]][[<span class="st">"P_obs_given_signal"</span>]] <span class="ot">&lt;-</span> P_ob_s1_s2</span>
<span id="cb131-123"><a href="#cb131-123" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-124"><a href="#cb131-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-125"><a href="#cb131-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-126"><a href="#cb131-126" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Final posterior for Type1 and Type2</span></span>
<span id="cb131-127"><a href="#cb131-127" aria-hidden="true" tabindex="-1"></a>  P_s1_s2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span><span class="ot">=</span><span class="dv">0</span>,<span class="st">"Type2"</span><span class="ot">=</span><span class="dv">0</span>)</span>
<span id="cb131-128"><a href="#cb131-128" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-129"><a href="#cb131-129" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> hy_list) {</span>
<span id="cb131-130"><a href="#cb131-130" aria-hidden="true" tabindex="-1"></a>    type<span class="ot">=</span>i[[<span class="st">"type"</span>]]</span>
<span id="cb131-131"><a href="#cb131-131" aria-hidden="true" tabindex="-1"></a>    P_s1_s2[type] <span class="ot">&lt;-</span> P_s1_s2[type] <span class="sc">+</span> i[[<span class="st">"P_obs_given_signal"</span>]]</span>
<span id="cb131-132"><a href="#cb131-132" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-133"><a href="#cb131-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-134"><a href="#cb131-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optionally, you can compute normalized probabilities:</span></span>
<span id="cb131-135"><a href="#cb131-135" aria-hidden="true" tabindex="-1"></a>  P_norm <span class="ot">&lt;-</span> <span class="fu">sum</span>(P_s1_s2)</span>
<span id="cb131-136"><a href="#cb131-136" aria-hidden="true" tabindex="-1"></a>  P_type1_s1_s2 <span class="ot">&lt;-</span> P_s1_s2[<span class="st">'Type1'</span>] <span class="sc">/</span> P_norm</span>
<span id="cb131-137"><a href="#cb131-137" aria-hidden="true" tabindex="-1"></a>  P_type2_s1_s2 <span class="ot">&lt;-</span> P_s1_s2[<span class="st">'Type2'</span>] <span class="sc">/</span> P_norm</span>
<span id="cb131-138"><a href="#cb131-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-139"><a href="#cb131-139" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a list of values</span></span>
<span id="cb131-140"><a href="#cb131-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P_type2_s1_s2)</span>
<span id="cb131-141"><a href="#cb131-141" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-142"><a href="#cb131-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-143"><a href="#cb131-143" aria-hidden="true" tabindex="-1"></a>compute_posterior_2ear <span class="ot">&lt;-</span> <span class="cf">function</span>(a1, b2, s1, s2, tau) {</span>
<span id="cb131-144"><a href="#cb131-144" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-145"><a href="#cb131-145" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-146"><a href="#cb131-146" aria-hidden="true" tabindex="-1"></a>  d1 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> a1</span>
<span id="cb131-147"><a href="#cb131-147" aria-hidden="true" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-148"><a href="#cb131-148" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> b2</span>
<span id="cb131-149"><a href="#cb131-149" aria-hidden="true" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-150"><a href="#cb131-150" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-151"><a href="#cb131-151" aria-hidden="true" tabindex="-1"></a>  hy_ear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-152"><a href="#cb131-152" aria-hidden="true" tabindex="-1"></a>  hy_feet <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-153"><a href="#cb131-153" aria-hidden="true" tabindex="-1"></a>  hy_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>)</span>
<span id="cb131-154"><a href="#cb131-154" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-155"><a href="#cb131-155" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Participants' knowledge</span></span>
<span id="cb131-156"><a href="#cb131-156" aria-hidden="true" tabindex="-1"></a>  ear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-157"><a href="#cb131-157" aria-hidden="true" tabindex="-1"></a>  foot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-158"><a href="#cb131-158" aria-hidden="true" tabindex="-1"></a>  kn <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">ear =</span> ear, <span class="at">foot =</span> foot)</span>
<span id="cb131-159"><a href="#cb131-159" aria-hidden="true" tabindex="-1"></a>  kn<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1, b1, c1, d1)</span>
<span id="cb131-160"><a href="#cb131-160" aria-hidden="true" tabindex="-1"></a>  kn<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2, b2, c2, d2)</span>
<span id="cb131-161"><a href="#cb131-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-162"><a href="#cb131-162" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ear experts' knowledge</span></span>
<span id="cb131-163"><a href="#cb131-163" aria-hidden="true" tabindex="-1"></a>  kn_ear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ear =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb131-164"><a href="#cb131-164" aria-hidden="true" tabindex="-1"></a>  kn_ear<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1 <span class="sc">+</span> c1, b1 <span class="sc">+</span> d1)</span>
<span id="cb131-165"><a href="#cb131-165" aria-hidden="true" tabindex="-1"></a>  kn_ear<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2 <span class="sc">+</span> c2, b2 <span class="sc">+</span> d2)</span>
<span id="cb131-166"><a href="#cb131-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-167"><a href="#cb131-167" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Foot experts' knowledge</span></span>
<span id="cb131-168"><a href="#cb131-168" aria-hidden="true" tabindex="-1"></a>  kn_foot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">foot =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb131-169"><a href="#cb131-169" aria-hidden="true" tabindex="-1"></a>  kn_foot<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1 <span class="sc">+</span> b1, c1 <span class="sc">+</span> d1)</span>
<span id="cb131-170"><a href="#cb131-170" aria-hidden="true" tabindex="-1"></a>  kn_foot<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2 <span class="sc">+</span> b2, c2 <span class="sc">+</span> d2)</span>
<span id="cb131-171"><a href="#cb131-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-172"><a href="#cb131-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Form a hypothesis list</span></span>
<span id="cb131-173"><a href="#cb131-173" aria-hidden="true" tabindex="-1"></a>  hy_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb131-174"><a href="#cb131-174" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb131-175"><a href="#cb131-175" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (h1 <span class="cf">in</span> hy_ear) {</span>
<span id="cb131-176"><a href="#cb131-176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (h2 <span class="cf">in</span> hy_feet) {</span>
<span id="cb131-177"><a href="#cb131-177" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (h3 <span class="cf">in</span> hy_type) {</span>
<span id="cb131-178"><a href="#cb131-178" aria-hidden="true" tabindex="-1"></a>        hy_list[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">h1 =</span> h1, <span class="at">h2 =</span> h2, <span class="at">type =</span> h3)</span>
<span id="cb131-179"><a href="#cb131-179" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb131-180"><a href="#cb131-180" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb131-181"><a href="#cb131-181" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-182"><a href="#cb131-182" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-183"><a href="#cb131-183" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-184"><a href="#cb131-184" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using softmax transformation for expert responses:</span></span>
<span id="cb131-185"><a href="#cb131-185" aria-hidden="true" tabindex="-1"></a>  softmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x, tau) {</span>
<span id="cb131-186"><a href="#cb131-186" aria-hidden="true" tabindex="-1"></a>    exps <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(x) <span class="sc">*</span> tau)</span>
<span id="cb131-187"><a href="#cb131-187" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="ot">&lt;-</span> exps <span class="sc">/</span> <span class="fu">sum</span>(exps)</span>
<span id="cb131-188"><a href="#cb131-188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(probabilities)</span>
<span id="cb131-189"><a href="#cb131-189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-190"><a href="#cb131-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-191"><a href="#cb131-191" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over hypothesis space to compute probabilities</span></span>
<span id="cb131-192"><a href="#cb131-192" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="fu">seq_along</span>(hy_list)) {</span>
<span id="cb131-193"><a href="#cb131-193" aria-hidden="true" tabindex="-1"></a>    hyp <span class="ot">&lt;-</span> hy_list[[item]]</span>
<span id="cb131-194"><a href="#cb131-194" aria-hidden="true" tabindex="-1"></a>    ob_ear <span class="ot">&lt;-</span> hyp<span class="sc">$</span>h1</span>
<span id="cb131-195"><a href="#cb131-195" aria-hidden="true" tabindex="-1"></a>    ob_foot <span class="ot">&lt;-</span> hyp<span class="sc">$</span>h2</span>
<span id="cb131-196"><a href="#cb131-196" aria-hidden="true" tabindex="-1"></a>    type <span class="ot">&lt;-</span> hyp<span class="sc">$</span>type</span>
<span id="cb131-197"><a href="#cb131-197" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> kn<span class="sc">$</span>ear <span class="sc">==</span> ob_ear <span class="sc">&amp;</span> kn<span class="sc">$</span>foot <span class="sc">==</span> ob_foot</span>
<span id="cb131-198"><a href="#cb131-198" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-199"><a href="#cb131-199" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P(ob_ear, ob_foot, type) = P(ob_ear, ob_foot|type)*P(type)</span></span>
<span id="cb131-200"><a href="#cb131-200" aria-hidden="true" tabindex="-1"></a>    alpha_ob<span class="ot">=</span>kn[[type]][idx]</span>
<span id="cb131-201"><a href="#cb131-201" aria-hidden="true" tabindex="-1"></a>    beta_ob <span class="ot">=</span> <span class="dv">10</span><span class="sc">-</span>kn[[type]][idx]</span>
<span id="cb131-202"><a href="#cb131-202" aria-hidden="true" tabindex="-1"></a>    P_ob <span class="ot">&lt;-</span> alpha_ob<span class="sc">/</span>(alpha_ob<span class="sc">+</span>beta_ob)</span>
<span id="cb131-203"><a href="#cb131-203" aria-hidden="true" tabindex="-1"></a>    P_type <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb131-204"><a href="#cb131-204" aria-hidden="true" tabindex="-1"></a>    P_ob_type <span class="ot">&lt;-</span> P_ob <span class="sc">*</span> P_type</span>
<span id="cb131-205"><a href="#cb131-205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-206"><a href="#cb131-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute P(s1, s2|ob_ear, ob_foot, type)</span></span>
<span id="cb131-207"><a href="#cb131-207" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For ear expert, use kn_ear:</span></span>
<span id="cb131-208"><a href="#cb131-208" aria-hidden="true" tabindex="-1"></a>    ear_idx <span class="ot">&lt;-</span> kn_ear<span class="sc">$</span>ear <span class="sc">==</span> ob_ear</span>
<span id="cb131-209"><a href="#cb131-209" aria-hidden="true" tabindex="-1"></a>    alpha_ear<span class="ot">=</span> kn_ear[[<span class="st">'Type1'</span>]][ear_idx]</span>
<span id="cb131-210"><a href="#cb131-210" aria-hidden="true" tabindex="-1"></a>    beta_ear <span class="ot">=</span> kn_ear[[<span class="st">'Type2'</span>]][ear_idx]</span>
<span id="cb131-211"><a href="#cb131-211" aria-hidden="true" tabindex="-1"></a>    P_s1_ob_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-212"><a href="#cb131-212" aria-hidden="true" tabindex="-1"></a>      alpha_ear<span class="sc">/</span>(alpha_ear<span class="sc">+</span>beta_ear),</span>
<span id="cb131-213"><a href="#cb131-213" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">-</span>(alpha_ear<span class="sc">/</span>(alpha_ear<span class="sc">+</span>beta_ear))</span>
<span id="cb131-214"><a href="#cb131-214" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-215"><a href="#cb131-215" aria-hidden="true" tabindex="-1"></a>    P_s1_ob_list_sf <span class="ot">&lt;-</span> <span class="fu">softmax</span>(<span class="fu">unlist</span>(P_s1_ob_list), tau)</span>
<span id="cb131-216"><a href="#cb131-216" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-217"><a href="#cb131-217" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s1 <span class="sc">==</span> <span class="st">"Type1"</span>) {</span>
<span id="cb131-218"><a href="#cb131-218" aria-hidden="true" tabindex="-1"></a>      P_s1_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">1</span>]</span>
<span id="cb131-219"><a href="#cb131-219" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (s1 <span class="sc">==</span> <span class="st">"Type2"</span>) {</span>
<span id="cb131-220"><a href="#cb131-220" aria-hidden="true" tabindex="-1"></a>      P_s1_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">2</span>]</span>
<span id="cb131-221"><a href="#cb131-221" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-222"><a href="#cb131-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-223"><a href="#cb131-223" aria-hidden="true" tabindex="-1"></a>    <span class="co">#for the second ear expert:</span></span>
<span id="cb131-224"><a href="#cb131-224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s2 <span class="sc">==</span> <span class="st">"Type1"</span>) {</span>
<span id="cb131-225"><a href="#cb131-225" aria-hidden="true" tabindex="-1"></a>      P_s2_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">1</span>]</span>
<span id="cb131-226"><a href="#cb131-226" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (s2 <span class="sc">==</span> <span class="st">"Type2"</span>) {</span>
<span id="cb131-227"><a href="#cb131-227" aria-hidden="true" tabindex="-1"></a>      P_s2_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">2</span>]</span>
<span id="cb131-228"><a href="#cb131-228" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-229"><a href="#cb131-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-230"><a href="#cb131-230" aria-hidden="true" tabindex="-1"></a>    P_s1_s2_ob <span class="ot">&lt;-</span> P_s1_ob <span class="sc">*</span> P_s2_ob</span>
<span id="cb131-231"><a href="#cb131-231" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-232"><a href="#cb131-232" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P(ob_ear, ob_foot, type | s1, s2)</span></span>
<span id="cb131-233"><a href="#cb131-233" aria-hidden="true" tabindex="-1"></a>    P_ob_s1_s2 <span class="ot">&lt;-</span> P_ob_type <span class="sc">*</span> P_s1_s2_ob</span>
<span id="cb131-234"><a href="#cb131-234" aria-hidden="true" tabindex="-1"></a>    hy_list[[item]][[<span class="st">"P_obs_given_signal"</span>]] <span class="ot">&lt;-</span> P_ob_s1_s2</span>
<span id="cb131-235"><a href="#cb131-235" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-236"><a href="#cb131-236" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-237"><a href="#cb131-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-238"><a href="#cb131-238" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Final posterior for Type1 and Type2</span></span>
<span id="cb131-239"><a href="#cb131-239" aria-hidden="true" tabindex="-1"></a>  P_s1_s2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span><span class="ot">=</span><span class="fl">0.001</span>,<span class="st">"Type2"</span><span class="ot">=</span><span class="fl">0.001</span>) <span class="co">#ask neil</span></span>
<span id="cb131-240"><a href="#cb131-240" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-241"><a href="#cb131-241" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> hy_list) {</span>
<span id="cb131-242"><a href="#cb131-242" aria-hidden="true" tabindex="-1"></a>    type<span class="ot">=</span>i[[<span class="st">"type"</span>]]</span>
<span id="cb131-243"><a href="#cb131-243" aria-hidden="true" tabindex="-1"></a>    P_s1_s2[type] <span class="ot">&lt;-</span> P_s1_s2[type] <span class="sc">+</span> i[[<span class="st">"P_obs_given_signal"</span>]]</span>
<span id="cb131-244"><a href="#cb131-244" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-245"><a href="#cb131-245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-246"><a href="#cb131-246" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute normalized probabilities:</span></span>
<span id="cb131-247"><a href="#cb131-247" aria-hidden="true" tabindex="-1"></a>  P_norm <span class="ot">&lt;-</span> <span class="fu">sum</span>(P_s1_s2)</span>
<span id="cb131-248"><a href="#cb131-248" aria-hidden="true" tabindex="-1"></a>  P_type1_s1_s2 <span class="ot">&lt;-</span> P_s1_s2[<span class="st">'Type1'</span>] <span class="sc">/</span> P_norm</span>
<span id="cb131-249"><a href="#cb131-249" aria-hidden="true" tabindex="-1"></a>  P_type2_s1_s2 <span class="ot">&lt;-</span> P_s1_s2[<span class="st">'Type2'</span>] <span class="sc">/</span> P_norm</span>
<span id="cb131-250"><a href="#cb131-250" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-251"><a href="#cb131-251" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a list of values</span></span>
<span id="cb131-252"><a href="#cb131-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P_type2_s1_s2)</span>
<span id="cb131-253"><a href="#cb131-253" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-254"><a href="#cb131-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-255"><a href="#cb131-255" aria-hidden="true" tabindex="-1"></a>compute_posterior_2foot <span class="ot">&lt;-</span> <span class="cf">function</span>(a1, b2, s1, s2, tau) {</span>
<span id="cb131-256"><a href="#cb131-256" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-257"><a href="#cb131-257" aria-hidden="true" tabindex="-1"></a>  c1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-258"><a href="#cb131-258" aria-hidden="true" tabindex="-1"></a>  d1 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> a1</span>
<span id="cb131-259"><a href="#cb131-259" aria-hidden="true" tabindex="-1"></a>  a2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-260"><a href="#cb131-260" aria-hidden="true" tabindex="-1"></a>  c2 <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">-</span> b2</span>
<span id="cb131-261"><a href="#cb131-261" aria-hidden="true" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-262"><a href="#cb131-262" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-263"><a href="#cb131-263" aria-hidden="true" tabindex="-1"></a>  hy_ear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-264"><a href="#cb131-264" aria-hidden="true" tabindex="-1"></a>  hy_feet <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-265"><a href="#cb131-265" aria-hidden="true" tabindex="-1"></a>  hy_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>)</span>
<span id="cb131-266"><a href="#cb131-266" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-267"><a href="#cb131-267" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Participants' knowledge</span></span>
<span id="cb131-268"><a href="#cb131-268" aria-hidden="true" tabindex="-1"></a>  ear <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-269"><a href="#cb131-269" aria-hidden="true" tabindex="-1"></a>  foot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb131-270"><a href="#cb131-270" aria-hidden="true" tabindex="-1"></a>  kn <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">ear =</span> ear, <span class="at">foot =</span> foot)</span>
<span id="cb131-271"><a href="#cb131-271" aria-hidden="true" tabindex="-1"></a>  kn<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1, b1, c1, d1)</span>
<span id="cb131-272"><a href="#cb131-272" aria-hidden="true" tabindex="-1"></a>  kn<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2, b2, c2, d2)</span>
<span id="cb131-273"><a href="#cb131-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-274"><a href="#cb131-274" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ear experts' knowledge</span></span>
<span id="cb131-275"><a href="#cb131-275" aria-hidden="true" tabindex="-1"></a>  kn_ear <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ear =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb131-276"><a href="#cb131-276" aria-hidden="true" tabindex="-1"></a>  kn_ear<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1 <span class="sc">+</span> c1, b1 <span class="sc">+</span> d1)</span>
<span id="cb131-277"><a href="#cb131-277" aria-hidden="true" tabindex="-1"></a>  kn_ear<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2 <span class="sc">+</span> c2, b2 <span class="sc">+</span> d2)</span>
<span id="cb131-278"><a href="#cb131-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-279"><a href="#cb131-279" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Foot experts' knowledge</span></span>
<span id="cb131-280"><a href="#cb131-280" aria-hidden="true" tabindex="-1"></a>  kn_foot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">foot =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb131-281"><a href="#cb131-281" aria-hidden="true" tabindex="-1"></a>  kn_foot<span class="sc">$</span>Type1 <span class="ot">&lt;-</span> <span class="fu">c</span>(a1 <span class="sc">+</span> b1, c1 <span class="sc">+</span> d1)</span>
<span id="cb131-282"><a href="#cb131-282" aria-hidden="true" tabindex="-1"></a>  kn_foot<span class="sc">$</span>Type2 <span class="ot">&lt;-</span> <span class="fu">c</span>(a2 <span class="sc">+</span> b2, c2 <span class="sc">+</span> d2)</span>
<span id="cb131-283"><a href="#cb131-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-284"><a href="#cb131-284" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Form a hypothesis list</span></span>
<span id="cb131-285"><a href="#cb131-285" aria-hidden="true" tabindex="-1"></a>  hy_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb131-286"><a href="#cb131-286" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb131-287"><a href="#cb131-287" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (h1 <span class="cf">in</span> hy_ear) {</span>
<span id="cb131-288"><a href="#cb131-288" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (h2 <span class="cf">in</span> hy_feet) {</span>
<span id="cb131-289"><a href="#cb131-289" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (h3 <span class="cf">in</span> hy_type) {</span>
<span id="cb131-290"><a href="#cb131-290" aria-hidden="true" tabindex="-1"></a>        hy_list[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">h1 =</span> h1, <span class="at">h2 =</span> h2, <span class="at">type =</span> h3)</span>
<span id="cb131-291"><a href="#cb131-291" aria-hidden="true" tabindex="-1"></a>        i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb131-292"><a href="#cb131-292" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb131-293"><a href="#cb131-293" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-294"><a href="#cb131-294" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-295"><a href="#cb131-295" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-296"><a href="#cb131-296" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Using softmax transformation for expert responses:</span></span>
<span id="cb131-297"><a href="#cb131-297" aria-hidden="true" tabindex="-1"></a>  softmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x, tau) {</span>
<span id="cb131-298"><a href="#cb131-298" aria-hidden="true" tabindex="-1"></a>    exps <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">log</span>(x) <span class="sc">*</span> tau)</span>
<span id="cb131-299"><a href="#cb131-299" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="ot">&lt;-</span> exps <span class="sc">/</span> <span class="fu">sum</span>(exps)</span>
<span id="cb131-300"><a href="#cb131-300" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(probabilities)</span>
<span id="cb131-301"><a href="#cb131-301" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-302"><a href="#cb131-302" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-303"><a href="#cb131-303" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Loop over hypothesis space to compute probabilities</span></span>
<span id="cb131-304"><a href="#cb131-304" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (item <span class="cf">in</span> <span class="fu">seq_along</span>(hy_list)) {</span>
<span id="cb131-305"><a href="#cb131-305" aria-hidden="true" tabindex="-1"></a>    hyp <span class="ot">&lt;-</span> hy_list[[item]]</span>
<span id="cb131-306"><a href="#cb131-306" aria-hidden="true" tabindex="-1"></a>    ob_ear <span class="ot">&lt;-</span> hyp<span class="sc">$</span>h1</span>
<span id="cb131-307"><a href="#cb131-307" aria-hidden="true" tabindex="-1"></a>    ob_foot <span class="ot">&lt;-</span> hyp<span class="sc">$</span>h2</span>
<span id="cb131-308"><a href="#cb131-308" aria-hidden="true" tabindex="-1"></a>    type <span class="ot">&lt;-</span> hyp<span class="sc">$</span>type</span>
<span id="cb131-309"><a href="#cb131-309" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> kn<span class="sc">$</span>ear <span class="sc">==</span> ob_ear <span class="sc">&amp;</span> kn<span class="sc">$</span>foot <span class="sc">==</span> ob_foot</span>
<span id="cb131-310"><a href="#cb131-310" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute P(ob_ear,ob_foot,type|s1,s2)</span></span>
<span id="cb131-311"><a href="#cb131-311" aria-hidden="true" tabindex="-1"></a>    <span class="co">#P(s1,s2|ob_ear,ob_foot,type)*P(ob_ear,ob_foot,type)</span></span>
<span id="cb131-312"><a href="#cb131-312" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P(ob_ear, ob_foot, type) = P(ob_ear, ob_foot|type)*P(type)</span></span>
<span id="cb131-313"><a href="#cb131-313" aria-hidden="true" tabindex="-1"></a>    alpha_ob<span class="ot">=</span>kn[[type]][idx]</span>
<span id="cb131-314"><a href="#cb131-314" aria-hidden="true" tabindex="-1"></a>    beta_ob <span class="ot">=</span> <span class="dv">10</span><span class="sc">-</span>kn[[type]][idx]</span>
<span id="cb131-315"><a href="#cb131-315" aria-hidden="true" tabindex="-1"></a>    P_ob <span class="ot">&lt;-</span> alpha_ob<span class="sc">/</span>(alpha_ob<span class="sc">+</span>beta_ob)</span>
<span id="cb131-316"><a href="#cb131-316" aria-hidden="true" tabindex="-1"></a>    P_type <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb131-317"><a href="#cb131-317" aria-hidden="true" tabindex="-1"></a>    P_ob_type <span class="ot">&lt;-</span> P_ob <span class="sc">*</span> P_type</span>
<span id="cb131-318"><a href="#cb131-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-319"><a href="#cb131-319" aria-hidden="true" tabindex="-1"></a>    <span class="co">#P(s1,s2|ob_ear,ob_foot,type)</span></span>
<span id="cb131-320"><a href="#cb131-320" aria-hidden="true" tabindex="-1"></a>    <span class="co">#P(s1|ob_ear,ob_foot,type) * P(s2|ob_ear,ob_foot,type) </span></span>
<span id="cb131-321"><a href="#cb131-321" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For foot expert, use kn_foot:</span></span>
<span id="cb131-322"><a href="#cb131-322" aria-hidden="true" tabindex="-1"></a>    foot_idx <span class="ot">&lt;-</span> kn_foot<span class="sc">$</span>foot <span class="sc">==</span> ob_foot</span>
<span id="cb131-323"><a href="#cb131-323" aria-hidden="true" tabindex="-1"></a>    alpha_foot <span class="ot">&lt;-</span> kn_foot[[<span class="st">'Type1'</span>]][foot_idx]</span>
<span id="cb131-324"><a href="#cb131-324" aria-hidden="true" tabindex="-1"></a>    beta_foot <span class="ot">&lt;-</span> kn_foot[[<span class="st">'Type2'</span>]][foot_idx]</span>
<span id="cb131-325"><a href="#cb131-325" aria-hidden="true" tabindex="-1"></a>    P_s1_ob_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb131-326"><a href="#cb131-326" aria-hidden="true" tabindex="-1"></a>      alpha_foot<span class="sc">/</span>(alpha_foot<span class="sc">+</span>beta_foot),</span>
<span id="cb131-327"><a href="#cb131-327" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">-</span>alpha_foot<span class="sc">/</span>(alpha_foot<span class="sc">+</span>beta_foot)</span>
<span id="cb131-328"><a href="#cb131-328" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-329"><a href="#cb131-329" aria-hidden="true" tabindex="-1"></a>    P_s1_ob_list_sf <span class="ot">&lt;-</span> <span class="fu">softmax</span>(<span class="fu">unlist</span>(P_s1_ob_list), tau)</span>
<span id="cb131-330"><a href="#cb131-330" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s1 <span class="sc">==</span> <span class="st">"Type1"</span>) {</span>
<span id="cb131-331"><a href="#cb131-331" aria-hidden="true" tabindex="-1"></a>      P_s1_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">1</span>]</span>
<span id="cb131-332"><a href="#cb131-332" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (s1 <span class="sc">==</span> <span class="st">"Type2"</span>) {</span>
<span id="cb131-333"><a href="#cb131-333" aria-hidden="true" tabindex="-1"></a>      P_s1_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">2</span>]</span>
<span id="cb131-334"><a href="#cb131-334" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-335"><a href="#cb131-335" aria-hidden="true" tabindex="-1"></a>    <span class="co"># For the second foot expert, use kn_foot:</span></span>
<span id="cb131-336"><a href="#cb131-336" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s2 <span class="sc">==</span> <span class="st">"Type1"</span>) {</span>
<span id="cb131-337"><a href="#cb131-337" aria-hidden="true" tabindex="-1"></a>      P_s2_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">1</span>]</span>
<span id="cb131-338"><a href="#cb131-338" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (s2 <span class="sc">==</span> <span class="st">"Type2"</span>) {</span>
<span id="cb131-339"><a href="#cb131-339" aria-hidden="true" tabindex="-1"></a>      P_s2_ob <span class="ot">&lt;-</span> P_s1_ob_list_sf[<span class="dv">2</span>]</span>
<span id="cb131-340"><a href="#cb131-340" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-341"><a href="#cb131-341" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-342"><a href="#cb131-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-343"><a href="#cb131-343" aria-hidden="true" tabindex="-1"></a>    P_s1_s2_ob <span class="ot">&lt;-</span> P_s1_ob <span class="sc">*</span> P_s2_ob</span>
<span id="cb131-344"><a href="#cb131-344" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-345"><a href="#cb131-345" aria-hidden="true" tabindex="-1"></a>    <span class="co"># P(ob_ear, ob_foot, type | s1, s2)</span></span>
<span id="cb131-346"><a href="#cb131-346" aria-hidden="true" tabindex="-1"></a>    P_ob_s1_s2 <span class="ot">&lt;-</span> P_ob_type <span class="sc">*</span> P_s1_s2_ob</span>
<span id="cb131-347"><a href="#cb131-347" aria-hidden="true" tabindex="-1"></a>    hy_list[[item]][[<span class="st">"P_obs_given_signal"</span>]] <span class="ot">&lt;-</span> P_ob_s1_s2</span>
<span id="cb131-348"><a href="#cb131-348" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-349"><a href="#cb131-349" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-350"><a href="#cb131-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-351"><a href="#cb131-351" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Final posterior for Type1 and Type2</span></span>
<span id="cb131-352"><a href="#cb131-352" aria-hidden="true" tabindex="-1"></a>  P_s1_s2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span><span class="ot">=</span><span class="fl">0.001</span>,<span class="st">"Type2"</span><span class="ot">=</span><span class="fl">0.001</span>)</span>
<span id="cb131-353"><a href="#cb131-353" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-354"><a href="#cb131-354" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> hy_list) {</span>
<span id="cb131-355"><a href="#cb131-355" aria-hidden="true" tabindex="-1"></a>    type<span class="ot">=</span>i[[<span class="st">"type"</span>]]</span>
<span id="cb131-356"><a href="#cb131-356" aria-hidden="true" tabindex="-1"></a>    P_s1_s2[type] <span class="ot">&lt;-</span> P_s1_s2[type] <span class="sc">+</span> i[[<span class="st">"P_obs_given_signal"</span>]]</span>
<span id="cb131-357"><a href="#cb131-357" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-358"><a href="#cb131-358" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-359"><a href="#cb131-359" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optionally, you can compute normalized probabilities:</span></span>
<span id="cb131-360"><a href="#cb131-360" aria-hidden="true" tabindex="-1"></a>  P_norm <span class="ot">&lt;-</span> <span class="fu">sum</span>(P_s1_s2)</span>
<span id="cb131-361"><a href="#cb131-361" aria-hidden="true" tabindex="-1"></a>  P_type1_s1_s2 <span class="ot">&lt;-</span> P_s1_s2[<span class="st">'Type1'</span>] <span class="sc">/</span> P_norm</span>
<span id="cb131-362"><a href="#cb131-362" aria-hidden="true" tabindex="-1"></a>  P_type2_s1_s2 <span class="ot">&lt;-</span> P_s1_s2[<span class="st">'Type2'</span>] <span class="sc">/</span> P_norm</span>
<span id="cb131-363"><a href="#cb131-363" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-364"><a href="#cb131-364" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return a list of values</span></span>
<span id="cb131-365"><a href="#cb131-365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(P_type2_s1_s2)</span>
<span id="cb131-366"><a href="#cb131-366" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-367"><a href="#cb131-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-368"><a href="#cb131-368" aria-hidden="true" tabindex="-1"></a><span class="co"># Bayesian_update now references the named elements from each update</span></span>
<span id="cb131-369"><a href="#cb131-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute list of posterior weights based on agent types and condition-specific update rules</span></span>
<span id="cb131-370"><a href="#cb131-370" aria-hidden="true" tabindex="-1"></a>w_list3 <span class="ot">&lt;-</span> <span class="cf">function</span>(tau) {</span>
<span id="cb131-371"><a href="#cb131-371" aria-hidden="true" tabindex="-1"></a>  <span class="co"># First-round agent types</span></span>
<span id="cb131-372"><a href="#cb131-372" aria-hidden="true" tabindex="-1"></a>  s1_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>,</span>
<span id="cb131-373"><a href="#cb131-373" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>, <span class="st">"Type2"</span>,</span>
<span id="cb131-374"><a href="#cb131-374" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>,</span>
<span id="cb131-375"><a href="#cb131-375" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>, <span class="st">"Type2"</span>)</span>
<span id="cb131-376"><a href="#cb131-376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-377"><a href="#cb131-377" aria-hidden="true" tabindex="-1"></a>  s2_1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>, <span class="st">"Type2"</span>,</span>
<span id="cb131-378"><a href="#cb131-378" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>, <span class="st">"Type2"</span>,</span>
<span id="cb131-379"><a href="#cb131-379" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>, <span class="st">"Type2"</span>,</span>
<span id="cb131-380"><a href="#cb131-380" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Type1"</span>, <span class="st">"Type2"</span>, <span class="st">"Type1"</span>, <span class="st">"Type2"</span>)</span>
<span id="cb131-381"><a href="#cb131-381" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-382"><a href="#cb131-382" aria-hidden="true" tabindex="-1"></a>  a1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb131-383"><a href="#cb131-383" aria-hidden="true" tabindex="-1"></a>  b2 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb131-384"><a href="#cb131-384" aria-hidden="true" tabindex="-1"></a>  w_list <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">16</span>)  <span class="co"># Preallocate vector for weights</span></span>
<span id="cb131-385"><a href="#cb131-385" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-386"><a href="#cb131-386" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb131-387"><a href="#cb131-387" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)) {</span>
<span id="cb131-388"><a href="#cb131-388" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For conditions 1–4, use compute_posterior with s2 first, then s1</span></span>
<span id="cb131-389"><a href="#cb131-389" aria-hidden="true" tabindex="-1"></a>      w_list[i] <span class="ot">&lt;-</span> <span class="fu">compute_posterior</span>(a1, b2, s2_1[i], s1_1[i], tau)</span>
<span id="cb131-390"><a href="#cb131-390" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">13</span>, <span class="dv">14</span>)) {</span>
<span id="cb131-391"><a href="#cb131-391" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For conditions 5,6,13,14, use ear-based update</span></span>
<span id="cb131-392"><a href="#cb131-392" aria-hidden="true" tabindex="-1"></a>      w_list[i] <span class="ot">&lt;-</span> <span class="fu">compute_posterior_2ear</span>(a1, b2, s1_1[i], s2_1[i], tau)</span>
<span id="cb131-393"><a href="#cb131-393" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">15</span>, <span class="dv">16</span>)) {</span>
<span id="cb131-394"><a href="#cb131-394" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For conditions 7,8,15,16, use foot-based update</span></span>
<span id="cb131-395"><a href="#cb131-395" aria-hidden="true" tabindex="-1"></a>      w_list[i] <span class="ot">&lt;-</span> <span class="fu">compute_posterior_2foot</span>(a1, b2, s1_1[i], s2_1[i], tau)</span>
<span id="cb131-396"><a href="#cb131-396" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)) {</span>
<span id="cb131-397"><a href="#cb131-397" aria-hidden="true" tabindex="-1"></a>      <span class="co"># For conditions 9–12, use compute_posterior with s1 first, then s2</span></span>
<span id="cb131-398"><a href="#cb131-398" aria-hidden="true" tabindex="-1"></a>      w_list[i] <span class="ot">&lt;-</span> <span class="fu">compute_posterior</span>(a1, b2, s1_1[i], s2_1[i], tau)</span>
<span id="cb131-399"><a href="#cb131-399" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-400"><a href="#cb131-400" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-401"><a href="#cb131-401" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-402"><a href="#cb131-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(w_list)</span>
<span id="cb131-403"><a href="#cb131-403" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-404"><a href="#cb131-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-405"><a href="#cb131-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-406"><a href="#cb131-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-407"><a href="#cb131-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-408"><a href="#cb131-408" aria-hidden="true" tabindex="-1"></a>integral_function1 <span class="ot">&lt;-</span> <span class="cf">function</span>(ce,i,w_list) {</span>
<span id="cb131-409"><a href="#cb131-409" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span>w_list[i]</span>
<span id="cb131-410"><a href="#cb131-410" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> w <span class="sc">*</span> ce</span>
<span id="cb131-411"><a href="#cb131-411" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> w) <span class="sc">*</span> ce</span>
<span id="cb131-412"><a href="#cb131-412" aria-hidden="true" tabindex="-1"></a>  ll1 <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta)</span>
<span id="cb131-413"><a href="#cb131-413" aria-hidden="true" tabindex="-1"></a>  ll2 <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta)</span>
<span id="cb131-414"><a href="#cb131-414" aria-hidden="true" tabindex="-1"></a>  ll3 <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta)</span>
<span id="cb131-415"><a href="#cb131-415" aria-hidden="true" tabindex="-1"></a>  ll4 <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta)</span>
<span id="cb131-416"><a href="#cb131-416" aria-hidden="true" tabindex="-1"></a>  ll5 <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta)</span>
<span id="cb131-417"><a href="#cb131-417" aria-hidden="true" tabindex="-1"></a>  ll6 <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>, alpha, beta)</span>
<span id="cb131-418"><a href="#cb131-418" aria-hidden="true" tabindex="-1"></a>  ll_values <span class="ot">&lt;-</span> <span class="fu">c</span>(ll1, ll2, ll3, ll4, ll5, ll6)</span>
<span id="cb131-419"><a href="#cb131-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_values)</span>
<span id="cb131-420"><a href="#cb131-420" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-421"><a href="#cb131-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-422"><a href="#cb131-422" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create all_choice data for a given dataset</span></span>
<span id="cb131-423"><a href="#cb131-423" aria-hidden="true" tabindex="-1"></a>create_all_choice <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb131-424"><a href="#cb131-424" aria-hidden="true" tabindex="-1"></a>  conditions <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb131-425"><a href="#cb131-425" aria-hidden="true" tabindex="-1"></a>  all_data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) {</span>
<span id="cb131-426"><a href="#cb131-426" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb131-427"><a href="#cb131-427" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by_at</span>(<span class="fu">vars</span>(conditions[i])) <span class="sc">%&gt;%</span></span>
<span id="cb131-428"><a href="#cb131-428" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb131-429"><a href="#cb131-429" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">d =</span> conditions[i]) <span class="sc">%&gt;%</span></span>
<span id="cb131-430"><a href="#cb131-430" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">condition =</span> i)</span>
<span id="cb131-431"><a href="#cb131-431" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb131-432"><a href="#cb131-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(<span class="cf">function</span>(x, y) <span class="fu">full_join</span>(x, y, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"d"</span>, <span class="st">"condition"</span>, <span class="st">"count"</span>)), all_data) <span class="sc">%&gt;%</span></span>
<span id="cb131-433"><a href="#cb131-433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">as.numeric</span>(d))</span>
<span id="cb131-434"><a href="#cb131-434" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-435"><a href="#cb131-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-436"><a href="#cb131-436" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified objective function to take all_choice as input</span></span>
<span id="cb131-437"><a href="#cb131-437" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(par, all_choice) {</span>
<span id="cb131-438"><a href="#cb131-438" aria-hidden="true" tabindex="-1"></a>  ce <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">1</span>])</span>
<span id="cb131-439"><a href="#cb131-439" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">2</span>])</span>
<span id="cb131-440"><a href="#cb131-440" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-441"><a href="#cb131-441" aria-hidden="true" tabindex="-1"></a>  w_list <span class="ot">&lt;-</span> <span class="fu">w_list3</span>(tau)</span>
<span id="cb131-442"><a href="#cb131-442" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-443"><a href="#cb131-443" aria-hidden="true" tabindex="-1"></a>  ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-444"><a href="#cb131-444" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_choice)) {</span>
<span id="cb131-445"><a href="#cb131-445" aria-hidden="true" tabindex="-1"></a>    likert <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>d[m]</span>
<span id="cb131-446"><a href="#cb131-446" aria-hidden="true" tabindex="-1"></a>    condition <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>condition[m]</span>
<span id="cb131-447"><a href="#cb131-447" aria-hidden="true" tabindex="-1"></a>    count <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>count[m]</span>
<span id="cb131-448"><a href="#cb131-448" aria-hidden="true" tabindex="-1"></a>    sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function1</span>(ce, condition,w_list)</span>
<span id="cb131-449"><a href="#cb131-449" aria-hidden="true" tabindex="-1"></a>    ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb131-450"><a href="#cb131-450" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb131-451"><a href="#cb131-451" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-452"><a href="#cb131-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_log_sum)</span>
<span id="cb131-453"><a href="#cb131-453" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-454"><a href="#cb131-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-455"><a href="#cb131-455" aria-hidden="true" tabindex="-1"></a>n_subjects <span class="ot">&lt;-</span> <span class="fu">nrow</span>(final_data)</span>
<span id="cb131-456"><a href="#cb131-456" aria-hidden="true" tabindex="-1"></a>ll_matrix_nb <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_subjects, <span class="at">ncol =</span> <span class="dv">16</span>)</span>
<span id="cb131-457"><a href="#cb131-457" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ll_matrix_nb) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ll_nb_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb131-458"><a href="#cb131-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-459"><a href="#cb131-459" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_subjects) {</span>
<span id="cb131-460"><a href="#cb131-460" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split data into train and test</span></span>
<span id="cb131-461"><a href="#cb131-461" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> final_data[<span class="sc">-</span>i, ]</span>
<span id="cb131-462"><a href="#cb131-462" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> final_data[i, ]</span>
<span id="cb131-463"><a href="#cb131-463" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-464"><a href="#cb131-464" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare training data</span></span>
<span id="cb131-465"><a href="#cb131-465" aria-hidden="true" tabindex="-1"></a>  all_choice_train <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(train_data)</span>
<span id="cb131-466"><a href="#cb131-466" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-467"><a href="#cb131-467" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit model on training data</span></span>
<span id="cb131-468"><a href="#cb131-468" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb131-469"><a href="#cb131-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">5</span>),<span class="dv">0</span>),</span>
<span id="cb131-470"><a href="#cb131-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> objective_function,</span>
<span id="cb131-471"><a href="#cb131-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_choice =</span> all_choice_train</span>
<span id="cb131-472"><a href="#cb131-472" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb131-473"><a href="#cb131-473" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-474"><a href="#cb131-474" aria-hidden="true" tabindex="-1"></a>  ce_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb131-475"><a href="#cb131-475" aria-hidden="true" tabindex="-1"></a>  tau_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb131-476"><a href="#cb131-476" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-477"><a href="#cb131-477" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb131-478"><a href="#cb131-478" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute likelihoods on left-out subject, broken down by condition</span></span>
<span id="cb131-479"><a href="#cb131-479" aria-hidden="true" tabindex="-1"></a>  all_choice_test <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(test_data)</span>
<span id="cb131-480"><a href="#cb131-480" aria-hidden="true" tabindex="-1"></a>  final_data<span class="sc">$</span>ll_nb[i] <span class="ot">&lt;-</span> <span class="fu">objective_function</span>(result<span class="sc">$</span>par,all_choice_test)</span>
<span id="cb131-481"><a href="#cb131-481" aria-hidden="true" tabindex="-1"></a>  w_list<span class="ot">&lt;-</span><span class="fu">w_list3</span>(tau_train)</span>
<span id="cb131-482"><a href="#cb131-482" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb131-483"><a href="#cb131-483" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter only rows from this condition</span></span>
<span id="cb131-484"><a href="#cb131-484" aria-hidden="true" tabindex="-1"></a>    cond_rows <span class="ot">&lt;-</span> all_choice_test[all_choice_test<span class="sc">$</span>condition <span class="sc">==</span> cond, ]</span>
<span id="cb131-485"><a href="#cb131-485" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb131-486"><a href="#cb131-486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(cond_rows) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb131-487"><a href="#cb131-487" aria-hidden="true" tabindex="-1"></a>      sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function1</span>(ce_train, cond,w_list)</span>
<span id="cb131-488"><a href="#cb131-488" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cond_rows)) {</span>
<span id="cb131-489"><a href="#cb131-489" aria-hidden="true" tabindex="-1"></a>        likert <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>d[m]</span>
<span id="cb131-490"><a href="#cb131-490" aria-hidden="true" tabindex="-1"></a>        count <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>count[m]</span>
<span id="cb131-491"><a href="#cb131-491" aria-hidden="true" tabindex="-1"></a>        ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb131-492"><a href="#cb131-492" aria-hidden="true" tabindex="-1"></a>        ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb131-493"><a href="#cb131-493" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb131-494"><a href="#cb131-494" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-495"><a href="#cb131-495" aria-hidden="true" tabindex="-1"></a>    ll_matrix_nb[i, cond] <span class="ot">&lt;-</span> ll_log_sum</span>
<span id="cb131-496"><a href="#cb131-496" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-497"><a href="#cb131-497" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `ll_nb`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ll_matrix_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2648.209</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>all_choice_full <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(final_data)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model to full dataset</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>result_full <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co"># log(ce), logit(n)</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> objective_function,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">all_choice =</span> all_choice_full</span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fitted parameters</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a>ce_nb <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>tau_nb <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fitted parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitted parameters:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(ce_nb,tau_nb ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.055232 4.139507</code></pre>
</div>
</div>
</section>
<section id="majority-vote" class="level2">
<h2 class="anchored" data-anchor-id="majority-vote">Majority Vote</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define alpha and beta</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>integral_function2<span class="ot">&lt;-</span><span class="cf">function</span>(ce,i,n){</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>   w_list2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>  w_list1 <span class="ot">&lt;-</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="fl">0.5</span>,<span class="fl">0.5</span>, (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),(<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),<span class="fl">0.5</span>,<span class="fl">0.5</span>,(<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),(<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>  w1<span class="ot">&lt;-</span>w_list1[i]</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>  w2<span class="ot">&lt;-</span>w_list2[i]</span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>  alpha<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>w2<span class="sc">*</span>ce</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>  beta<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>w1<span class="sc">*</span>ce</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>  ll1<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>  ll2<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>  ll3<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>  ll4<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>  ll5<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>  ll6<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a list</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>  ll_values <span class="ot">&lt;-</span> <span class="fu">c</span>(ll1,ll2,ll3,ll4,ll5,ll6)</span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_values)</span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create all_choice data for a given dataset</span></span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>create_all_choice <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>  conditions <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a>  all_data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) {</span>
<span id="cb139-27"><a href="#cb139-27" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb139-28"><a href="#cb139-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by_at</span>(<span class="fu">vars</span>(conditions[i])) <span class="sc">%&gt;%</span></span>
<span id="cb139-29"><a href="#cb139-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb139-30"><a href="#cb139-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">d =</span> conditions[i]) <span class="sc">%&gt;%</span></span>
<span id="cb139-31"><a href="#cb139-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">condition =</span> i)</span>
<span id="cb139-32"><a href="#cb139-32" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb139-33"><a href="#cb139-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(<span class="cf">function</span>(x, y) <span class="fu">full_join</span>(x, y, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"d"</span>, <span class="st">"condition"</span>, <span class="st">"count"</span>)), all_data) <span class="sc">%&gt;%</span></span>
<span id="cb139-34"><a href="#cb139-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">as.numeric</span>(d))</span>
<span id="cb139-35"><a href="#cb139-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-36"><a href="#cb139-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-37"><a href="#cb139-37" aria-hidden="true" tabindex="-1"></a>logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb139-38"><a href="#cb139-38" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb139-39"><a href="#cb139-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-40"><a href="#cb139-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-41"><a href="#cb139-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified objective function to take all_choice as input</span></span>
<span id="cb139-42"><a href="#cb139-42" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(par, all_choice) {</span>
<span id="cb139-43"><a href="#cb139-43" aria-hidden="true" tabindex="-1"></a>  ce <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">1</span>])</span>
<span id="cb139-44"><a href="#cb139-44" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">2</span>])</span>
<span id="cb139-45"><a href="#cb139-45" aria-hidden="true" tabindex="-1"></a>  ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb139-46"><a href="#cb139-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-47"><a href="#cb139-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_choice)) {</span>
<span id="cb139-48"><a href="#cb139-48" aria-hidden="true" tabindex="-1"></a>    likert <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>d[m]</span>
<span id="cb139-49"><a href="#cb139-49" aria-hidden="true" tabindex="-1"></a>    condition <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>condition[m]</span>
<span id="cb139-50"><a href="#cb139-50" aria-hidden="true" tabindex="-1"></a>    count <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>count[m]</span>
<span id="cb139-51"><a href="#cb139-51" aria-hidden="true" tabindex="-1"></a>    sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function2</span>(ce, condition, n)</span>
<span id="cb139-52"><a href="#cb139-52" aria-hidden="true" tabindex="-1"></a>    ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb139-53"><a href="#cb139-53" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb139-54"><a href="#cb139-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb139-55"><a href="#cb139-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_log_sum)</span>
<span id="cb139-56"><a href="#cb139-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb139-57"><a href="#cb139-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-58"><a href="#cb139-58" aria-hidden="true" tabindex="-1"></a><span class="co"># LOO-CV setup</span></span>
<span id="cb139-59"><a href="#cb139-59" aria-hidden="true" tabindex="-1"></a>n_subjects <span class="ot">&lt;-</span> <span class="fu">nrow</span>(final_data)</span>
<span id="cb139-60"><a href="#cb139-60" aria-hidden="true" tabindex="-1"></a>ll_matrix_mv <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_subjects, <span class="at">ncol =</span> <span class="dv">16</span>)</span>
<span id="cb139-61"><a href="#cb139-61" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ll_matrix_mv) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ll_mv_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb139-62"><a href="#cb139-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-63"><a href="#cb139-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_subjects) {</span>
<span id="cb139-64"><a href="#cb139-64" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> final_data[<span class="sc">-</span>i, ]</span>
<span id="cb139-65"><a href="#cb139-65" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> final_data[i, ]</span>
<span id="cb139-66"><a href="#cb139-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-67"><a href="#cb139-67" aria-hidden="true" tabindex="-1"></a>  all_choice_train <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(train_data)</span>
<span id="cb139-68"><a href="#cb139-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-69"><a href="#cb139-69" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb139-70"><a href="#cb139-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb139-71"><a href="#cb139-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> objective_function,</span>
<span id="cb139-72"><a href="#cb139-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_choice =</span> all_choice_train</span>
<span id="cb139-73"><a href="#cb139-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb139-74"><a href="#cb139-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-75"><a href="#cb139-75" aria-hidden="true" tabindex="-1"></a>  ce_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb139-76"><a href="#cb139-76" aria-hidden="true" tabindex="-1"></a>  n_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb139-77"><a href="#cb139-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-78"><a href="#cb139-78" aria-hidden="true" tabindex="-1"></a>  all_choice_test <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(test_data)</span>
<span id="cb139-79"><a href="#cb139-79" aria-hidden="true" tabindex="-1"></a>  final_data<span class="sc">$</span>ll_mv[i] <span class="ot">&lt;-</span> <span class="fu">objective_function</span>(result<span class="sc">$</span>par,all_choice_test)</span>
<span id="cb139-80"><a href="#cb139-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb139-81"><a href="#cb139-81" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb139-82"><a href="#cb139-82" aria-hidden="true" tabindex="-1"></a>    cond_rows <span class="ot">&lt;-</span> all_choice_test[all_choice_test<span class="sc">$</span>condition <span class="sc">==</span> cond, ]</span>
<span id="cb139-83"><a href="#cb139-83" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb139-84"><a href="#cb139-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(cond_rows) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb139-85"><a href="#cb139-85" aria-hidden="true" tabindex="-1"></a>      sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function2</span>(ce_train, cond, n_train)</span>
<span id="cb139-86"><a href="#cb139-86" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cond_rows)) {</span>
<span id="cb139-87"><a href="#cb139-87" aria-hidden="true" tabindex="-1"></a>        likert <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>d[m]</span>
<span id="cb139-88"><a href="#cb139-88" aria-hidden="true" tabindex="-1"></a>        count <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>count[m]</span>
<span id="cb139-89"><a href="#cb139-89" aria-hidden="true" tabindex="-1"></a>        ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb139-90"><a href="#cb139-90" aria-hidden="true" tabindex="-1"></a>        ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb139-91"><a href="#cb139-91" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb139-92"><a href="#cb139-92" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb139-93"><a href="#cb139-93" aria-hidden="true" tabindex="-1"></a>    ll_matrix_mv[i, cond] <span class="ot">&lt;-</span> ll_log_sum</span>
<span id="cb139-94"><a href="#cb139-94" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb139-95"><a href="#cb139-95" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `ll_mv`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ll_matrix_mv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        ll_mv_1   ll_mv_2  ll_mv_3  ll_mv_4   ll_mv_5   ll_mv_6   ll_mv_7
 [1,] 0.8685730 3.4128585 2.596384 2.596384 1.2652752 1.7611431 1.2652752
 [2,] 1.2663793 1.7572514 1.686219 1.686219 1.7572514 1.7572514 1.7572514
 [3,] 1.7594017 2.4175314 1.427153 1.686269 0.8708496 1.2657623 5.3295252
 [4,] 0.8698553 2.4195752 1.686287 1.686287 0.8698553 3.4077900 0.8698553
 [5,] 0.8775872 1.2672437 1.686157 1.686157 0.8775872 1.2672437 3.3775091
 [6,] 0.8812780 0.8812780 2.577381 1.686108 0.8812780 0.8812780 0.8812780
 [7,] 0.8821048 0.8821048 1.432588 1.432588 0.8821048 0.8821048 0.8821048
 [8,] 1.2667158 1.2667158 1.429265 1.429265 1.2667158 1.2667158 5.2987380
 [9,] 1.2658772 1.2658772 1.686259 1.686259 1.7589939 1.7589939 1.7589939
[10,] 1.2667705 3.3857763 1.429384 1.686190 0.8754641 0.8754641 1.2667705
[11,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[12,] 1.2678296 1.2678296 1.686122 1.686122 1.2678296 0.8801797 0.8801797
[13,] 0.8704763 0.8704763 1.686275 1.426972 0.8704763 0.8704763 0.8704763
[14,] 0.8818120 0.8818120 1.686101 1.686101 0.8818120 0.8818120 0.8818120
[15,] 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031 1.2673031
[16,] 0.8818120 0.8818120 1.686101 1.686101 0.8818120 0.8818120 0.8818120
[17,] 0.8731637 0.8731637 1.428271 1.428271 1.7576472 1.7576472 1.7576472
[18,] 1.2656942 1.2656942 1.686274 1.686274 3.4051150 0.8705334 1.2656942
[19,] 0.8766589 0.8766589 1.429961 1.686171 1.7550276 3.3811197 1.7550276
[20,] 0.8769486 0.8769486 1.430101 1.430101 0.8769486 0.8769486 1.2671008
[21,] 0.8722026 1.2660549 1.686244 1.686244 0.8722026 0.8722026 1.2660549
[22,] 0.8715081 0.8715081 2.591955 2.591955 1.2659039 1.2659039 1.2659039
[23,] 2.4549486 5.4576134 1.418486 1.686690 1.7734548 5.4576134 5.4576134
[24,] 0.8685025 3.4131378 2.596491 2.596491 1.2652602 1.2652602 1.7611972
[25,] 1.2665208 1.2665208 1.686208 1.428838 1.7567662 0.8743339 2.4104091
[26,] 0.8787664 0.8787664 2.581082 2.581082 0.8787664 0.8787664 0.8787664
[27,] 0.8625473 0.8625473 2.605544 2.605544 0.8625473 5.3886904 5.3886904
[28,] 0.8656999 2.4281715 1.424657 1.424657 1.7633628 1.2646706 2.4281715
[29,] 1.2676114 1.2676114 1.431196 1.431196 1.2676114 1.2676114 1.2676114
[30,] 1.2674312 0.8784209 1.430812 1.430812 1.2674312 1.2674312 1.2674312
[31,] 1.2671722 1.2671722 1.686162 1.430256 1.2671722 1.2671722 1.2671722
[32,] 0.8803534 0.8803534 1.686119 1.686119 0.8803534 0.8803534 0.8803534
[33,] 0.8810321 0.8810321 1.686111 1.686111 0.8810321 0.8810321 0.8810321
[34,] 1.2677134 0.8796684 1.431413 1.431413 0.8796684 0.8796684 1.2677134
[35,] 1.2671722 1.2671722 1.430256 1.686162 1.2671722 1.2671722 1.2671722
[36,] 0.8791689 1.2676002 1.686135 1.431173 1.2676002 0.8791689 0.8791689
[37,] 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031 1.2673031
[38,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[39,] 0.8768999 0.8768999 2.583866 2.583866 0.8768999 0.8768999 0.8768999
[40,] 1.2669653 1.2669653 1.429808 1.429808 1.2669653 1.7552641 1.2669653
[41,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[42,] 1.2677620 0.8798825 1.431517 1.431517 0.8798825 0.8798825 1.2677620
[43,] 0.8803534 0.8803534 1.686119 1.686119 0.8803534 0.8803534 0.8803534
[44,] 0.8787293 0.8787293 1.686141 1.430961 1.2675008 1.2675008 1.2675008
[45,] 0.8802055 1.2678352 1.431672 1.686121 0.8802055 1.2678352 1.7524058
[46,] 1.2660264 1.2660264 1.686246 1.686246 1.7584739 1.7584739 1.7584739
[47,] 0.8818117 0.8818117 1.686101 1.432446 0.8818117 0.8818117 0.8818117
[48,] 2.4392405 3.4454286 2.608811 1.422087 1.7675135 1.2635865 2.4392405
[49,] 0.8796332 0.8796332 1.431396 1.686129 1.2677050 1.2677050 1.2677050
[50,] 1.7565886 1.7565886 1.428947 1.428947 1.7565886 1.2665680 1.7565886
[51,] 1.2679734 0.8808105 1.431964 1.431964 0.8808105 0.8808105 1.2679734
[52,] 2.4135255 1.7579177 1.428099 1.428099 1.7579177 1.2661860 0.8728057
[53,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[54,] 0.8751489 1.2666991 1.686195 1.429230 1.2666991 1.7561547 0.8751489
[55,] 0.8813279 0.8813279 1.686107 1.686107 0.8813279 0.8813279 0.8813279
[56,] 2.4187512 1.7598543 1.426865 1.426865 1.7598543 1.7598543 1.7598543
[57,] 0.8818120 0.8818120 1.686101 1.686101 0.8818120 0.8818120 0.8818120
[58,] 1.2671964 1.2671964 1.430308 1.686161 1.2671964 1.2671964 1.2671964
[59,] 0.8770027 1.2670855 1.686167 2.583798 1.2670855 0.8770027 1.2670855
[60,] 0.8723116 1.2660786 1.427860 1.427860 1.2660786 1.2660786 1.2660786
[61,] 2.4149220 1.7584344 1.427769 1.686246 1.7584344 3.3988612 1.7584344
[62,] 0.8821048 1.2682704 1.432588 1.432588 0.8821048 0.8821048 0.8821048
[63,] 0.8818117 0.8818117 1.686101 1.432446 0.8818117 0.8818117 0.8818117
[64,] 0.8762624 1.2669476 1.686177 1.686177 0.8762624 5.2914058 1.2669476
[65,] 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031 1.2673031
[66,] 0.8810204 1.2680215 1.432065 1.432065 1.2680215 0.8810204 0.8810204
[67,] 0.8673658 5.3542493 2.598213 2.598213 1.2650198 1.2650198 1.2650198
[68,] 0.8731637 2.4127955 1.686227 2.589466 1.2662634 1.2662634 1.7576472
[69,] 1.2662992 1.7575194 1.428352 1.428352 1.7575194 1.7575194 1.7575194
[70,] 0.8818120 0.8818120 1.686101 1.432446 0.8818120 0.8818120 0.8818120
[71,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[72,] 0.8702194 0.8702194 2.593896 2.593896 1.7598821 1.2656268 1.7598821
[73,] 0.8804176 0.8804176 1.431756 1.431756 1.2678652 1.2678652 0.8804176
[74,] 0.8766216 0.8766216 2.584282 1.686172 0.8766216 0.8766216 0.8766216
[75,] 0.8788836 0.8788836 1.431035 1.431035 1.2675356 1.2675356 1.2675356
[76,] 0.8822617 0.8822617 1.432662 1.432662 0.8822617 0.8822617 0.8822617
[77,] 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031 1.2673031
[78,] 1.7541420 1.2673031 1.430537 1.430537 0.8778515 1.7541420 0.8778515
[79,] 0.8775373 1.2671939 1.686159 2.583035 0.8775373 0.8775373 0.8775373
[80,] 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031 1.2673031
[81,] 2.4572171 1.7743177 2.621834 1.686721 2.4572171 1.7743177 1.2619351
[82,] 1.7649956 5.3811217 2.603936 2.603936 1.7649956 1.7649956 1.7649956
[83,] 0.8759945 0.8759945 2.585219 2.585219 0.8759945 5.2932828 0.8759945
[84,] 0.8732702 0.8732702 2.589303 2.589303 0.8732702 1.2662877 1.7575670
[85,] 1.2668084 1.2668084 1.429467 1.429467 1.2668084 1.2668084 1.2668084
[86,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[87,] 1.2664504 2.4110522 1.428685 1.686213 1.2664504 1.2664504 0.8740189
[88,] 1.2668742 0.8759328 1.429611 1.429611 1.7555689 3.3839492 1.7555689
[89,] 1.2664708 1.2664708 1.428729 1.428729 1.2664708 1.2664708 1.7569352
[90,] 1.2680215 1.2680215 1.432065 1.432065 0.8810204 0.8810204 0.8810204
[91,] 1.2661215 1.2661215 2.590448 1.686239 1.2661215 1.2661215 1.7581423
[92,] 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389 0.8823389
[93,] 0.8784254 5.2762693 1.430814 1.430814 0.8784254 0.8784254 0.8784254
[94,] 3.4383005 5.3912872 2.606099 1.686450 5.3912872 1.7661093 2.4355085
[95,] 0.8541890 0.8541890 1.419052 2.618403 1.7725061 3.4706434 5.4491512
[96,] 3.4136381 0.8683791 2.596687 2.596687 1.2652312 3.4136381 0.8683791
        ll_mv_8   ll_mv_9  ll_mv_10 ll_mv_11 ll_mv_12  ll_mv_13  ll_mv_14
 [1,] 1.2652752 0.8685730 5.3456655 2.596384 2.596384 1.2652752 1.2652752
 [2,] 0.8736890 1.7572514 1.2663793 1.428526 2.588674 1.7572514 1.7572514
 [3,] 2.4175314 0.8708496 0.8708496 1.686269 1.686269 1.7594017 1.2657623
 [4,] 3.4077900 0.8698553 2.4195752 2.594446 1.686287 0.8698553 2.4195752
 [5,] 0.8775872 1.2672437 0.8775872 1.686157 1.686157 0.8775872 0.8775872
 [6,] 0.8812780 0.8812780 0.8812780 1.432178 1.432178 0.8812780 0.8812780
 [7,] 0.8821048 1.2682704 0.8821048 1.432588 1.432588 0.8821048 0.8821048
 [8,] 1.2667158 1.2667158 1.2667158 1.429265 1.429265 0.8752171 1.2667158
 [9,] 1.7589939 1.2658772 1.2658772 1.686259 1.686259 1.7589939 2.4164331
[10,] 1.2667705 1.7559191 1.2667705 1.686190 1.429384 1.2667705 1.2667705
[11,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[12,] 0.8801797 0.8801797 0.8801797 1.686122 1.686122 0.8801797 0.8801797
[13,] 0.8704763 2.4182980 3.4053399 1.686275 1.426972 1.2656820 3.4053399
[14,] 0.8818120 0.8818120 0.8818120 1.432446 1.432446 0.8818120 0.8818120
[15,] 1.2673031 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031
[16,] 0.8818120 0.8818120 0.8818120 1.432446 1.432446 0.8818120 0.8818120
[17,] 1.7576472 0.8731637 0.8731637 1.428271 1.428271 1.2662634 3.3947787
[18,] 1.2656942 0.8705334 3.4051150 1.686274 1.686274 1.2656942 3.4051150
[19,] 0.8766589 0.8766589 0.8766589 1.686171 1.686171 1.2670360 1.2670360
[20,] 0.8769486 5.2865969 0.8769486 1.686167 1.430101 1.2671008 0.8769486
[21,] 0.8722026 5.3199632 0.8722026 1.427808 2.590908 3.3985466 1.7583740
[22,] 1.2659039 0.8715081 5.3248730 2.591955 2.591955 1.2659039 1.2659039
[23,] 2.4549486 2.4549486 5.4576134 1.418486 1.418486 3.4753832 5.4576134
[24,] 1.7611972 0.8685025 3.4131378 2.596491 2.596491 1.2652602 1.2652602
[25,] 3.3901925 1.2665208 2.4104091 1.686208 1.686208 0.8743339 0.8743339
[26,] 0.8787664 0.8787664 0.8787664 2.581082 2.581082 0.8787664 0.8787664
[27,] 0.8625473 5.3886904 0.8625473 2.605544 2.605544 0.8625473 5.3886904
[28,] 5.3661239 3.4242622 1.2646706 1.686371 1.424657 2.4281715 2.4281715
[29,] 1.2676114 1.2676114 0.8792183 1.431196 1.431196 0.8792183 0.8792183
[30,] 1.2674312 0.8784209 0.8784209 2.581597 1.430812 1.2674312 1.2674312
[31,] 1.2671722 1.2671722 1.2671722 1.430256 1.686162 1.2671722 1.2671722
[32,] 0.8803534 0.8803534 0.8803534 1.686119 2.578721 0.8803534 0.8803534
[33,] 0.8810321 0.8810321 1.2680242 1.686111 1.686111 0.8810321 0.8810321
[34,] 1.2677134 1.2677134 0.8796684 1.431413 1.431413 1.7528006 0.8796684
[35,] 1.2671722 1.2671722 1.2671722 1.430256 1.686162 1.2671722 1.2671722
[36,] 1.2676002 1.2676002 1.2676002 1.686135 1.431173 1.2676002 1.2676002
[37,] 1.2673031 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031
[38,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[39,] 1.7548483 0.8768999 0.8768999 2.583866 2.583866 0.8768999 0.8768999
[40,] 1.2669653 1.2669653 1.7552641 1.429808 1.429808 1.2669653 1.2669653
[41,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[42,] 1.2677620 1.2677620 0.8798825 1.686125 1.686125 1.2677620 0.8798825
[43,] 0.8803534 0.8803534 1.2678692 2.578721 1.686119 0.8803534 0.8803534
[44,] 1.2675008 0.8787293 0.8787293 1.430961 1.686141 1.2675008 1.2675008
[45,] 0.8802055 0.8802055 1.2678352 1.431672 1.431672 0.8802055 0.8802055
[46,] 2.4150279 1.2660264 1.2660264 1.686246 1.686246 1.7584739 1.7584739
[47,] 0.8818117 0.8818117 0.8818117 1.686101 1.686101 0.8818117 0.8818117
[48,] 3.4454286 3.4454286 3.4454286 1.686493 1.686493 1.7675135 3.4454286
[49,] 0.8796332 0.8796332 0.8796332 1.431396 1.431396 1.2677050 1.2677050
[50,] 1.2665680 1.2665680 1.2665680 1.686204 1.428947 1.7565886 1.2665680
[51,] 0.8808105 0.8808105 0.8808105 1.431964 2.578042 0.8808105 0.8808105
[52,] 1.7579177 1.2661860 3.3961796 1.428099 1.686234 1.2661860 1.2661860
[53,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[54,] 1.2666991 1.7561547 1.7561547 1.429230 1.429230 1.7561547 1.7561547
[55,] 0.8813279 0.8813279 0.8813279 1.686107 1.686107 0.8813279 0.8813279
[56,] 1.7598543 3.4062095 1.2656346 1.426865 1.426865 1.7598543 1.7598543
[57,] 0.8818120 0.8818120 0.8818120 1.432446 1.432446 0.8818120 0.8818120
[58,] 1.2671964 1.2671964 1.2671964 1.686161 2.583155 0.8773759 1.2671964
[59,] 0.8770027 1.2670855 1.2670855 1.686167 1.686167 1.2670855 1.2670855
[60,] 1.7582915 2.4145354 1.7582915 1.686242 1.427860 3.3981187 1.7582915
[61,] 1.7584344 0.8721228 0.8721228 1.427769 1.427769 0.8721228 3.3988612
[62,] 0.8821048 0.8821048 0.8821048 1.432588 1.432588 0.8821048 0.8821048
[63,] 0.8818117 0.8818117 0.8818117 1.686101 1.686101 0.8818117 0.8818117
[64,] 0.8762624 0.8762624 0.8762624 1.686177 1.429770 1.2669476 0.8762624
[65,] 1.2673031 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031
[66,] 0.8810204 1.2680215 0.8810204 1.432065 1.432065 1.2680215 0.8810204
[67,] 1.2650198 0.8673658 5.3542493 2.598213 2.598213 1.2650198 1.2650198
[68,] 1.7576472 0.8731637 1.2662634 2.589466 1.428271 1.2662634 1.2662634
[69,] 1.7575194 1.2662992 1.2662992 1.686225 1.428352 1.7575194 1.7575194
[70,] 0.8818120 0.8818120 0.8818120 1.686101 1.432446 0.8818120 0.8818120
[71,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[72,] 2.4188260 1.2656268 0.8702194 1.686280 2.593896 1.7598821 1.7598821
[73,] 0.8804176 0.8804176 0.8804176 1.431756 1.431756 0.8804176 0.8804176
[74,] 0.8766216 5.2888870 0.8766216 1.686172 1.686172 0.8766216 0.8766216
[75,] 1.2675356 1.2675356 0.8788836 1.431035 1.431035 1.2675356 1.2675356
[76,] 0.8822617 0.8822617 0.8822617 1.686096 1.432662 0.8822617 0.8822617
[77,] 1.2673031 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031
[78,] 2.4032807 1.2673031 1.2673031 1.430537 1.686154 0.8778515 0.8778515
[79,] 1.2671939 0.8775373 1.2671939 2.583035 2.583035 1.2671939 0.8775373
[80,] 1.2673031 1.2673031 1.2673031 1.430537 1.430537 1.2673031 1.2673031
[81,] 1.2619351 5.4653252 3.4797014 2.621834 1.686721 5.4653252 5.4653252
[82,] 1.7649956 0.8636061 5.3811217 2.603936 2.603936 1.2642343 1.7649956
[83,] 0.8759945 0.8759945 0.8759945 1.429641 1.686181 0.8759945 1.2668882
[84,] 0.8732702 0.8732702 5.3124334 2.589303 2.589303 0.8732702 0.8732702
[85,] 1.2668084 3.3851082 1.2668084 1.429467 1.429467 1.2668084 1.2668084
[86,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[87,] 1.7570028 2.4110522 0.8740189 1.428685 1.428685 1.7570028 1.7570028
[88,] 1.7555689 0.8759328 0.8759328 1.429611 1.429611 0.8759328 0.8759328
[89,] 1.7569352 1.2664708 1.7569352 1.428729 1.428729 1.7569352 1.7569352
[90,] 0.8810204 1.2680215 1.2680215 1.432065 1.432065 0.8810204 0.8810204
[91,] 2.4141324 0.8725087 1.2661215 2.590448 1.686239 1.7581423 0.8725087
[92,] 0.8823389 0.8823389 0.8823389 1.432700 1.432700 0.8823389 0.8823389
[93,] 0.8784254 0.8784254 0.8784254 1.430814 1.430814 0.8784254 0.8784254
[94,] 1.2639445 0.8621883 5.3912872 1.422949 2.606099 0.8621883 1.2639445
[95,] 5.4491512 0.8541890 5.4491512 1.419052 2.618403 1.2623567 3.4706434
[96,] 1.2652312 3.4136381 2.4226231 1.686316 1.686316 0.8683791 2.4226231
       ll_mv_15  ll_mv_16
 [1,] 1.2652752 1.2652752
 [2,] 1.2663793 0.8736890
 [3,] 1.2657623 1.7594017
 [4,] 0.8698553 2.4195752
 [5,] 0.8775872 1.2672437
 [6,] 0.8812780 0.8812780
 [7,] 0.8821048 0.8821048
 [8,] 0.8752171 0.8752171
 [9,] 2.4164331 1.7589939
[10,] 1.2667705 1.2667705
[11,] 0.8823389 0.8823389
[12,] 0.8801797 0.8801797
[13,] 5.3321668 1.7596861
[14,] 0.8818120 0.8818120
[15,] 1.2673031 1.2673031
[16,] 0.8818120 0.8818120
[17,] 1.2662634 3.3947787
[18,] 1.7596426 1.7596426
[19,] 0.8766589 0.8766589
[20,] 0.8769486 1.2671008
[21,] 1.2660549 1.2660549
[22,] 1.2659039 1.2659039
[23,] 1.7734548 1.2621362
[24,] 1.7611972 1.7611972
[25,] 0.8743339 0.8743339
[26,] 0.8787664 0.8787664
[27,] 0.8625473 0.8625473
[28,] 2.4281715 1.7633628
[29,] 0.8792183 1.2676114
[30,] 1.2674312 0.8784209
[31,] 1.2671722 1.2671722
[32,] 0.8803534 1.2678692
[33,] 0.8810321 0.8810321
[34,] 0.8796684 1.2677134
[35,] 1.2671722 1.2671722
[36,] 0.8791689 0.8791689
[37,] 1.2673031 1.2673031
[38,] 0.8823389 0.8823389
[39,] 0.8768999 1.7548483
[40,] 1.7552641 1.2669653
[41,] 0.8823389 0.8823389
[42,] 0.8798825 0.8798825
[43,] 0.8803534 0.8803534
[44,] 1.2675008 1.2675008
[45,] 0.8802055 0.8802055
[46,] 1.2660264 2.4150279
[47,] 0.8818117 0.8818117
[48,] 2.4392405 2.4392405
[49,] 1.2677050 1.2677050
[50,] 1.7565886 1.2665680
[51,] 0.8808105 0.8808105
[52,] 1.2661860 1.7579177
[53,] 0.8823389 0.8823389
[54,] 1.7561547 1.7561547
[55,] 0.8813279 0.8813279
[56,] 1.7598543 1.7598543
[57,] 0.8818120 0.8818120
[58,] 1.2671964 0.8773759
[59,] 1.2670855 1.2670855
[60,] 1.7582915 1.7582915
[61,] 0.8721228 1.2660373
[62,] 0.8821048 0.8821048
[63,] 0.8818117 0.8818117
[64,] 0.8762624 0.8762624
[65,] 1.2673031 1.2673031
[66,] 0.8810204 0.8810204
[67,] 1.2650198 1.2650198
[68,] 1.7576472 1.7576472
[69,] 1.7575194 1.7575194
[70,] 0.8818120 0.8818120
[71,] 0.8823389 0.8823389
[72,] 3.4063530 1.7598821
[73,] 0.8804176 1.2678652
[74,] 0.8766216 0.8766216
[75,] 1.2675356 1.2675356
[76,] 0.8822617 0.8822617
[77,] 1.2673031 1.2673031
[78,] 0.8778515 0.8778515
[79,] 0.8775373 0.8775373
[80,] 1.2673031 1.2673031
[81,] 5.4653252 5.4653252
[82,] 1.2642343 1.7649956
[83,] 0.8759945 0.8759945
[84,] 0.8732702 0.8732702
[85,] 1.2668084 1.2668084
[86,] 0.8823389 0.8823389
[87,] 1.2664504 1.7570028
[88,] 1.7555689 0.8759328
[89,] 1.7569352 1.7569352
[90,] 0.8810204 0.8810204
[91,] 1.7581423 2.4141324
[92,] 0.8823389 0.8823389
[93,] 0.8784254 0.8784254
[94,] 1.2639445 0.8621883
[95,] 5.4491512 5.4491512
[96,] 0.8683791 1.2652312</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ll_matrix_mv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2267.284</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>all_choice_full <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(final_data)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model to full dataset</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>result_full <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co"># log(ce), logit(n)</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> objective_function,</span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">all_choice =</span> all_choice_full</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fitted parameters</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>ce_mv <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>n_mv <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fitted parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitted parameters:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(ce_mv,n_mv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.955763e+00 1.492502e+07</code></pre>
</div>
</div>
</section>
<section id="diversity-heuristic" class="level2">
<h2 class="anchored" data-anchor-id="diversity-heuristic">Diversity Heuristic</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the Softmax Function</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>sf <span class="ot">&lt;-</span> <span class="cf">function</span>(ll_values, tau) {</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prevent overflow by subtracting the max before exponentiation</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>  ll_values <span class="ot">&lt;-</span> ll_values <span class="sc">-</span> <span class="fu">max</span>(ll_values)</span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>  exp_neg_tau_ll <span class="ot">&lt;-</span> <span class="fu">exp</span>(ll_values <span class="sc">*</span> tau)</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>  probabilities <span class="ot">&lt;-</span> exp_neg_tau_ll <span class="sc">/</span> <span class="fu">sum</span>(exp_neg_tau_ll)</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(probabilities)</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="co">#define alpha and beta</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>integral_function3<span class="ot">&lt;-</span><span class="cf">function</span>(ce,n,e,i){</span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>  w_list2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e), <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e),<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>  w_list1 <span class="ot">&lt;-</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e), <span class="fl">0.5</span>,<span class="fl">0.5</span>, (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),(<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n<span class="sc">*</span>e),<span class="fl">0.5</span>,<span class="fl">0.5</span>,(<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n),(<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>  w1<span class="ot">&lt;-</span>w_list1[i]</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>  w2<span class="ot">&lt;-</span>w_list2[i]</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>  alpha<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>w2<span class="sc">*</span>ce</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>  beta<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>w1<span class="sc">*</span>ce</span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>  ll1<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>  ll2<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>  ll3<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>  ll4<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>  ll5<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>  ll6<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a list</span></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>  ll_values <span class="ot">&lt;-</span> <span class="fu">c</span>(ll1,ll2,ll3,ll4,ll5,ll6)</span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_values)</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create all_choice data for a given dataset</span></span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>create_all_choice <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a>  conditions <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a>  all_data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) {</span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by_at</span>(<span class="fu">vars</span>(conditions[i])) <span class="sc">%&gt;%</span></span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">d =</span> conditions[i]) <span class="sc">%&gt;%</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">condition =</span> i)</span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Reduce</span>(<span class="cf">function</span>(x, y) <span class="fu">full_join</span>(x, y, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"d"</span>, <span class="st">"condition"</span>, <span class="st">"count"</span>)), all_data) <span class="sc">%&gt;%</span></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">as.numeric</span>(d))</span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-46"><a href="#cb149-46" aria-hidden="true" tabindex="-1"></a>logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb149-47"><a href="#cb149-47" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb149-48"><a href="#cb149-48" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-49"><a href="#cb149-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-50"><a href="#cb149-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-51"><a href="#cb149-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified objective function to take all_choice as input</span></span>
<span id="cb149-52"><a href="#cb149-52" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(par, all_choice) {</span>
<span id="cb149-53"><a href="#cb149-53" aria-hidden="true" tabindex="-1"></a>  ce <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">1</span>])</span>
<span id="cb149-54"><a href="#cb149-54" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">2</span>])</span>
<span id="cb149-55"><a href="#cb149-55" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">3</span>])</span>
<span id="cb149-56"><a href="#cb149-56" aria-hidden="true" tabindex="-1"></a>  ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb149-57"><a href="#cb149-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-58"><a href="#cb149-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_choice)) {</span>
<span id="cb149-59"><a href="#cb149-59" aria-hidden="true" tabindex="-1"></a>    likert <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>d[m]</span>
<span id="cb149-60"><a href="#cb149-60" aria-hidden="true" tabindex="-1"></a>    condition <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>condition[m]</span>
<span id="cb149-61"><a href="#cb149-61" aria-hidden="true" tabindex="-1"></a>    count <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>count[m]</span>
<span id="cb149-62"><a href="#cb149-62" aria-hidden="true" tabindex="-1"></a>    sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function3</span>(ce,n,e,condition)</span>
<span id="cb149-63"><a href="#cb149-63" aria-hidden="true" tabindex="-1"></a>    ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb149-64"><a href="#cb149-64" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb149-65"><a href="#cb149-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb149-66"><a href="#cb149-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_log_sum)</span>
<span id="cb149-67"><a href="#cb149-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb149-68"><a href="#cb149-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-69"><a href="#cb149-69" aria-hidden="true" tabindex="-1"></a><span class="co"># LOO-CV setup</span></span>
<span id="cb149-70"><a href="#cb149-70" aria-hidden="true" tabindex="-1"></a>n_subjects <span class="ot">&lt;-</span> <span class="fu">nrow</span>(final_data)</span>
<span id="cb149-71"><a href="#cb149-71" aria-hidden="true" tabindex="-1"></a>ll_matrix_dh <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_subjects, <span class="at">ncol =</span> <span class="dv">16</span>)</span>
<span id="cb149-72"><a href="#cb149-72" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ll_matrix_dh) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ll_dh_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb149-73"><a href="#cb149-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-74"><a href="#cb149-74" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_subjects) {</span>
<span id="cb149-75"><a href="#cb149-75" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split data into train and test</span></span>
<span id="cb149-76"><a href="#cb149-76" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> final_data[<span class="sc">-</span>i,]</span>
<span id="cb149-77"><a href="#cb149-77" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> final_data[i,]</span>
<span id="cb149-78"><a href="#cb149-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-79"><a href="#cb149-79" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare training data</span></span>
<span id="cb149-80"><a href="#cb149-80" aria-hidden="true" tabindex="-1"></a>  all_choice_train <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(train_data)</span>
<span id="cb149-81"><a href="#cb149-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-82"><a href="#cb149-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit model on training data</span></span>
<span id="cb149-83"><a href="#cb149-83" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb149-84"><a href="#cb149-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb149-85"><a href="#cb149-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> objective_function,</span>
<span id="cb149-86"><a href="#cb149-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_choice =</span> all_choice_train</span>
<span id="cb149-87"><a href="#cb149-87" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb149-88"><a href="#cb149-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-89"><a href="#cb149-89" aria-hidden="true" tabindex="-1"></a>  ce_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb149-90"><a href="#cb149-90" aria-hidden="true" tabindex="-1"></a>  n_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb149-91"><a href="#cb149-91" aria-hidden="true" tabindex="-1"></a>  e_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">3</span>])</span>
<span id="cb149-92"><a href="#cb149-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-93"><a href="#cb149-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute likelihood on left-out subject</span></span>
<span id="cb149-94"><a href="#cb149-94" aria-hidden="true" tabindex="-1"></a>  all_choice_test <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(test_data)</span>
<span id="cb149-95"><a href="#cb149-95" aria-hidden="true" tabindex="-1"></a>  final_data<span class="sc">$</span>ll_dh[i] <span class="ot">&lt;-</span> <span class="fu">objective_function</span>(result<span class="sc">$</span>par,all_choice_test)</span>
<span id="cb149-96"><a href="#cb149-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb149-97"><a href="#cb149-97" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb149-98"><a href="#cb149-98" aria-hidden="true" tabindex="-1"></a>    cond_rows <span class="ot">&lt;-</span> all_choice_test[all_choice_test<span class="sc">$</span>condition <span class="sc">==</span> cond, ]</span>
<span id="cb149-99"><a href="#cb149-99" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb149-100"><a href="#cb149-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(cond_rows) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb149-101"><a href="#cb149-101" aria-hidden="true" tabindex="-1"></a>      sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function3</span>(ce_train, n_train,e_train,cond)</span>
<span id="cb149-102"><a href="#cb149-102" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cond_rows)) {</span>
<span id="cb149-103"><a href="#cb149-103" aria-hidden="true" tabindex="-1"></a>        likert <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>d[m]</span>
<span id="cb149-104"><a href="#cb149-104" aria-hidden="true" tabindex="-1"></a>        count <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>count[m]</span>
<span id="cb149-105"><a href="#cb149-105" aria-hidden="true" tabindex="-1"></a>        ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb149-106"><a href="#cb149-106" aria-hidden="true" tabindex="-1"></a>        ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb149-107"><a href="#cb149-107" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb149-108"><a href="#cb149-108" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb149-109"><a href="#cb149-109" aria-hidden="true" tabindex="-1"></a>    ll_matrix_dh[i, cond] <span class="ot">&lt;-</span> ll_log_sum</span>
<span id="cb149-110"><a href="#cb149-110" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb149-111"><a href="#cb149-111" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `ll_dh`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ll_matrix_dh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        ll_dh_1   ll_dh_2  ll_dh_3  ll_dh_4   ll_dh_5   ll_dh_6   ll_dh_7
 [1,] 0.8685955 3.4127706 2.596351 2.596351 1.2652798 1.7611260 1.2652798
 [2,] 1.2663301 1.7574175 1.686222 1.686222 1.7574150 1.7574150 1.7574150
 [3,] 1.7591855 2.4169486 1.427290 1.686263 0.8711336 1.2658235 5.3275166
 [4,] 0.8698003 2.4196884 1.686288 1.686288 0.8698003 3.4080071 0.8698003
 [5,] 0.8775510 1.2672355 1.686158 1.686158 0.8775508 1.2672356 3.3776504
 [6,] 0.8810675 0.8810675 2.577660 1.686110 0.8810676 0.8810676 0.8810676
 [7,] 0.8819999 0.8819999 1.432537 1.432537 0.8820000 0.8820000 0.8820000
 [8,] 1.2667425 1.2667425 1.429323 1.429323 1.2667425 1.2667425 5.2978925
 [9,] 1.2659320 1.2659320 1.686254 1.686254 1.7588039 1.7588039 1.7588039
[10,] 1.2667837 3.3855381 1.429414 1.686189 0.8755265 0.8755265 1.2667834
[11,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[12,] 1.2678203 1.2678203 1.686122 1.686122 1.2678203 0.8801388 0.8801388
[13,] 0.8702998 0.8702998 1.686279 1.426886 0.8702997 0.8702997 0.8702997
[14,] 0.8820136 0.8820136 1.686098 1.686098 0.8820136 0.8820136 0.8820136
[15,] 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602 1.2672602
[16,] 0.8820136 0.8820136 1.686098 1.686098 0.8820136 0.8820136 0.8820136
[17,] 0.8732534 0.8732534 1.428316 1.428316 1.7575796 1.7575796 1.7575796
[18,] 1.2656693 1.2656693 1.686277 1.686277 3.4055707 0.8704179 1.2656693
[19,] 0.8765971 0.8765971 1.429931 1.686172 1.7550737 3.3813607 1.7550737
[20,] 0.8771769 0.8771769 1.430211 1.430211 0.8771768 0.8771768 1.2671517
[21,] 0.8720503 1.2660219 1.686247 1.686247 0.8720503 0.8720503 1.2660219
[22,] 0.8714573 0.8714573 2.592030 2.592030 1.2658934 1.2658934 1.2658934
[23,] 2.4549789 5.4577163 1.418480 1.686690 1.7734663 5.4577163 5.4577163
[24,] 0.8685654 3.4128883 2.596396 2.596396 1.2652737 1.2652737 1.7611489
[25,] 1.2665133 1.2665133 1.686208 1.428821 1.7567923 0.8742993 2.4104794
[26,] 0.8784207 0.8784207 2.581597 2.581597 0.8784207 0.8784207 0.8784207
[27,] 0.8624899 0.8624899 2.605632 2.605632 0.8624899 5.3891024 5.3891024
[28,] 0.8656761 2.4282215 1.424645 1.424645 1.7633808 1.2646651 2.4282208
[29,] 1.2676333 1.2676333 1.431243 1.431243 1.2676333 1.2676333 1.2676333
[30,] 1.2674255 0.8783957 1.430800 1.430800 1.2674254 1.2674254 1.2674254
[31,] 1.2671628 1.2671628 1.686163 1.430235 1.2671629 1.2671629 1.2671629
[32,] 0.8802061 0.8802061 1.686121 1.686121 0.8802062 0.8802062 0.8802062
[33,] 0.8809555 0.8809555 1.686112 1.686112 0.8809556 0.8809556 0.8809556
[34,] 1.2677135 0.8796690 1.431414 1.431414 0.8796689 0.8796689 1.2677136
[35,] 1.2671628 1.2671628 1.430235 1.686163 1.2671629 1.2671629 1.2671629
[36,] 0.8791995 1.2676071 1.686135 1.431187 1.2676071 0.8791995 0.8791995
[37,] 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602 1.2672602
[38,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[39,] 0.8766715 0.8766715 2.584208 2.584208 0.8766711 0.8766711 0.8766711
[40,] 1.2669252 1.2669252 1.429722 1.429722 1.2669249 1.7553937 1.2669249
[41,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[42,] 1.2678338 0.8801983 1.431669 1.431669 0.8801984 0.8801984 1.2678338
[43,] 0.8802061 0.8802061 1.686121 1.686121 0.8802062 0.8802062 0.8802062
[44,] 0.8789054 0.8789054 1.686139 1.431046 1.2675406 1.2675406 1.2675406
[45,] 0.8802555 1.2678469 1.431696 1.686121 0.8802556 1.2678469 1.7523691
[46,] 1.2659843 1.2659843 1.686250 1.686250 1.7586200 1.7586200 1.7586200
[47,] 0.8816748 0.8816748 1.686103 1.432380 0.8816748 0.8816748 0.8816748
[48,] 2.4390812 3.4451243 2.608695 1.422124 1.7674536 1.2636018 2.4390812
[49,] 0.8796154 0.8796154 1.431388 1.686129 1.2677013 1.2677013 1.2677013
[50,] 1.7565782 1.7565782 1.428959 1.428959 1.7565779 1.2665760 1.7565779
[51,] 1.2679580 0.8807428 1.431931 1.431931 0.8807430 0.8807430 1.2679580
[52,] 2.4132753 1.7578252 1.428158 1.428158 1.7578252 1.2662128 0.8729281
[53,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[54,] 0.8748818 1.2666417 1.686199 1.429103 1.2666417 1.7563551 0.8748818
[55,] 0.8811731 0.8811731 1.686109 1.686109 0.8811734 0.8811734 0.8811734
[56,] 2.4189992 1.7599464 1.426807 1.426807 1.7599464 1.7599464 1.7599464
[57,] 0.8820136 0.8820136 1.686098 1.686098 0.8820136 0.8820136 0.8820136
[58,] 1.2671348 1.2671348 1.430175 1.686165 1.2671348 1.2671348 1.2671348
[59,] 0.8771690 1.2671499 1.686164 2.583464 1.2671500 0.8771687 1.2671500
[60,] 0.8721846 1.2660490 1.427797 1.427797 1.2660491 1.2660491 1.2660491
[61,] 2.4147951 1.7583864 1.427798 1.686244 1.7583868 3.3986209 1.7583868
[62,] 0.8819999 1.2682461 1.432537 1.432537 0.8820000 0.8820000 0.8820000
[63,] 0.8816748 0.8816748 1.686103 1.432380 0.8816748 0.8816748 0.8816748
[64,] 0.8766587 1.2670353 1.686171 1.686171 0.8766582 5.2886352 1.2670354
[65,] 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602 1.2672602
[66,] 0.8807743 1.2679653 1.431947 1.431947 1.2679652 0.8807744 0.8807744
[67,] 0.8674001 5.3540043 2.598160 2.598160 1.2650271 1.2650271 1.2650271
[68,] 0.8733196 2.4124760 1.686225 2.589229 1.2662984 1.2662984 1.7575298
[69,] 1.2662682 1.7576342 1.428281 1.428281 1.7576342 1.7576342 1.7576342
[70,] 0.8820136 0.8820136 1.686098 1.432544 0.8820136 0.8820136 0.8820136
[71,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[72,] 0.8701659 0.8701659 2.593977 2.593977 1.7599230 1.2656153 1.7599230
[73,] 0.8814032 0.8814032 1.432249 1.432249 1.2681089 1.2681089 0.8814034
[74,] 0.8767598 0.8767598 2.584075 1.686170 0.8767597 0.8767597 0.8767597
[75,] 0.8789253 0.8789253 1.431055 1.431055 1.2675451 1.2675451 1.2675451
[76,] 0.8820726 0.8820726 1.432572 1.432572 0.8820727 0.8820727 0.8820727
[77,] 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602 1.2672602
[78,] 1.7543453 1.2672413 1.430404 1.430404 0.8775768 1.7543455 0.8775768
[79,] 0.8777029 1.2672697 1.686156 2.582667 0.8777029 0.8777029 0.8777029
[80,] 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602 1.2672602
[81,] 2.4573911 1.7743839 2.621960 1.686723 2.4573908 1.7743837 1.2619197
[82,] 1.7649173 5.3803771 2.603775 2.603775 1.7649173 1.7649173 1.7649173
[83,] 0.8757228 0.8757228 2.585626 2.585626 0.8757231 5.2951888 0.8757231
[84,] 0.8733635 0.8733635 2.589163 2.589163 0.8733640 1.2663078 1.7574962
[85,] 1.2668244 1.2668244 1.429502 1.429502 1.2668244 1.2668244 1.2668244
[86,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[87,] 1.2665060 2.4105437 1.428806 1.686209 1.2665056 1.2665056 0.8742697
[88,] 1.2669261 0.8761653 1.429723 1.429723 1.7553954 3.3830418 1.7553954
[89,] 1.2665626 1.2665626 1.428930 1.428930 1.2665625 1.2665625 1.7566240
[90,] 1.2679653 1.2679653 1.431947 1.431947 0.8807744 0.8807744 0.8807744
[91,] 1.2661163 1.2661163 2.590483 1.686239 1.2661163 1.2661163 1.7581599
[92,] 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964 0.8824964
[93,] 0.8784169 5.2763293 1.430810 1.430810 0.8784169 0.8784169 0.8784169
[94,] 3.4380074 5.3907588 2.605984 1.686448 5.3907589 1.7660538 2.4353567
[95,] 0.8543889 0.8543889 1.419153 2.618083 1.7723444 3.4698141 5.4476638
[96,] 3.4128772 0.8685683 2.596392 2.596392 1.2652742 3.4128774 0.8685682
        ll_dh_8   ll_dh_9  ll_dh_10 ll_dh_11 ll_dh_12  ll_dh_13  ll_dh_14
 [1,] 1.2652798 0.8685955 5.3455084 2.596351 2.596351 1.2652798 1.2652798
 [2,] 0.8734712 1.7574175 1.2663301 1.428419 2.589008 1.7574150 1.7574150
 [3,] 2.4169486 0.8711336 0.8711336 1.686263 1.686263 1.7591855 1.2658235
 [4,] 3.4080071 0.8698003 2.4196884 2.594529 1.686288 0.8698003 2.4196884
 [5,] 0.8775508 1.2672355 0.8775510 1.686158 1.686158 0.8775508 0.8775508
 [6,] 0.8810676 0.8810675 0.8810675 1.432088 1.432088 0.8810676 0.8810676
 [7,] 0.8820000 1.2682461 0.8819999 1.432537 1.432537 0.8820000 0.8820000
 [8,] 1.2667425 1.2667425 1.2667425 1.429323 1.429323 0.8753376 1.2667425
 [9,] 1.7588039 1.2659320 1.2659320 1.686254 1.686254 1.7588039 2.4159191
[10,] 1.2667834 1.7558731 1.2667837 1.686189 1.429414 1.2667834 1.2667834
[11,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[12,] 0.8801388 0.8801387 0.8801387 1.686122 1.686122 0.8801388 0.8801388
[13,] 0.8702997 2.4186609 3.4060362 1.686279 1.426886 1.2656440 3.4060363
[14,] 0.8820136 0.8820136 0.8820136 1.432544 1.432544 0.8820136 0.8820136
[15,] 1.2672602 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602
[16,] 0.8820136 0.8820136 0.8820136 1.432544 1.432544 0.8820136 0.8820136
[17,] 1.7575796 0.8732534 0.8732534 1.428316 1.428316 1.2662840 3.3944225
[18,] 1.2656693 0.8704179 3.4055707 1.686277 1.686277 1.2656693 3.4055707
[19,] 0.8765969 0.8765971 0.8765971 1.686172 1.686172 1.2670222 1.2670222
[20,] 0.8771768 5.2849997 0.8771769 1.686163 1.430211 1.2671517 0.8771768
[21,] 0.8720503 5.3210380 0.8720503 1.427734 2.591137 3.3991448 1.7584894
[22,] 1.2658934 0.8714573 5.3252272 2.592030 2.592030 1.2658934 1.2658934
[23,] 2.4549789 2.4549789 5.4577163 1.418480 1.418480 3.4754408 5.4577163
[24,] 1.7611489 0.8685654 3.4128883 2.596396 2.596396 1.2652737 1.2652737
[25,] 3.3903274 1.2665133 2.4104794 1.686208 1.686208 0.8742993 0.8742993
[26,] 0.8784207 0.8784207 0.8784207 2.581597 2.581597 0.8784207 0.8784207
[27,] 0.8624899 5.3891024 0.8624899 2.605632 2.605632 0.8624899 5.3891024
[28,] 5.3662959 3.4243584 1.2646652 1.686372 1.424645 2.4282208 2.4282208
[29,] 1.2676333 1.2676333 0.8793153 1.431243 1.431243 0.8793152 0.8793152
[30,] 1.2674254 0.8783957 0.8783957 2.581634 1.430800 1.2674254 1.2674254
[31,] 1.2671629 1.2671628 1.2671628 1.430235 1.686163 1.2671629 1.2671629
[32,] 0.8802062 0.8802061 0.8802061 1.686121 2.578940 0.8802062 0.8802062
[33,] 0.8809556 0.8809555 1.2680067 1.686112 1.686112 0.8809556 0.8809556
[34,] 1.2677136 1.2677135 0.8796690 1.431414 1.431414 1.7528002 0.8796689
[35,] 1.2671629 1.2671628 1.2671628 1.430235 1.686163 1.2671629 1.2671629
[36,] 1.2676071 1.2676071 1.2676071 1.686135 1.431187 1.2676071 1.2676071
[37,] 1.2672602 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602
[38,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[39,] 1.7550185 0.8766715 0.8766715 2.584208 2.584208 0.8766711 0.8766711
[40,] 1.2669249 1.2669252 1.7553949 1.429722 1.429722 1.2669249 1.2669249
[41,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[42,] 1.2678338 1.2678338 0.8801983 1.686121 1.686121 1.2678338 0.8801984
[43,] 0.8802062 0.8802061 1.2678356 2.578940 1.686121 0.8802062 0.8802062
[44,] 1.2675406 0.8789054 0.8789054 1.431046 1.686139 1.2675406 1.2675406
[45,] 0.8802556 0.8802555 1.2678469 1.431696 1.431696 0.8802556 0.8802556
[46,] 2.4154230 1.2659843 1.2659843 1.686250 1.686250 1.7586200 1.7586200
[47,] 0.8816748 0.8816748 0.8816748 1.686103 1.686103 0.8816748 0.8816748
[48,] 3.4451243 3.4451243 3.4451243 1.686491 1.686491 1.7674536 3.4451243
[49,] 0.8796153 0.8796154 0.8796154 1.431388 1.431388 1.2677013 1.2677013
[50,] 1.2665760 1.2665761 1.2665761 1.686204 1.428959 1.7565779 1.2665760
[51,] 0.8807430 0.8807428 0.8807428 1.431931 2.578142 0.8807430 0.8807430
[52,] 1.7578252 1.2662128 3.3956989 1.428158 1.686231 1.2662128 1.2662128
[53,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[54,] 1.2666417 1.7563551 1.7563551 1.429103 1.429103 1.7563551 1.7563551
[55,] 0.8811734 0.8811731 0.8811731 1.686109 1.686109 0.8811734 0.8811734
[56,] 1.7599464 3.4066851 1.2656087 1.426807 1.426807 1.7599464 1.7599464
[57,] 0.8820136 0.8820136 0.8820136 1.432544 1.432544 0.8820136 0.8820136
[58,] 1.2671348 1.2671348 1.2671348 1.686165 2.583566 0.8771008 1.2671348
[59,] 0.8771687 1.2671499 1.2671499 1.686164 1.686164 1.2671500 1.2671500
[60,] 1.7583877 2.4147982 1.7583873 1.686245 1.427797 3.3986271 1.7583877
[61,] 1.7583868 0.8721859 0.8721859 1.427798 1.427798 0.8721853 3.3986209
[62,] 0.8820000 0.8819999 0.8819999 1.432537 1.432537 0.8820000 0.8820000
[63,] 0.8816748 0.8816748 0.8816748 1.686103 1.686103 0.8816748 0.8816748
[64,] 0.8766582 0.8766587 0.8766587 1.686171 1.429961 1.2670354 0.8766582
[65,] 1.2672602 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602
[66,] 0.8807744 1.2679653 0.8807743 1.431947 1.431947 1.2679652 0.8807744
[67,] 1.2650271 0.8674001 5.3540043 2.598160 2.598160 1.2650271 1.2650271
[68,] 1.7575298 0.8733196 1.2662984 2.589229 1.428348 1.2662984 1.2662984
[69,] 1.7576342 1.2662682 1.2662682 1.686227 1.428281 1.7576342 1.7576342
[70,] 0.8820136 0.8820136 0.8820136 1.686098 1.432544 0.8820136 0.8820136
[71,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[72,] 2.4189361 1.2656153 0.8701659 1.686281 2.593977 1.7599230 1.7599230
[73,] 0.8814034 0.8814032 0.8814032 1.432249 1.432249 0.8814034 0.8814034
[74,] 0.8767597 5.2879199 0.8767598 1.686170 1.686170 0.8767597 0.8767597
[75,] 1.2675451 1.2675451 0.8789253 1.431055 1.431055 1.2675451 1.2675451
[76,] 0.8820727 0.8820726 0.8820726 1.686098 1.432572 0.8820727 0.8820727
[77,] 1.2672602 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602
[78,] 2.4038350 1.2672413 1.2672413 1.430404 1.686158 0.8775768 0.8775768
[79,] 1.2672697 0.8777029 1.2672697 2.582667 2.582667 1.2672697 0.8777029
[80,] 1.2672602 1.2672601 1.2672601 1.430445 1.430445 1.2672602 1.2672602
[81,] 1.2619197 5.4659162 3.4800324 2.621960 1.686723 5.4659156 5.4659156
[82,] 1.7649173 0.8637067 5.3803771 2.603775 2.603775 1.2642576 1.7649173
[83,] 0.8757231 0.8757228 0.8757228 1.429509 1.686186 0.8757231 1.2668276
[84,] 0.8733640 0.8733635 5.3117774 2.589163 2.589163 0.8733640 0.8733640
[85,] 1.2668244 3.3848282 1.2668244 1.429502 1.429502 1.2668244 1.2668244
[86,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[87,] 1.7568143 2.4105437 0.8742679 1.428806 1.428806 1.7568143 1.7568143
[88,] 1.7553954 0.8761653 0.8761653 1.429723 1.429723 0.8761653 0.8761653
[89,] 1.7566240 1.2665626 1.7566242 1.428930 1.428930 1.7566240 1.7566240
[90,] 0.8807744 1.2679653 1.2679653 1.431947 1.431947 0.8807744 0.8807744
[91,] 2.4141800 0.8724855 1.2661163 2.590483 1.686239 1.7581599 0.8724854
[92,] 0.8824964 0.8824963 0.8824963 1.432776 1.432776 0.8824964 0.8824964
[93,] 0.8784169 0.8784169 0.8784169 1.430810 1.430810 0.8784169 0.8784169
[94,] 1.2639610 0.8622592 5.3907588 1.422985 2.605984 0.8622592 1.2639610
[95,] 5.4476638 0.8543889 5.4476638 1.419153 2.618083 1.2623986 3.4698141
[96,] 1.2652742 3.4128772 2.4222283 1.686312 1.686312 0.8685682 2.4222285
       ll_dh_15  ll_dh_16
 [1,] 1.2652798 1.2652798
 [2,] 1.2663294 0.8734712
 [3,] 1.2658235 1.7591855
 [4,] 0.8698003 2.4196884
 [5,] 0.8775508 1.2672356
 [6,] 0.8810676 0.8810676
 [7,] 0.8820000 0.8820000
 [8,] 0.8753376 0.8753376
 [9,] 2.4159191 1.7588039
[10,] 1.2667834 1.2667834
[11,] 0.8824964 0.8824964
[12,] 0.8801388 0.8801388
[13,] 5.3334175 1.7598208
[14,] 0.8820136 0.8820136
[15,] 1.2672602 1.2672602
[16,] 0.8820136 0.8820136
[17,] 1.2662840 3.3944225
[18,] 1.7597307 1.7597307
[19,] 0.8765969 0.8765969
[20,] 0.8771768 1.2671517
[21,] 1.2660219 1.2660219
[22,] 1.2658934 1.2658934
[23,] 1.7734663 1.2621335
[24,] 1.7611489 1.7611489
[25,] 0.8742993 0.8742993
[26,] 0.8784207 0.8784207
[27,] 0.8624899 0.8624899
[28,] 2.4282208 1.7633808
[29,] 0.8793152 1.2676333
[30,] 1.2674254 0.8783958
[31,] 1.2671629 1.2671629
[32,] 0.8802062 1.2678356
[33,] 0.8809556 0.8809556
[34,] 0.8796689 1.2677136
[35,] 1.2671629 1.2671629
[36,] 0.8791995 0.8791995
[37,] 1.2672602 1.2672602
[38,] 0.8824964 0.8824964
[39,] 0.8766711 1.7550185
[40,] 1.7553937 1.2669249
[41,] 0.8824964 0.8824964
[42,] 0.8801984 0.8801984
[43,] 0.8802062 0.8802062
[44,] 1.2675406 1.2675406
[45,] 0.8802556 0.8802556
[46,] 1.2659843 2.4154230
[47,] 0.8816748 0.8816748
[48,] 2.4390812 2.4390812
[49,] 1.2677013 1.2677013
[50,] 1.7565779 1.2665760
[51,] 0.8807430 0.8807430
[52,] 1.2662128 1.7578252
[53,] 0.8824964 0.8824964
[54,] 1.7563551 1.7563551
[55,] 0.8811734 0.8811734
[56,] 1.7599464 1.7599464
[57,] 0.8820136 0.8820136
[58,] 1.2671348 0.8771008
[59,] 1.2671500 1.2671500
[60,] 1.7583877 1.7583877
[61,] 0.8721853 1.2660497
[62,] 0.8820000 0.8820000
[63,] 0.8816748 0.8816748
[64,] 0.8766582 0.8766582
[65,] 1.2672602 1.2672602
[66,] 0.8807744 0.8807744
[67,] 1.2650271 1.2650271
[68,] 1.7575298 1.7575298
[69,] 1.7576342 1.7576342
[70,] 0.8820136 0.8820136
[71,] 0.8824964 0.8824964
[72,] 3.4065640 1.7599230
[73,] 0.8814034 1.2681089
[74,] 0.8767597 0.8767597
[75,] 1.2675451 1.2675451
[76,] 0.8820727 0.8820727
[77,] 1.2672602 1.2672602
[78,] 0.8775768 0.8775768
[79,] 0.8777029 0.8777029
[80,] 1.2672602 1.2672602
[81,] 5.4659156 5.4659156
[82,] 1.2642576 1.7649173
[83,] 0.8757231 0.8757231
[84,] 0.8733640 0.8733640
[85,] 1.2668244 1.2668244
[86,] 0.8824964 0.8824964
[87,] 1.2665056 1.7568143
[88,] 1.7553954 0.8761653
[89,] 1.7566240 1.7566240
[90,] 0.8807744 0.8807744
[91,] 1.7581599 2.4141800
[92,] 0.8824964 0.8824964
[93,] 0.8784169 0.8784169
[94,] 1.2639610 0.8622592
[95,] 5.4476638 5.4476638
[96,] 0.8685682 1.2652742</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ll_matrix_dh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2267.286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>all_choice_full <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(final_data)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model to full dataset</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>result_full <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co"># log(ce), logit(n)</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> objective_function,</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">all_choice =</span> all_choice_full</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fitted parameters</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>ce_dh <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>n_dh <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>e_dh <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">3</span>])</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fitted parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitted parameters:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(ce_dh,n_dh,e_dh))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.956055e+00 3.870632e+06 2.463584e+00</code></pre>
</div>
</div>
</section>
<section id="expertise-information" class="level2">
<h2 class="anchored" data-anchor-id="expertise-information">Expertise Information</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate the diagnosity of different feature</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="co">#for foot</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="co">#P(f=1|c1)/P(f=1|c2)</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="co">#for P(f=1|c1)~P(f=1|small)*P(small|c1)+P(f=1|big)*P(big|c1)</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>P_f1c1<span class="ot">=</span><span class="dv">8</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="co">#for P(f=1|c2)~P(f=1|small)*P(small|c2)+P(f=1|big)*P(big|c2)</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>P_f1c2<span class="ot">=</span><span class="dv">7</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a><span class="co">#diagnosticity(f=1)</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>df1<span class="ot">=</span>P_f1c1<span class="sc">/</span>P_f1c2</span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="co">#P(f=2|c2)/P(f=2|c2)</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="co">#for P(f=2|c1)~P(f=2|small)*P(small|c1)+P(f=2|big)*P(big|c1)</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a>P_f2c1<span class="ot">=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="co">#for P(f=2|c2)~P(f=2|small)*P(small|c2)+P(f=2|big)*P(big|c2)</span></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a>P_f2c2<span class="ot">=</span><span class="dv">3</span><span class="sc">/</span><span class="dv">10</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="co">#diagnosticity(f=1)</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a>df2<span class="ot">=</span>P_f2c2<span class="sc">/</span>P_f2c1</span>
<span id="cb159-20"><a href="#cb159-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-21"><a href="#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="co">#average this two condition and get a final diagnosticity for foot expert</span></span>
<span id="cb159-22"><a href="#cb159-22" aria-hidden="true" tabindex="-1"></a>av_df<span class="ot">=</span>(df1<span class="sc">+</span>df2)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb159-23"><a href="#cb159-23" aria-hidden="true" tabindex="-1"></a>av_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.321429</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Similarly, we can calculate the diagnosticity for ear expert</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>av_de <span class="ot">=</span> (<span class="dv">7</span><span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">8</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>eargain<span class="ot">&lt;-</span> av_de</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(av_df,av_de))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.321429 3.083333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>softmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">temp =</span> <span class="dv">1</span>) {</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>  exp_x <span class="ot">&lt;-</span> <span class="fu">exp</span>(x <span class="sc">/</span> temp)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(exp_x <span class="sc">/</span> <span class="fu">sum</span>(exp_x))</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>footgain <span class="ot">&lt;-</span> av_df<span class="sc">/</span>(av_df<span class="sc">+</span>av_de)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>eargain <span class="ot">&lt;-</span> av_de<span class="sc">/</span>(av_df<span class="sc">+</span>av_de)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>softmax <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">temp =</span> <span class="dv">1</span>) {</span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>  exp_x <span class="ot">&lt;-</span> <span class="fu">exp</span>(x <span class="sc">/</span> temp)</span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(exp_x <span class="sc">/</span> <span class="fu">sum</span>(exp_x))</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 假设你已经有了两个专家的信息增益</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>gains <span class="ot">&lt;-</span> <span class="fu">c</span>(eargain, footgain)</span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the Softmax Function</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>sf <span class="ot">&lt;-</span> <span class="cf">function</span>(ll_values, tau) {</span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prevent overflow by subtracting the max before exponentiation</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a>  ll_values <span class="ot">&lt;-</span> ll_values <span class="sc">-</span> <span class="fu">max</span>(ll_values)</span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>  exp_neg_tau_ll <span class="ot">&lt;-</span> <span class="fu">exp</span>(ll_values <span class="sc">*</span> tau)</span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a>  probabilities <span class="ot">&lt;-</span> exp_neg_tau_ll <span class="sc">/</span> <span class="fu">sum</span>(exp_neg_tau_ll)</span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(probabilities)</span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a><span class="co">#define alpha and beta</span></span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a>integral_function4<span class="ot">&lt;-</span><span class="cf">function</span>(ce,n,i){</span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 转换成专家的权重（如用于模型中的 w）</span></span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#expert_weights &lt;- softmax(gains, temp = tau)  # 小 temp 更偏向最有用的专家</span></span>
<span id="cb163-31"><a href="#cb163-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#eargain &lt;- expert_weights[1]</span></span>
<span id="cb163-32"><a href="#cb163-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#footgain &lt;- expert_weights[2]</span></span>
<span id="cb163-33"><a href="#cb163-33" aria-hidden="true" tabindex="-1"></a>  w_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(footgain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n),(<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(footgain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n),(<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n) , (<span class="dv">1</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb163-34"><a href="#cb163-34" aria-hidden="true" tabindex="-1"></a>  w1 <span class="ot">&lt;-</span> w_list[i]</span>
<span id="cb163-35"><a href="#cb163-35" aria-hidden="true" tabindex="-1"></a>  w2 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>w_list[i]</span>
<span id="cb163-36"><a href="#cb163-36" aria-hidden="true" tabindex="-1"></a>  alpha<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>w1<span class="sc">*</span>ce</span>
<span id="cb163-37"><a href="#cb163-37" aria-hidden="true" tabindex="-1"></a>  beta<span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span>w2<span class="sc">*</span>ce</span>
<span id="cb163-38"><a href="#cb163-38" aria-hidden="true" tabindex="-1"></a>  ll1<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb163-39"><a href="#cb163-39" aria-hidden="true" tabindex="-1"></a>  ll2<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb163-40"><a href="#cb163-40" aria-hidden="true" tabindex="-1"></a>  ll3<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">2</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb163-41"><a href="#cb163-41" aria-hidden="true" tabindex="-1"></a>  ll4<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb163-42"><a href="#cb163-42" aria-hidden="true" tabindex="-1"></a>  ll5<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb163-43"><a href="#cb163-43" aria-hidden="true" tabindex="-1"></a>  ll6<span class="ot">&lt;-</span><span class="fu">pbeta</span>(<span class="dv">6</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)<span class="sc">-</span><span class="fu">pbeta</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">6</span>,alpha,beta)</span>
<span id="cb163-44"><a href="#cb163-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#create a list</span></span>
<span id="cb163-45"><a href="#cb163-45" aria-hidden="true" tabindex="-1"></a>  ll_values <span class="ot">&lt;-</span> <span class="fu">c</span>(ll1,ll2,ll3,ll4,ll5,ll6)</span>
<span id="cb163-46"><a href="#cb163-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_values)</span>
<span id="cb163-47"><a href="#cb163-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-48"><a href="#cb163-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-49"><a href="#cb163-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-50"><a href="#cb163-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create all_choice data for a given dataset</span></span>
<span id="cb163-51"><a href="#cb163-51" aria-hidden="true" tabindex="-1"></a>create_all_choice <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb163-52"><a href="#cb163-52" aria-hidden="true" tabindex="-1"></a>  conditions <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"p"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb163-53"><a href="#cb163-53" aria-hidden="true" tabindex="-1"></a>  all_data <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) {</span>
<span id="cb163-54"><a href="#cb163-54" aria-hidden="true" tabindex="-1"></a>    data <span class="sc">%&gt;%</span></span>
<span id="cb163-55"><a href="#cb163-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by_at</span>(<span class="fu">vars</span>(conditions[i])) <span class="sc">%&gt;%</span></span>
<span id="cb163-56"><a href="#cb163-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-57"><a href="#cb163-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename</span>(<span class="at">d =</span> conditions[i]) <span class="sc">%&gt;%</span></span>
<span id="cb163-58"><a href="#cb163-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">condition =</span> i)</span>
<span id="cb163-59"><a href="#cb163-59" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb163-60"><a href="#cb163-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(all_data) <span class="sc">%&gt;%</span></span>
<span id="cb163-61"><a href="#cb163-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">as.numeric</span>(d))</span>
<span id="cb163-62"><a href="#cb163-62" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-63"><a href="#cb163-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-64"><a href="#cb163-64" aria-hidden="true" tabindex="-1"></a>logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb163-65"><a href="#cb163-65" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x))</span>
<span id="cb163-66"><a href="#cb163-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-67"><a href="#cb163-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-68"><a href="#cb163-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-69"><a href="#cb163-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified objective function to take all_choice as input</span></span>
<span id="cb163-70"><a href="#cb163-70" aria-hidden="true" tabindex="-1"></a>objective_function <span class="ot">&lt;-</span> <span class="cf">function</span>(par, all_choice) {</span>
<span id="cb163-71"><a href="#cb163-71" aria-hidden="true" tabindex="-1"></a>  ce <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">1</span>])</span>
<span id="cb163-72"><a href="#cb163-72" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">exp</span>(par[<span class="dv">2</span>])</span>
<span id="cb163-73"><a href="#cb163-73" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tau &lt;- exp(par[3])</span></span>
<span id="cb163-74"><a href="#cb163-74" aria-hidden="true" tabindex="-1"></a>  ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb163-75"><a href="#cb163-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-76"><a href="#cb163-76" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_choice)) {</span>
<span id="cb163-77"><a href="#cb163-77" aria-hidden="true" tabindex="-1"></a>    likert <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>d[m]</span>
<span id="cb163-78"><a href="#cb163-78" aria-hidden="true" tabindex="-1"></a>    condition <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>condition[m]</span>
<span id="cb163-79"><a href="#cb163-79" aria-hidden="true" tabindex="-1"></a>    count <span class="ot">&lt;-</span> all_choice<span class="sc">$</span>count[m]</span>
<span id="cb163-80"><a href="#cb163-80" aria-hidden="true" tabindex="-1"></a>    sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function4</span>(ce,n,condition)</span>
<span id="cb163-81"><a href="#cb163-81" aria-hidden="true" tabindex="-1"></a>    ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb163-82"><a href="#cb163-82" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb163-83"><a href="#cb163-83" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-84"><a href="#cb163-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ll_log_sum)</span>
<span id="cb163-85"><a href="#cb163-85" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb163-86"><a href="#cb163-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-87"><a href="#cb163-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-88"><a href="#cb163-88" aria-hidden="true" tabindex="-1"></a><span class="co"># LOO-CV setup</span></span>
<span id="cb163-89"><a href="#cb163-89" aria-hidden="true" tabindex="-1"></a>n_subjects <span class="ot">&lt;-</span> <span class="fu">nrow</span>(final_data)</span>
<span id="cb163-90"><a href="#cb163-90" aria-hidden="true" tabindex="-1"></a>ll_matrix_ef <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_subjects, <span class="at">ncol =</span> <span class="dv">16</span>)</span>
<span id="cb163-91"><a href="#cb163-91" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ll_matrix_ef) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ll_ef_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb163-92"><a href="#cb163-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-93"><a href="#cb163-93" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_subjects) {</span>
<span id="cb163-94"><a href="#cb163-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Split data into train and test</span></span>
<span id="cb163-95"><a href="#cb163-95" aria-hidden="true" tabindex="-1"></a>  train_data <span class="ot">&lt;-</span> final_data[<span class="sc">-</span>i,]</span>
<span id="cb163-96"><a href="#cb163-96" aria-hidden="true" tabindex="-1"></a>  test_data <span class="ot">&lt;-</span> final_data[i,]</span>
<span id="cb163-97"><a href="#cb163-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-98"><a href="#cb163-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Prepare training data</span></span>
<span id="cb163-99"><a href="#cb163-99" aria-hidden="true" tabindex="-1"></a>  all_choice_train <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(train_data)</span>
<span id="cb163-100"><a href="#cb163-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-101"><a href="#cb163-101" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Fit model on training data</span></span>
<span id="cb163-102"><a href="#cb163-102" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb163-103"><a href="#cb163-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb163-104"><a href="#cb163-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> objective_function,</span>
<span id="cb163-105"><a href="#cb163-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">all_choice =</span> all_choice_train</span>
<span id="cb163-106"><a href="#cb163-106" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb163-107"><a href="#cb163-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-108"><a href="#cb163-108" aria-hidden="true" tabindex="-1"></a>  ce_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb163-109"><a href="#cb163-109" aria-hidden="true" tabindex="-1"></a>  n_train <span class="ot">&lt;-</span> <span class="fu">exp</span>(result<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb163-110"><a href="#cb163-110" aria-hidden="true" tabindex="-1"></a>  <span class="co">#tau_train &lt;- exp(result$par[3])</span></span>
<span id="cb163-111"><a href="#cb163-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-112"><a href="#cb163-112" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute likelihood on left-out subject</span></span>
<span id="cb163-113"><a href="#cb163-113" aria-hidden="true" tabindex="-1"></a>  all_choice_test <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(test_data)</span>
<span id="cb163-114"><a href="#cb163-114" aria-hidden="true" tabindex="-1"></a>  final_data<span class="sc">$</span>ll_ef[i] <span class="ot">&lt;-</span> <span class="fu">objective_function</span>(result<span class="sc">$</span>par,all_choice_test)</span>
<span id="cb163-115"><a href="#cb163-115" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-116"><a href="#cb163-116" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb163-117"><a href="#cb163-117" aria-hidden="true" tabindex="-1"></a>    cond_rows <span class="ot">&lt;-</span> all_choice_test[all_choice_test<span class="sc">$</span>condition <span class="sc">==</span> cond, ]</span>
<span id="cb163-118"><a href="#cb163-118" aria-hidden="true" tabindex="-1"></a>    ll_log_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb163-119"><a href="#cb163-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(cond_rows) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb163-120"><a href="#cb163-120" aria-hidden="true" tabindex="-1"></a>      sf_lllist <span class="ot">&lt;-</span> <span class="fu">integral_function4</span>(ce_train, n_train, cond)</span>
<span id="cb163-121"><a href="#cb163-121" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (m <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cond_rows)) {</span>
<span id="cb163-122"><a href="#cb163-122" aria-hidden="true" tabindex="-1"></a>        likert <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>d[m]</span>
<span id="cb163-123"><a href="#cb163-123" aria-hidden="true" tabindex="-1"></a>        count <span class="ot">&lt;-</span> cond_rows<span class="sc">$</span>count[m]</span>
<span id="cb163-124"><a href="#cb163-124" aria-hidden="true" tabindex="-1"></a>        ll_here <span class="ot">&lt;-</span> sf_lllist[likert]</span>
<span id="cb163-125"><a href="#cb163-125" aria-hidden="true" tabindex="-1"></a>        ll_log_sum <span class="ot">&lt;-</span> ll_log_sum <span class="sc">-</span> count <span class="sc">*</span> <span class="fu">log</span>(ll_here)</span>
<span id="cb163-126"><a href="#cb163-126" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb163-127"><a href="#cb163-127" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb163-128"><a href="#cb163-128" aria-hidden="true" tabindex="-1"></a>    ll_matrix_ef[i, cond] <span class="ot">&lt;-</span> ll_log_sum</span>
<span id="cb163-129"><a href="#cb163-129" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb163-130"><a href="#cb163-130" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Unknown or uninitialised column: `ll_ef`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ll_matrix_ef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        ll_ef_1   ll_ef_2  ll_ef_3  ll_ef_4   ll_ef_5   ll_ef_6   ll_ef_7
 [1,] 0.8956961 3.3084726 3.462497 1.794316 1.2715063 1.7413822 1.2715006
 [2,] 1.2730466 1.7372301 1.373049 2.177678 1.7372303 1.7372303 1.7372295
 [3,] 1.7388914 2.3610894 1.657112 1.371719 0.8993263 1.2724221 5.1328631
 [4,] 0.8975434 2.3645330 2.182127 1.370741 0.8975314 3.3016180 0.8975715
 [5,] 0.9051043 1.2739005 1.374841 1.374841 0.9051043 1.2739006 3.2735176
 [6,] 0.9069266 0.9069266 3.427309 2.172367 0.9069266 0.9069266 0.9069266
 [7,] 0.9089118 0.9089118 1.412763 1.412763 0.9089076 0.9089076 0.9089216
 [8,] 1.2732584 1.2732584 1.409826 1.657036 1.2732584 1.2732584 5.1107765
 [9,] 1.2724580 1.2724580 1.371800 1.371800 1.7387890 1.7387890 1.7387812
[10,] 1.2735046 3.2791629 1.410275 1.374013 0.9035705 0.9035705 1.2735046
[11,] 0.9091609 0.9091609 1.656903 1.656903 0.9091609 0.9091609 0.9091609
[12,] 1.2742169 1.2742169 2.172989 2.172989 1.2742169 0.9063213 0.9063213
[13,] 0.8979798 0.8979798 1.370992 1.657147 0.8979797 0.8979797 0.8979799
[14,] 0.9083881 0.9083881 1.376612 2.170868 0.9083881 0.9083881 0.9083882
[15,] 1.2738023 1.2738023 1.656990 1.410814 1.2738023 1.2738023 1.2738023
[16,] 0.9087326 0.9087326 2.170517 1.376796 0.9087319 0.9087319 0.9087343
[17,] 0.9004194 0.9004194 1.408801 1.657087 1.7381516 1.7381516 1.7381516
[18,] 1.2722377 1.2722377 1.371320 1.371320 3.2976280 0.8985865 1.2722377
[19,] 0.9039506 0.9039506 1.657006 2.175433 1.7357792 3.2777622 1.7357792
[20,] 0.9045169 0.9045169 1.656993 1.410714 0.9045154 0.9045154 1.2737453
[21,] 0.8991715 1.2723848 2.180399 2.180399 0.8991715 0.8991715 1.2723848
[22,] 0.8986127 0.8986127 3.453255 1.793777 1.2722443 1.2722443 1.2722443
[23,] 2.3960143 5.2550667 1.657670 1.362032 1.7514806 5.2550668 5.2550665
[24,] 0.8960907 3.3069451 3.461191 1.794226 1.2716148 1.2716148 1.7411070
[25,] 1.2727845 1.2727845 2.178741 1.657077 1.7379186 0.9007632 2.3583403
[26,] 0.9053855 0.9053855 3.432094 1.792591 0.9053855 0.9053855 0.9053855
[27,] 0.8899985 0.8899985 3.480485 1.795325 0.8899985 5.1962341 5.1962339
[28,] 0.8927170 2.3738358 1.657292 1.405194 1.7434470 1.2707850 2.3738348
[29,] 1.2743136 1.2743136 1.411734 1.411734 1.2743136 1.2743136 1.2743136
[30,] 1.2741152 0.9059327 1.411378 1.656965 1.2741152 1.2741152 1.2741150
[31,] 1.2734035 1.2734035 2.176233 1.657023 1.2734035 1.2734035 1.2734035
[32,] 0.9061255 0.9061255 2.173190 1.375392 0.9061254 0.9061254 0.9061257
[33,] 0.9077311 0.9077311 2.171541 2.171541 0.9077311 0.9077311 0.9077311
[34,] 1.2743801 0.9069466 1.411853 1.411853 0.9069466 0.9069466 1.2743801
[35,] 1.2739030 1.2739030 1.656981 1.374846 1.2739030 1.2739030 1.2739030
[36,] 0.9058876 1.2740808 2.173463 1.411333 1.2740838 0.9058736 0.9059202
[37,] 1.2738023 1.2738023 1.656990 1.410814 1.2738023 1.2738023 1.2738023
[38,] 0.9091609 0.9091609 1.656903 1.412887 0.9091609 0.9091609 0.9091609
[39,] 0.9049921 0.9049921 3.433324 1.792662 0.9049912 0.9049912 0.9049942
[40,] 1.2734722 1.2734722 1.657017 1.410216 1.2734723 1.7361154 1.2734720
[41,] 0.9096288 0.9096288 1.413106 1.413106 0.9096287 0.9096287 0.9096289
[42,] 1.2745953 0.9077684 1.656929 1.412237 0.9077684 0.9077684 1.2745953
[43,] 0.9080915 0.9080915 2.171172 1.376452 0.9080915 0.9080915 0.9080915
[44,] 0.9050073 0.9050073 2.174342 1.656984 1.2738754 1.2738754 1.2738754
[45,] 0.9062640 1.2742019 1.656958 2.173048 0.9062640 1.2742019 1.7342434
[46,] 1.2727987 1.2727987 1.372522 1.372522 1.7378885 1.7378885 1.7378884
[47,] 0.9077046 0.9077046 1.376243 1.656930 0.9077045 0.9077045 0.9077050
[48,] 2.3824364 3.3362658 3.485841 1.657429 1.7465462 1.2697253 2.3824363
[49,] 0.9059078 0.9059078 1.411367 2.173414 1.2741091 1.2741091 1.2741091
[50,] 1.7371333 1.7371333 1.657051 1.409507 1.7371333 1.2730838 1.7371331
[51,] 1.2744440 0.9071912 1.411967 1.411967 0.9071911 0.9071911 1.2744440
[52,] 2.3595836 1.7383576 1.408657 1.657093 1.7383581 1.2726221 0.9001163
[53,] 0.9091609 0.9091609 1.412887 1.656903 0.9091609 0.9091609 0.9091609
[54,] 0.9019050 1.2730778 2.177552 1.409496 1.2730778 1.7371493 0.9019050
[55,] 0.9096160 0.9096160 1.377273 1.377273 0.9096159 0.9096159 0.9096163
[56,] 2.3634473 1.7397315 1.407712 1.407712 1.7397319 1.7397319 1.7397307
[57,] 0.9079519 0.9079519 2.171315 2.171315 0.9079519 0.9079519 0.9079519
[58,] 1.2736608 1.2736608 1.410558 2.175199 1.2736609 1.2736609 1.2736608
[59,] 0.9038058 1.2735642 2.175584 1.792867 1.2735643 0.9038052 1.2735639
[60,] 0.8993546 1.2724308 1.657112 1.408302 1.2724308 1.2724308 1.2724308
[61,] 2.3628070 1.7395026 1.407868 2.181176 1.7395036 3.2982192 1.7395004
[62,] 0.9085771 1.2748079 1.412615 1.656914 0.9085771 0.9085771 0.9085771
[63,] 0.9093825 0.9093825 1.377147 1.412991 0.9093824 0.9093824 0.9093828
[64,] 0.9023334 1.2731864 2.177109 2.177109 0.9023329 5.1126503 1.2731861
[65,] 1.2737496 1.2737496 1.656994 1.656994 1.2737496 1.2737496 1.2737496
[66,] 0.9072217 1.2744519 1.656939 1.656939 1.2744520 0.9072216 0.9072218
[67,] 0.8947159 5.1640589 3.465529 1.794472 1.2712751 1.2712751 1.2712751
[68,] 0.9015376 2.3568722 2.177935 1.793263 1.2729834 1.2729834 1.7373955
[69,] 1.2727609 1.7379881 1.657081 1.408913 1.7379883 1.7379883 1.7379876
[70,] 0.9095697 0.9095697 1.377247 1.413077 0.9095691 0.9095691 0.9095713
[71,] 0.9086593 0.9086593 1.656912 1.656912 0.9086593 0.9086593 0.9086593
[72,] 0.9002544 0.9002544 1.793488 1.793488 1.7382634 1.2726579 1.7382628
[73,] 0.9084345 0.9084345 1.412548 1.412548 1.2747703 1.2747703 0.9084346
[74,] 0.9057943 0.9057943 1.792556 1.375195 0.9057801 0.9057801 0.9058273
[75,] 0.9057463 0.9057463 1.411292 1.656968 1.2740670 1.2740670 1.2740669
[76,] 0.9084345 0.9084345 1.656916 1.656916 0.9084345 0.9084345 0.9084346
[77,] 1.2736578 1.2736578 1.657001 1.657001 1.2736578 1.2736578 1.2736578
[78,] 1.7356931 1.2736356 1.657003 1.410513 0.9040796 1.7356932 0.9040797
[79,] 0.9075229 1.2742961 2.172036 1.792580 0.9073808 0.9073808 0.9078542
[80,] 1.2738876 1.2738876 1.656983 1.410968 1.2738876 1.2738876 1.2738875
[81,] 2.4036607 1.7542815 3.520108 2.203402 2.4036607 1.7542815 1.2672608
[82,] 1.7444534 5.1874708 3.476413 1.795092 1.7444534 1.7444534 1.7444534
[83,] 0.9045779 0.9045779 1.792731 1.792731 0.9045779 5.0976171 0.9045779
[84,] 0.9004495 0.9004495 3.447494 1.793453 0.9004495 1.2727076 1.7381313
[85,] 1.2732626 1.2732626 1.409834 1.657035 1.2732626 1.2732626 1.2732626
[86,] 0.9091609 0.9091609 1.412887 1.656903 0.9091609 0.9091609 0.9091609
[87,] 1.2729115 2.3573831 1.657064 1.372768 1.2729122 1.2729122 0.9012790
[88,] 1.2735071 0.9035890 1.410281 1.657013 1.7360210 3.2791059 1.7360174
[89,] 1.2730553 1.2730553 1.409455 1.409455 1.2730553 1.2730553 1.7372084
[90,] 1.2745547 1.2745547 1.412164 1.412164 0.9076134 0.9076134 0.9076134
[91,] 1.2730668 1.2730668 1.793205 1.373091 1.2730668 1.2730668 1.7371784
[92,] 0.9093515 0.9093515 1.656900 1.412976 0.9093515 0.9093515 0.9093515
[93,] 0.9058876 5.0890786 1.411333 1.656955 0.9058736 0.9058736 0.9059202
[94,] 3.3278663 5.1925833 3.478789 1.366957 5.1925833 1.7449794 2.3780954
[95,] 0.8835852 0.8835852 1.657592 1.796508 1.7499416 3.3543452 5.2403917
[96,] 3.3083176 0.8957241 1.794291 3.462346 1.2715240 3.3083176 0.8957241
        ll_ef_8   ll_ef_9  ll_ef_10 ll_ef_11 ll_ef_12  ll_ef_13  ll_ef_14
 [1,] 1.2715006 0.8956961 5.1575166 1.794316 3.462497 1.2715063 1.2715063
 [2,] 0.9017855 1.7372301 1.2730466 1.409439 1.793219 1.7372303 1.7372303
 [3,] 2.3610850 0.8993278 0.8993278 1.371719 1.371719 1.7388926 1.2724221
 [4,] 3.3015444 0.8975434 2.3645330 1.793998 2.182127 0.8975314 2.3645486
 [5,] 0.9051044 1.2739005 0.9051043 2.174242 1.374841 0.9051043 0.9051043
 [6,] 0.9069266 0.9069266 0.9069266 1.411843 1.656945 0.9069266 0.9069266
 [7,] 0.9089216 1.2748892 0.9089118 1.412763 1.656904 0.9089076 0.9089076
 [8,] 1.2732584 1.2732584 1.2732584 1.657036 1.409826 0.9026116 1.2732584
 [9,] 1.7387812 1.2724580 1.2724580 1.371800 2.180082 1.7387890 2.3608031
[10,] 1.2735046 1.7360329 1.2735046 1.374013 1.410275 1.2735046 1.2735046
[11,] 0.9091609 0.9091609 0.9091609 1.412887 1.412887 0.9091609 0.9091609
[12,] 0.9063213 0.9063213 0.9063213 1.375498 2.172989 0.9063213 0.9063213
[13,] 0.8979799 2.3636690 3.2998889 1.370992 1.657147 1.2720855 3.2998890
[14,] 0.9083882 0.9083881 0.9083881 1.656917 1.656917 0.9083881 0.9083881
[15,] 1.2738023 1.2738023 1.2738023 1.410814 1.656990 1.2738023 1.2738023
[16,] 0.9087343 0.9087326 0.9087326 1.412686 1.412686 0.9087319 0.9087319
[17,] 1.7381516 0.9004194 0.9004194 1.657087 1.408801 1.2727000 3.2908157
[18,] 1.2722377 0.8985865 3.2976280 1.371320 2.181010 1.2722377 3.2976280
[19,] 0.9039506 0.9039506 0.9039506 1.374219 1.374219 1.2736024 1.2736024
[20,] 0.9045204 5.0980470 0.9045169 1.374522 1.410714 1.2737464 0.9045154
[21,] 0.8991716 5.1339039 0.8991715 1.657117 1.793678 3.2954510 1.7389983
[22,] 1.2722443 0.8986127 5.1376737 1.793777 3.453255 1.2722443 1.2722443
[23,] 2.3960141 2.3960143 5.2550667 1.399918 1.657670 3.3624844 5.2550668
[24,] 1.7411070 0.8960907 3.3069451 1.794226 3.461191 1.2716148 1.2716148
[25,] 3.2895379 1.2727845 2.3583462 1.372496 2.178741 0.9007632 0.9007632
[26,] 0.9053855 0.9053855 0.9053855 3.432094 1.792591 0.9053855 0.9053855
[27,] 0.8899985 5.1962341 0.8899985 3.480485 1.795325 0.8899985 5.1962341
[28,] 5.1776636 3.3196162 1.2707849 2.187189 1.405194 2.3738362 2.3738362
[29,] 1.2743136 1.2743136 0.9066919 1.411734 1.411734 0.9066919 0.9066919
[30,] 1.2741150 0.9059327 0.9059327 1.792498 1.411378 1.2741152 1.2741152
[31,] 1.2734035 1.2734035 1.2734035 1.657023 2.176233 1.2734035 1.2734035
[32,] 0.9061257 0.9061255 0.9061255 2.173190 3.429795 0.9061254 0.9061254
[33,] 0.9077311 0.9077311 1.2745855 1.376258 1.376258 0.9077311 0.9077311
[34,] 1.2743801 1.2743801 0.9069466 1.411853 1.411853 1.7337932 0.9069466
[35,] 1.2739030 1.2739030 1.2739030 1.410996 1.374846 1.2739030 1.2739030
[36,] 1.2740739 1.2740808 1.2740808 2.173463 1.411333 1.2740838 1.2740838
[37,] 1.2738023 1.2738023 1.2738023 1.410814 1.656990 1.2738023 1.2738023
[38,] 0.9091609 0.9091609 0.9091609 1.412887 1.656903 0.9091609 0.9091609
[39,] 1.7350840 0.9049921 0.9049921 1.792662 1.792662 0.9049912 0.9049912
[40,] 1.2734720 1.2734722 1.7361150 1.410216 1.657017 1.2734723 1.2734723
[41,] 0.9096289 0.9096288 0.9096288 1.413106 1.413106 0.9096287 0.9096287
[42,] 1.2745953 1.2745953 0.9077684 1.376278 1.376278 1.2745953 0.9077684
[43,] 0.9080915 0.9080915 1.2746802 1.792125 1.376452 0.9080915 0.9080915
[44,] 1.2738754 0.9050073 0.9050073 1.410946 2.174342 1.2738754 1.2738754
[45,] 0.9062640 0.9062640 1.2742019 1.411534 1.656958 0.9062640 0.9062640
[46,] 2.3582591 1.2727987 1.2727987 1.372522 1.372522 1.7378885 1.7378885
[47,] 0.9077050 0.9077046 0.9077046 2.171569 2.171569 0.9077045 0.9077045
[48,] 3.3362657 3.3362658 3.3362658 1.365755 1.365755 1.7465462 3.3362659
[49,] 0.9059079 0.9059078 0.9059078 1.411367 1.656965 1.2741091 1.2741091
[50,] 1.2730837 1.2730837 1.2730837 1.373127 1.657051 1.7371333 1.2730838
[51,] 0.9071912 0.9071912 0.9071912 1.411967 3.426489 0.9071911 0.9071911
[52,] 1.7383565 1.2726219 3.2919496 1.657093 1.372146 1.2726221 1.2726221
[53,] 0.9091609 0.9091609 0.9091609 1.656903 1.412887 0.9091609 0.9091609
[54,] 1.2730778 1.7371493 1.7371493 1.409496 1.409496 1.7371493 1.7371493
[55,] 0.9096163 0.9096160 0.9096160 1.377273 1.377273 0.9096159 0.9096159
[56,] 1.7397307 3.2994592 1.2721139 1.407712 1.407712 1.7397319 1.7397319
[57,] 0.9079519 0.9079519 0.9079519 1.412323 1.412323 0.9079519 0.9079519
[58,] 1.2736608 1.2736608 1.2736608 2.175199 1.792801 0.9041772 1.2736609
[59,] 0.9038071 1.2735642 1.2735642 2.175584 2.175584 1.2735643 1.2735643
[60,] 1.7388736 2.3610350 1.7388738 2.180208 1.408302 3.2947706 1.7388738
[61,] 1.7395004 0.8984305 0.8984305 1.657135 1.657135 0.8984293 3.2982192
[62,] 0.9085771 0.9085771 0.9085771 1.656914 1.412615 0.9085771 0.9085771
[63,] 0.9093828 0.9093825 0.9093825 1.377147 1.377147 0.9093824 0.9093824
[64,] 0.9023346 0.9023334 0.9023334 2.177109 1.657041 1.2731865 0.9023329
[65,] 1.2737496 1.2737496 1.2737496 1.410719 1.656994 1.2737496 1.2737496
[66,] 0.9072218 1.2744519 0.9072217 1.656939 1.411981 1.2744520 0.9072216
[67,] 1.2712751 0.8947159 5.1640589 1.794472 3.465529 1.2712751 1.2712751
[68,] 1.7373955 0.9015376 1.2729833 1.793263 1.409323 1.2729834 1.2729834
[69,] 1.7379876 1.2727609 1.2727609 1.372442 1.657081 1.7379883 1.7379883
[70,] 0.9095713 0.9095697 0.9095697 1.377247 1.656895 0.9095691 0.9095691
[71,] 0.9086593 0.9086593 0.9086593 1.656912 1.656912 0.9086593 0.9086593
[72,] 2.3593157 1.2726578 0.9002544 1.372222 1.793488 1.7382634 1.7382634
[73,] 0.9084346 0.9084345 0.9084345 1.412548 1.412548 0.9084345 0.9084345
[74,] 0.9058273 5.0897032 0.9057943 1.375195 1.375195 0.9057801 0.9057801
[75,] 1.2740669 1.2740670 0.9057463 1.656968 1.411292 1.2740670 1.2740670
[76,] 0.9084346 0.9084345 0.9084345 2.170821 1.412548 0.9084345 0.9084345
[77,] 1.2736578 1.2736578 1.2736578 1.657001 1.657001 1.2736578 1.2736578
[78,] 2.3520513 1.2736356 1.2736356 1.657003 2.175300 0.9040796 0.9040796
[79,] 1.2742265 0.9075229 1.2742961 1.792580 1.792580 1.2743259 0.9073808
[80,] 1.2738875 1.2738876 1.2738876 1.410968 1.410968 1.2738876 1.2738876
[81,] 1.2672608 5.2815963 3.3772135 3.520108 2.203402 5.2815963 5.2815963
[82,] 1.7444534 0.8912796 5.1874708 3.476413 1.795092 1.2704364 1.7444534
[83,] 0.9045779 0.9045779 0.9045779 1.656993 1.374557 0.9045779 1.2737644
[84,] 0.9004495 0.9004495 5.1252967 1.793453 3.447494 0.9004495 0.9004495
[85,] 1.2732626 3.2826410 1.2732626 1.409834 1.657035 1.2732626 1.2732626
[86,] 0.9091609 0.9091609 0.9091609 1.656903 1.412887 0.9091609 0.9091609
[87,] 1.7375689 2.3573831 0.9012720 1.409194 1.657064 1.7375768 1.7375768
[88,] 1.7360174 0.9035890 0.9035890 1.410281 1.410281 0.9035877 0.9035877
[89,] 1.7372084 1.2730553 1.7372085 1.657054 1.409455 1.7372085 1.7372085
[90,] 0.9076134 1.2745547 1.2745547 1.656932 1.656932 0.9076134 0.9076134
[91,] 2.3562548 0.9018618 1.2730668 1.793205 1.373091 1.7371784 0.9018618
[92,] 0.9093515 0.9093515 0.9093515 1.412976 1.412976 0.9093515 0.9093515
[93,] 0.9059202 0.9058876 0.9058876 1.411333 1.411333 0.9058736 0.9058736
[94,] 1.2702558 0.8905318 5.1925833 1.404170 1.795228 0.8905318 1.2702558
[95,] 5.2403917 0.8835852 5.2403925 1.400911 1.796508 1.2686124 3.3543452
[96,] 1.2715240 3.3083176 2.3680100 1.369771 2.184014 0.8957240 2.3680100
       ll_ef_15  ll_ef_16
 [1,] 1.2715006 1.2715006
 [2,] 1.2730465 0.9017855
 [3,] 1.2724210 1.7388887
 [4,] 0.8975715 2.3644966
 [5,] 0.9051044 1.2739005
 [6,] 0.9069266 0.9069266
 [7,] 0.9089216 0.9089216
 [8,] 0.9026116 0.9026116
 [9,] 2.3607905 1.7387812
[10,] 1.2735046 1.2735046
[11,] 0.9091609 0.9091609
[12,] 0.9063213 0.9063213
[13,] 5.1419476 1.7398108
[14,] 0.9083882 0.9083882
[15,] 1.2738023 1.2738023
[16,] 0.9087343 0.9087343
[17,] 1.2727000 3.2908155
[18,] 1.7393967 1.7393967
[19,] 0.9039506 0.9039506
[20,] 0.9045204 1.2737453
[21,] 1.2723848 1.2723848
[22,] 1.2722443 1.2722443
[23,] 1.7514805 1.2681243
[24,] 1.7411070 1.7411070
[25,] 0.9007698 0.9007698
[26,] 0.9053855 0.9053855
[27,] 0.8899985 0.8899985
[28,] 2.3738348 1.7434461
[29,] 0.9066919 1.2743136
[30,] 1.2741150 0.9059334
[31,] 1.2734035 1.2734035
[32,] 0.9061257 1.2741657
[33,] 0.9077311 0.9077311
[34,] 0.9069466 1.2743801
[35,] 1.2739030 1.2739030
[36,] 0.9059202 0.9059202
[37,] 1.2738023 1.2738023
[38,] 0.9091609 0.9091609
[39,] 0.9049942 1.7350840
[40,] 1.7361143 1.2734720
[41,] 0.9096289 0.9096289
[42,] 0.9077685 0.9077685
[43,] 0.9080915 0.9080915
[44,] 1.2738754 1.2738754
[45,] 0.9062640 0.9062640
[46,] 1.2727987 2.3582591
[47,] 0.9077050 0.9077050
[48,] 2.3824363 2.3824363
[49,] 1.2741091 1.2741091
[50,] 1.7371331 1.2730837
[51,] 0.9071912 0.9071912
[52,] 1.2726216 1.7383565
[53,] 0.9091609 0.9091609
[54,] 1.7371493 1.7371493
[55,] 0.9096163 0.9096163
[56,] 1.7397307 1.7397307
[57,] 0.9079519 0.9079519
[58,] 1.2736608 0.9041772
[59,] 1.2735639 1.2735639
[60,] 1.7388736 1.7388736
[61,] 0.8984333 1.2721959
[62,] 0.9085771 0.9085771
[63,] 0.9093828 0.9093828
[64,] 0.9023346 0.9023346
[65,] 1.2737496 1.2737496
[66,] 0.9072218 0.9072218
[67,] 1.2712751 1.2712751
[68,] 1.7373955 1.7373955
[69,] 1.7379876 1.7379876
[70,] 0.9095713 0.9095713
[71,] 0.9086593 0.9086593
[72,] 3.2914283 1.7382628
[73,] 0.9084346 1.2747703
[74,] 0.9058273 0.9058273
[75,] 1.2740669 1.2740669
[76,] 0.9084346 0.9084346
[77,] 1.2736578 1.2736578
[78,] 0.9040797 0.9040797
[79,] 0.9078542 0.9078542
[80,] 1.2738875 1.2738875
[81,] 5.2815962 5.2815962
[82,] 1.2704363 1.7444534
[83,] 0.9045779 0.9045779
[84,] 0.9004495 0.9004495
[85,] 1.2732626 1.2732626
[86,] 0.9091609 0.9091609
[87,] 1.2729100 1.7375689
[88,] 1.7360174 0.9035922
[89,] 1.7372084 1.7372084
[90,] 0.9076134 0.9076134
[91,] 1.7371784 2.3562548
[92,] 0.9093515 0.9093515
[93,] 0.9059202 0.9059202
[94,] 1.2702558 0.8905319
[95,] 5.2403917 5.2403917
[96,] 0.8957241 1.2715240</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(ll_matrix_ef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2278.867</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model on full data</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>result_full <span class="ot">&lt;-</span> <span class="fu">optim</span>(</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),  <span class="co"># log(ce), logit(n)</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn =</span> objective_function,</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">all_choice =</span> all_choice_full</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract fitted parameters</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>ce_ef <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">1</span>])</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>n_ef <span class="ot">&lt;-</span> <span class="fu">exp</span>(result_full<span class="sc">$</span>par[<span class="dv">2</span>])</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="co">#tau_ef &lt;- exp(result_full$par[3])</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Fitted parameters:</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitted parameters:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(ce_ef,n_ef))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.852318e+00 4.440967e+07</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NB</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert matrix to data frame</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>ll_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ll_matrix_nb)</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Optional: ensure column names are valid in final_data</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ll_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"ll_nb_"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>)</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind to final_data</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(final_data, ll_df)</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="co">#MV</span></span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind to final_data</span></span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>ll_df_mv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ll_matrix_mv)</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(final_data, ll_df_mv)</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="co">#DH</span></span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind to final_data</span></span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>ll_df_dh<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ll_matrix_dh)</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(final_data, ll_df_dh)</span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a><span class="co">#EF</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind to final_data</span></span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>ll_df_ef<span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ll_matrix_ef)</span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(final_data, ll_df_ef)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co">#baseline model</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>ll_list_none <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_subjects)</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">96</span>){</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>  ll_list_none[i] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">16</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>ll_none <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">16</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>), <span class="fu">nrow</span>(final_data))  <span class="co"># Baseline</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> final_data[, <span class="fu">c</span>(<span class="st">"ll_nb"</span>, <span class="st">"ll_mv"</span>,  <span class="st">"ll_ef"</span>,<span class="st">"ll_none"</span>)]</span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 找到每一行中最小值所在列名（即最佳模型）</span></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a>min_col <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">names</span>(<span class="fu">which.min</span>(row)))</span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>min_value <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, min)</span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总哪个模型赢了几次</span></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(min_col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>min_col
  ll_ef   ll_mv   ll_nb ll_none 
     17      55      17       7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 汇总各模型赢时对应的负对数似然总和</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>min_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">min_col =</span> min_col, <span class="at">min_value =</span> min_value)</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>result_sum <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(min_value <span class="sc">~</span> min_col, <span class="at">data =</span> min_df, sum)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result_sum)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  min_col min_value
1   ll_ef  352.1046
2   ll_mv 1107.5101
3   ll_nb  446.3450
4 ll_none  200.6771</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: 给每个参与者添加最佳模型归类</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> final_data[, <span class="fu">c</span>( <span class="st">"ll_mv"</span>, <span class="st">"ll_none"</span>,<span class="st">"ll_nb"</span>,<span class="st">"ll_ef"</span>)]</span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a>min_col <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">names</span>(<span class="fu">which.min</span>(row)))</span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>best_model <span class="ot">&lt;-</span> min_col</span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: 整理为长格式</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(best_model, div, nodiv1, nodiv2) <span class="sc">%&gt;%</span></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(div, nodiv1, nodiv2),</span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"type"</span>,</span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: 按 best_model 和 type 分组，计算平均值和标准差</span></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(best_model, type) <span class="sc">%&gt;%</span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_value =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: 绘图</span></span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> mean_value, <span class="at">group =</span> best_model, <span class="at">color =</span> best_model)) <span class="sc">+</span></span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_value <span class="sc">-</span> sd_value,</span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ymax =</span> mean_value <span class="sc">+</span> sd_value),</span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb178-36"><a href="#cb178-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"div"</span> , <span class="st">"nodiv"</span>)) <span class="sc">+</span></span>
<span id="cb178-37"><a href="#cb178-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Mean ± SD of Participant Ratings by Best-Fit Model"</span>,</span>
<span id="cb178-38"><a href="#cb178-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Condition Type"</span>, <span class="at">y =</span> <span class="st">"Mean Rating"</span>,</span>
<span id="cb178-39"><a href="#cb178-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Best Model"</span>) <span class="sc">+</span></span>
<span id="cb178-40"><a href="#cb178-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the 'div' condition</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>div_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"div"</span>)</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the 'div' condition</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>div_data <span class="sc">%&gt;%</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(best_model) <span class="sc">%&gt;%</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n    =</span> <span class="fu">n</span>(),</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  best_model  mean    sd     n
  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 ll_ef       42.1  18.9    17
2 ll_mv       48.2  21.1    55
3 ll_nb       62.9  23.5    17
4 ll_none     46.7  24.5     7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(div_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 3
   best_model type  value
   &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt;
 1 ll_nb      div      98
 2 ll_ef      div      50
 3 ll_nb      div      50
 4 ll_nb      div      98
 5 ll_ef      div      40
 6 ll_mv      div      34
 7 ll_mv      div      80
 8 ll_mv      div      30
 9 ll_nb      div      98
10 ll_ef      div      30
# ℹ 86 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run one-way ANOVA</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> best_model, <span class="at">data =</span> div_data)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
best_model   3   4132  1377.3   3.004 0.0344 *
Residuals   92  42181   458.5                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = value ~ best_model, data = div_data)

$best_model
                    diff         lwr       upr     p adj
ll_mv-ll_ef     6.141176  -9.4064630 21.688816 0.7302595
ll_nb-ll_ef    20.823529   1.6061327 40.040926 0.0283015
ll_none-ll_ef   4.655462 -20.5060164 29.816941 0.9624395
ll_nb-ll_mv    14.682353  -0.8652865 30.229992 0.0713192
ll_none-ll_mv  -1.485714 -23.9695032 20.998075 0.9981498
ll_none-ll_nb -16.168067 -41.3295459  8.993411 0.3393581</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the 'nodiv1' condition</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>div_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"nodiv1"</span>)</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the 'div' condition</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>div_data <span class="sc">%&gt;%</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(best_model) <span class="sc">%&gt;%</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">n    =</span> <span class="fu">n</span>(),</span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  best_model  mean    sd     n
  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 ll_ef       33.1  15.3    17
2 ll_mv       27.4  12.1    55
3 ll_nb       20.2  12.9    17
4 ll_none     28.4  14.8     7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(div_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 3
   best_model type   value
   &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;
 1 ll_nb      nodiv1     1
 2 ll_ef      nodiv1    25
 3 ll_nb      nodiv1    30
 4 ll_nb      nodiv1     1
 5 ll_ef      nodiv1    30
 6 ll_mv      nodiv1    33
 7 ll_mv      nodiv1    10
 8 ll_mv      nodiv1    40
 9 ll_nb      nodiv1     1
10 ll_ef      nodiv1    60
# ℹ 86 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run one-way ANOVA</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> best_model, <span class="at">data =</span> div_data)</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
best_model   3   1436   478.6   2.817 0.0435 *
Residuals   92  15633   169.9                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = value ~ best_model, data = div_data)

$best_model
                     diff        lwr       upr     p adj
ll_mv-ll_ef    -5.6224599 -15.087506  3.842586 0.4097610
ll_nb-ll_ef   -12.8823529 -24.581462 -1.183243 0.0249796
ll_none-ll_ef  -4.6302521 -19.947982 10.687478 0.8583891
ll_nb-ll_mv    -7.2598930 -16.724939  2.205153 0.1929172
ll_none-ll_mv   0.9922078 -12.695406 14.679822 0.9975632
ll_none-ll_nb   8.2521008  -7.065629 23.569831 0.4966191</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the 'nodiv2' condition</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>div_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"nodiv2"</span>)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the 'div' condition</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>div_data <span class="sc">%&gt;%</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(best_model) <span class="sc">%&gt;%</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd   =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">n    =</span> <span class="fu">n</span>(),</span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  best_model  mean    sd     n
  &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1 ll_ef       24.9  11.1    17
2 ll_mv       24.4  10.9    55
3 ll_nb       16.9  13.0    17
4 ll_none     24.9  11.3     7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(div_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 96 × 3
   best_model type   value
   &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;
 1 ll_nb      nodiv2     1
 2 ll_ef      nodiv2    25
 3 ll_nb      nodiv2    20
 4 ll_nb      nodiv2     1
 5 ll_ef      nodiv2    30
 6 ll_mv      nodiv2    33
 7 ll_mv      nodiv2    10
 8 ll_mv      nodiv2    30
 9 ll_nb      nodiv2     1
10 ll_ef      nodiv2    10
# ℹ 86 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run one-way ANOVA</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> best_model, <span class="at">data =</span> div_data)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
best_model   3    808   269.2   2.099  0.106
Residuals   92  11798   128.2               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = value ~ best_model, data = div_data)

$best_model
                     diff        lwr        upr     p adj
ll_mv-ll_ef   -0.51871658  -8.741444  7.7040110 0.9983886
ll_nb-ll_ef   -7.94117647 -18.104740  2.2223868 0.1794681
ll_none-ll_ef -0.02521008 -13.332438 13.2820180 1.0000000
ll_nb-ll_mv   -7.42245989 -15.645187  0.8002677 0.0918426
ll_none-ll_mv  0.49350649 -11.397564 12.3845766 0.9995384
ll_none-ll_nb  7.91596639  -5.391262 21.2231944 0.4084923</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data[, <span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">names</span>(final_data))]</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_ll_nb =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_nb_1<span class="sc">:</span>ll_nb_8)),</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_nb_9<span class="sc">:</span>ll_nb_16)),</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">NA_real_</span>)),</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_ll_nb =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_nb_1<span class="sc">:</span>ll_nb_8)),</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_nb_9<span class="sc">:</span>ll_nb_16)),</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">NA_real_</span>)),</span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_ll_mv =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_mv_1<span class="sc">:</span>ll_mv_8)),</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_mv_9<span class="sc">:</span>ll_mv_16)),</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">NA_real_</span>)),</span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_ll_mv =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_mv_1<span class="sc">:</span>ll_mv_8)),</span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_mv_9<span class="sc">:</span>ll_mv_16)),</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">NA_real_</span>)),</span>
<span id="cb203-25"><a href="#cb203-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_ll_dh =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-26"><a href="#cb203-26" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_dh_1<span class="sc">:</span>ll_dh_8)),</span>
<span id="cb203-27"><a href="#cb203-27" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-28"><a href="#cb203-28" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_dh_9<span class="sc">:</span>ll_dh_16)),</span>
<span id="cb203-29"><a href="#cb203-29" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">NA_real_</span>)),</span>
<span id="cb203-30"><a href="#cb203-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_ll_dh =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-31"><a href="#cb203-31" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_dh_1<span class="sc">:</span>ll_dh_8)),</span>
<span id="cb203-32"><a href="#cb203-32" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-33"><a href="#cb203-33" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_dh_9<span class="sc">:</span>ll_dh_16)),</span>
<span id="cb203-34"><a href="#cb203-34" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">NA_real_</span>)),</span>
<span id="cb203-35"><a href="#cb203-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_ll_ef =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-36"><a href="#cb203-36" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_ef_1<span class="sc">:</span>ll_ef_8)),</span>
<span id="cb203-37"><a href="#cb203-37" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-38"><a href="#cb203-38" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_ef_9<span class="sc">:</span>ll_ef_16)),</span>
<span id="cb203-39"><a href="#cb203-39" aria-hidden="true" tabindex="-1"></a>                                <span class="cn">NA_real_</span>)),</span>
<span id="cb203-40"><a href="#cb203-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_ll_ef =</span> <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">2</span>,</span>
<span id="cb203-41"><a href="#cb203-41" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_ef_1<span class="sc">:</span>ll_ef_8)),</span>
<span id="cb203-42"><a href="#cb203-42" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(Group <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb203-43"><a href="#cb203-43" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">rowSums</span>(<span class="fu">across</span>(ll_ef_9<span class="sc">:</span>ll_ef_16)),</span>
<span id="cb203-44"><a href="#cb203-44" aria-hidden="true" tabindex="-1"></a>                                 <span class="cn">NA_real_</span>)),</span>
<span id="cb203-45"><a href="#cb203-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">first_ll_none =</span> <span class="dv">8</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">6</span>),</span>
<span id="cb203-46"><a href="#cb203-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">second_ll_none =</span> <span class="dv">8</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">6</span>),</span>
<span id="cb203-47"><a href="#cb203-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_different_nb =</span> ll_nb_3<span class="sc">+</span>ll_nb_4<span class="sc">+</span>ll_nb_11<span class="sc">+</span>ll_nb_12,</span>
<span id="cb203-48"><a href="#cb203-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_same_nb =</span> ll_nb_1<span class="sc">+</span>ll_nb_2<span class="sc">+</span>ll_nb_5<span class="sc">+</span>ll_nb_6<span class="sc">+</span>ll_nb_7<span class="sc">+</span>ll_nb_8<span class="sc">+</span>ll_nb_9<span class="sc">+</span>ll_nb_10<span class="sc">+</span>ll_nb_13<span class="sc">+</span>ll_nb_14<span class="sc">+</span>ll_nb_15<span class="sc">+</span>ll_nb_16,</span>
<span id="cb203-49"><a href="#cb203-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_different_mv =</span> ll_mv_3<span class="sc">+</span>ll_mv_4<span class="sc">+</span>ll_mv_11<span class="sc">+</span>ll_mv_12,</span>
<span id="cb203-50"><a href="#cb203-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_same_mv =</span> ll_mv_1<span class="sc">+</span>ll_mv_2<span class="sc">+</span>ll_mv_5<span class="sc">+</span>ll_mv_6<span class="sc">+</span>ll_mv_7<span class="sc">+</span>ll_mv_8<span class="sc">+</span>ll_mv_9<span class="sc">+</span>ll_mv_10<span class="sc">+</span>ll_mv_13<span class="sc">+</span>ll_mv_14<span class="sc">+</span>ll_mv_15<span class="sc">+</span>ll_mv_16,</span>
<span id="cb203-51"><a href="#cb203-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_different_dh =</span> ll_dh_3<span class="sc">+</span>ll_dh_4<span class="sc">+</span>ll_dh_11<span class="sc">+</span>ll_dh_12,</span>
<span id="cb203-52"><a href="#cb203-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_same_dh =</span> ll_dh_1<span class="sc">+</span>ll_dh_2<span class="sc">+</span>ll_dh_5<span class="sc">+</span>ll_dh_6<span class="sc">+</span>ll_dh_7<span class="sc">+</span>ll_dh_8<span class="sc">+</span>ll_dh_9<span class="sc">+</span>ll_dh_10<span class="sc">+</span>ll_dh_13<span class="sc">+</span>ll_dh_14<span class="sc">+</span>ll_dh_15<span class="sc">+</span>ll_dh_16,</span>
<span id="cb203-53"><a href="#cb203-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_different_ef =</span> ll_ef_3<span class="sc">+</span>ll_ef_4<span class="sc">+</span>ll_ef_11<span class="sc">+</span>ll_ef_12,</span>
<span id="cb203-54"><a href="#cb203-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_same_ef =</span> ll_ef_1<span class="sc">+</span>ll_ef_2<span class="sc">+</span>ll_ef_5<span class="sc">+</span>ll_ef_6<span class="sc">+</span>ll_ef_7<span class="sc">+</span>ll_ef_8<span class="sc">+</span>ll_ef_9<span class="sc">+</span>ll_ef_10<span class="sc">+</span>ll_ef_13<span class="sc">+</span>ll_ef_14<span class="sc">+</span>ll_ef_15<span class="sc">+</span>ll_ef_16,</span>
<span id="cb203-55"><a href="#cb203-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_different_none =</span> <span class="dv">4</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">6</span>),</span>
<span id="cb203-56"><a href="#cb203-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll_same_none =</span> <span class="dv">12</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">6</span>)</span>
<span id="cb203-57"><a href="#cb203-57" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function for McFadden R2 analysis</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>evaluate_round <span class="ot">&lt;-</span> <span class="cf">function</span>(round_prefix) {</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> final_data[, <span class="fu">paste0</span>(round_prefix, <span class="fu">c</span>(<span class="st">"_ll_nb"</span>, <span class="st">"_ll_mv"</span>, <span class="st">"_ll_dh"</span>, <span class="st">"_ll_ef"</span>,<span class="st">"_ll_none"</span>))]</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"nb"</span>, <span class="st">"mv"</span>, <span class="st">"dh"</span>, <span class="st">"ef"</span>, <span class="st">"none"</span>)  <span class="co"># Simplify for display</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Best model per subject</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a>  min_col <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">names</span>(<span class="fu">which.min</span>(row)))</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a>  min_value <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, min)</span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== Winner count ("</span>, round_prefix, <span class="st">") ===</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(min_col))</span>
<span id="cb204-11"><a href="#cb204-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-12"><a href="#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sum of -loglikelihood for winners only</span></span>
<span id="cb204-13"><a href="#cb204-13" aria-hidden="true" tabindex="-1"></a>  min_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">min_col =</span> min_col, <span class="at">min_value =</span> min_value)</span>
<span id="cb204-14"><a href="#cb204-14" aria-hidden="true" tabindex="-1"></a>  result_sum <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(min_value <span class="sc">~</span> min_col, <span class="at">data =</span> min_df, sum)</span>
<span id="cb204-15"><a href="#cb204-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== Loglikelihood sums ("</span>, round_prefix, <span class="st">") ===</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb204-16"><a href="#cb204-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(result_sum)</span>
<span id="cb204-17"><a href="#cb204-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-18"><a href="#cb204-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># McFadden R²</span></span>
<span id="cb204-19"><a href="#cb204-19" aria-hidden="true" tabindex="-1"></a>  ll_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(df)</span>
<span id="cb204-20"><a href="#cb204-20" aria-hidden="true" tabindex="-1"></a>  logL <span class="ot">&lt;-</span> <span class="sc">-</span>ll_sums</span>
<span id="cb204-21"><a href="#cb204-21" aria-hidden="true" tabindex="-1"></a>  logL_null <span class="ot">&lt;-</span> logL[<span class="st">"none"</span>]</span>
<span id="cb204-22"><a href="#cb204-22" aria-hidden="true" tabindex="-1"></a>  mcfadden_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> logL <span class="sc">/</span> logL_null</span>
<span id="cb204-23"><a href="#cb204-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== McFadden R² ("</span>, round_prefix, <span class="st">") ===</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb204-24"><a href="#cb204-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(mcfadden_r2, <span class="dv">4</span>))</span>
<span id="cb204-25"><a href="#cb204-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb204-26"><a href="#cb204-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-27"><a href="#cb204-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Run both rounds</span></span>
<span id="cb204-28"><a href="#cb204-28" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate_round</span>(<span class="st">"first"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Winner count (first) ===
min_col
  dh   ef   mv   nb none 
  26   22   23   18    7 
=== Loglikelihood sums (first) ===
  min_col min_value
1      dh  258.2773
2      ef  229.9823
3      mv  213.0436
4      nb  237.2723
5    none  100.3385
=== McFadden R² (first) ===
    nb     mv     dh     ef   none 
0.0424 0.1806 0.1806 0.1825 0.0000 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate_round</span>(<span class="st">"second"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Winner count (second) ===
min_col
  dh   ef   mv   nb none 
  32   13   26   17    8 
=== Loglikelihood sums (second) ===
  min_col min_value
1      dh  315.9672
2      ef  140.9065
3      mv  244.2216
4      nb  223.9774
5    none  114.6726
=== McFadden R² (second) ===
    nb     mv     dh     ef   none 
0.0331 0.1717 0.1717 0.1614 0.0000 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>evaluate_round <span class="ot">&lt;-</span> <span class="cf">function</span>(col_prefix) {</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>   df <span class="ot">&lt;-</span> final_data[, <span class="fu">paste0</span>(col_prefix, <span class="fu">c</span>(<span class="st">"_nb"</span>, <span class="st">"_mv"</span>, <span class="st">"_dh"</span>, <span class="st">"_ef"</span>, <span class="st">"_none"</span>))]</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"nb"</span>, <span class="st">"mv"</span>, <span class="st">"dh"</span>, <span class="st">"ef"</span>, <span class="st">"none"</span>)  <span class="co"># Simplify for display</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>  min_col <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">names</span>(<span class="fu">which.min</span>(row)))</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>  min_value <span class="ot">&lt;-</span> <span class="fu">apply</span>(df, <span class="dv">1</span>, min)</span>
<span id="cb208-7"><a href="#cb208-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-8"><a href="#cb208-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== Winner count ("</span>, col_prefix, <span class="st">") ===</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb208-9"><a href="#cb208-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(min_col))</span>
<span id="cb208-10"><a href="#cb208-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-11"><a href="#cb208-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 汇总 Loglikelihood 和 R²</span></span>
<span id="cb208-12"><a href="#cb208-12" aria-hidden="true" tabindex="-1"></a>  result_sum <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(min_value <span class="sc">~</span> min_col, <span class="at">data =</span> <span class="fu">data.frame</span>(min_col, min_value), sum)</span>
<span id="cb208-13"><a href="#cb208-13" aria-hidden="true" tabindex="-1"></a>  logL <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">colSums</span>(df)</span>
<span id="cb208-14"><a href="#cb208-14" aria-hidden="true" tabindex="-1"></a>  mcfadden_r2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> logL <span class="sc">/</span> logL[<span class="st">"none"</span>]</span>
<span id="cb208-15"><a href="#cb208-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== McFadden R² ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb208-16"><a href="#cb208-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">round</span>(mcfadden_r2, <span class="dv">4</span>))</span>
<span id="cb208-17"><a href="#cb208-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-18"><a href="#cb208-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 局部 R²</span></span>
<span id="cb208-19"><a href="#cb208-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"=== Local McFadden R² ===</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb208-20"><a href="#cb208-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (model <span class="cf">in</span> <span class="fu">unique</span>(min_col)) {</span>
<span id="cb208-21"><a href="#cb208-21" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">which</span>(min_col <span class="sc">==</span> model)</span>
<span id="cb208-22"><a href="#cb208-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb208-23"><a href="#cb208-23" aria-hidden="true" tabindex="-1"></a>      r2_local <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="sc">-</span><span class="fu">sum</span>(df[idx, model])) <span class="sc">/</span> (<span class="sc">-</span><span class="fu">sum</span>(df[idx, <span class="st">"none"</span>]))</span>
<span id="cb208-24"><a href="#cb208-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(model, <span class="st">": "</span>, <span class="fu">round</span>(r2_local, <span class="dv">4</span>), <span class="st">" ("</span>, <span class="fu">length</span>(idx), <span class="st">" subjects)</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb208-25"><a href="#cb208-25" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb208-26"><a href="#cb208-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(model, <span class="st">": &lt;only 1 subject&gt;</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb208-27"><a href="#cb208-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb208-28"><a href="#cb208-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb208-29"><a href="#cb208-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-30"><a href="#cb208-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 返回一个新列</span></span>
<span id="cb208-31"><a href="#cb208-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(min_col)</span>
<span id="cb208-32"><a href="#cb208-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-33"><a href="#cb208-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-34"><a href="#cb208-34" aria-hidden="true" tabindex="-1"></a>plot_diversity_by_specific_model <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">model_col =</span> <span class="st">"best_model_same"</span>) {</span>
<span id="cb208-35"><a href="#cb208-35" aria-hidden="true" tabindex="-1"></a>  plot_data <span class="ot">&lt;-</span> final_data <span class="sc">%&gt;%</span></span>
<span id="cb208-36"><a href="#cb208-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ip, <span class="fu">all_of</span>(model_col), div, nodiv1, nodiv2) <span class="sc">%&gt;%</span></span>
<span id="cb208-37"><a href="#cb208-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(div, nodiv1, nodiv2),</span>
<span id="cb208-38"><a href="#cb208-38" aria-hidden="true" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">"type"</span>,</span>
<span id="cb208-39"><a href="#cb208-39" aria-hidden="true" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb208-40"><a href="#cb208-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">model =</span> <span class="fu">all_of</span>(model_col))</span>
<span id="cb208-41"><a href="#cb208-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-42"><a href="#cb208-42" aria-hidden="true" tabindex="-1"></a>  summary_data <span class="ot">&lt;-</span> plot_data <span class="sc">%&gt;%</span></span>
<span id="cb208-43"><a href="#cb208-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(model, type) <span class="sc">%&gt;%</span></span>
<span id="cb208-44"><a href="#cb208-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb208-45"><a href="#cb208-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_value =</span> <span class="fu">mean</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb208-46"><a href="#cb208-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">sd_value =</span> <span class="fu">sd</span>(value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb208-47"><a href="#cb208-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb208-48"><a href="#cb208-48" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb208-49"><a href="#cb208-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-50"><a href="#cb208-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> mean_value, <span class="at">group =</span> model, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb208-51"><a href="#cb208-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb208-52"><a href="#cb208-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb208-53"><a href="#cb208-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_value <span class="sc">-</span> sd_value,</span>
<span id="cb208-54"><a href="#cb208-54" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ymax =</span> mean_value <span class="sc">+</span> sd_value),</span>
<span id="cb208-55"><a href="#cb208-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb208-56"><a href="#cb208-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"div"</span> <span class="ot">=</span> <span class="st">"Ear + Foot"</span>, <span class="st">"nodiv1"</span> <span class="ot">=</span> <span class="st">"2 Ear"</span>, <span class="st">"nodiv2"</span> <span class="ot">=</span> <span class="st">"2 Foot"</span>)) <span class="sc">+</span></span>
<span id="cb208-57"><a href="#cb208-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Mean ± SD of Ratings by"</span>, model_col),</span>
<span id="cb208-58"><a href="#cb208-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Condition Type"</span>, <span class="at">y =</span> <span class="st">"Mean Rating"</span>,</span>
<span id="cb208-59"><a href="#cb208-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"Model"</span>) <span class="sc">+</span></span>
<span id="cb208-60"><a href="#cb208-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb208-61"><a href="#cb208-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb208-62"><a href="#cb208-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-63"><a href="#cb208-63" aria-hidden="true" tabindex="-1"></a><span class="co"># 调用函数</span></span>
<span id="cb208-64"><a href="#cb208-64" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate_round</span>(<span class="st">"ll_same"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Winner count (ll_same) ===
min_col
  dh   ef   mv   nb none 
  31   15   26   17    7 
=== McFadden R² ===
    nb     mv     dh     ef   none 
0.0383 0.2205 0.2205 0.2204 0.0000 
=== Local McFadden R² ===
nb: 0.0938 (17 subjects)
ef: 0.1527 (15 subjects)
dh: 0.3984 (31 subjects)
mv: 0.4144 (26 subjects)
none: 0 (7 subjects)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "nb"   "ef"   "nb"   "nb"   "dh"   "dh"   "dh"   "ef"   "nb"   "ef"  
[11] "mv"   "dh"   "none" "mv"   "dh"   "mv"   "ef"   "nb"   "dh"   "mv"  
[21] "ef"   "ef"   "none" "nb"   "ef"   "dh"   "none" "nb"   "mv"   "dh"  
[31] "dh"   "dh"   "dh"   "mv"   "dh"   "mv"   "dh"   "mv"   "dh"   "mv"  
[41] "mv"   "mv"   "dh"   "mv"   "mv"   "nb"   "dh"   "nb"   "dh"   "ef"  
[51] "dh"   "nb"   "mv"   "ef"   "dh"   "nb"   "mv"   "dh"   "mv"   "nb"  
[61] "ef"   "dh"   "dh"   "mv"   "dh"   "dh"   "nb"   "ef"   "nb"   "mv"  
[71] "mv"   "nb"   "mv"   "mv"   "mv"   "dh"   "dh"   "dh"   "mv"   "dh"  
[81] "none" "nb"   "dh"   "mv"   "ef"   "mv"   "ef"   "ef"   "nb"   "dh"  
[91] "ef"   "mv"   "dh"   "none" "none" "none"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>best_model_same <span class="ot">&lt;-</span> <span class="fu">evaluate_round</span>(<span class="st">"ll_same"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Winner count (ll_same) ===
min_col
  dh   ef   mv   nb none 
  31   15   26   17    7 
=== McFadden R² ===
    nb     mv     dh     ef   none 
0.0383 0.2205 0.2205 0.2204 0.0000 
=== Local McFadden R² ===
nb: 0.0938 (17 subjects)
ef: 0.1527 (15 subjects)
dh: 0.3984 (31 subjects)
mv: 0.4144 (26 subjects)
none: 0 (7 subjects)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_diversity_by_specific_model</span>(<span class="st">"best_model_same"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">evaluate_round</span>(<span class="st">"ll_different"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Winner count (ll_different) ===
min_col
  dh   ef   mv   nb none 
  23   22   27    9   15 
=== McFadden R² ===
    nb     mv     dh     ef   none 
0.0362 0.0433 0.0433 0.0268 0.0000 
=== Local McFadden R² ===
none: 0 (15 subjects)
ef: 0.1728 (22 subjects)
nb: 0.0995 (9 subjects)
mv: 0.154 (27 subjects)
dh: 0.1724 (23 subjects)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "none" "ef"   "ef"   "nb"   "ef"   "mv"   "dh"   "mv"   "nb"   "ef"  
[11] "mv"   "mv"   "ef"   "mv"   "dh"   "mv"   "mv"   "nb"   "dh"   "ef"  
[21] "none" "none" "dh"   "none" "dh"   "none" "none" "dh"   "ef"   "ef"  
[31] "dh"   "none" "mv"   "ef"   "ef"   "mv"   "dh"   "mv"   "nb"   "dh"  
[41] "ef"   "ef"   "nb"   "mv"   "mv"   "ef"   "dh"   "none" "dh"   "mv"  
[51] "mv"   "mv"   "mv"   "dh"   "ef"   "ef"   "mv"   "none" "nb"   "dh"  
[61] "mv"   "dh"   "ef"   "mv"   "dh"   "dh"   "none" "nb"   "dh"   "ef"  
[71] "mv"   "ef"   "ef"   "ef"   "mv"   "dh"   "dh"   "dh"   "nb"   "dh"  
[81] "none" "none" "ef"   "none" "mv"   "mv"   "mv"   "mv"   "mv"   "dh"  
[91] "ef"   "mv"   "dh"   "none" "nb"   "none"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>final_data<span class="sc">$</span>best_model_different <span class="ot">&lt;-</span> <span class="fu">evaluate_round</span>(<span class="st">"ll_different"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Winner count (ll_different) ===
min_col
  dh   ef   mv   nb none 
  23   22   27    9   15 
=== McFadden R² ===
    nb     mv     dh     ef   none 
0.0362 0.0433 0.0433 0.0268 0.0000 
=== Local McFadden R² ===
none: 0 (15 subjects)
ef: 0.1728 (22 subjects)
nb: 0.0995 (9 subjects)
mv: 0.154 (27 subjects)
dh: 0.1724 (23 subjects)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_diversity_by_specific_model</span>(<span class="st">"best_model_different"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculate-the-parameter" class="level2">
<h2 class="anchored" data-anchor-id="calculate-the-parameter">Calculate the Parameter</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Setup and Preparation ----</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registering fonts with R</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>w_list <span class="ot">&lt;-</span> <span class="fu">w_list3</span>(tau_nb)</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regenerate full response predictions</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>integral_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) <span class="fu">integral_function1</span>(<span class="at">ce =</span> ce_nb, <span class="at">i =</span> i,<span class="at">w_list=</span>w_list))</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(integral_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] 0.26452591 0.24819428 0.20478774 0.15298980 0.09581514 0.03368712

[[2]]
[1] 0.08300273 0.16115786 0.20089437 0.21562546 0.20302728 0.13629230

[[3]]
[1] 0.11692356 0.19009027 0.21259843 0.20730731 0.17508008 0.09800034

[[4]]
[1] 0.03300103 0.09457988 0.15179020 0.20411476 0.24868531 0.26782882

[[5]]
[1] 0.18134816 0.22571948 0.21638957 0.18426973 0.13360163 0.05867142

[[6]]
[1] 0.05079572 0.12297517 0.17649001 0.21473268 0.23325276 0.20175365

[[7]]
[1] 0.11549280 0.18904310 0.21228802 0.20774808 0.17616481 0.09926318

[[8]]
[1] 0.09406709 0.17161850 0.20584271 0.21351626 0.19339400 0.12156144

[[9]]
[1] 0.26452591 0.24819428 0.20478774 0.15298980 0.09581514 0.03368712

[[10]]
[1] 0.08300273 0.16115786 0.20089437 0.21562546 0.20302728 0.13629230

[[11]]
[1] 0.03300103 0.09457988 0.15179020 0.20411476 0.24868531 0.26782882

[[12]]
[1] 0.11692356 0.19009027 0.21259843 0.20730731 0.17508008 0.09800034

[[13]]
[1] 0.18134816 0.22571948 0.21638957 0.18426973 0.13360163 0.05867142

[[14]]
[1] 0.05079572 0.12297517 0.17649001 0.21473268 0.23325276 0.20175365

[[15]]
[1] 0.11549280 0.18904310 0.21228802 0.20774808 0.17616481 0.09926318

[[16]]
[1] 0.09406709 0.17161850 0.20584271 0.21351626 0.19339400 0.12156144</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>integral_list2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) <span class="fu">integral_function2</span>(<span class="at">ce=</span>ce_mv, <span class="at">i=</span>i, <span class="at">n=</span>n_mv))</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>integral_list4 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="cf">function</span>(i) <span class="fu">integral_function4</span>(<span class="at">ce=</span>ce_ef,<span class="at">n=</span>n_ef, <span class="at">i=</span>i))</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Data for plotting bars</span></span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">create_all_choice</span>(final_data)</span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Plotting ----</span></span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>layout_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(layout_matrix)</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># bottom, left, top, right</span></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))  <span class="co"># outer margins</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>  beta_baseline <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, integral_list[[cond]], <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>),</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">tck =</span> <span class="sc">-</span><span class="fl">0.02</span>, <span class="at">cex.axis =</span> <span class="fl">0.7</span>)</span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">tck =</span> <span class="sc">-</span><span class="fl">0.02</span>, <span class="at">cex.axis =</span> <span class="fl">0.7</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">"Decision"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">"Proportion"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list[[cond]],   <span class="at">col =</span> <span class="st">"green"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)         <span class="co"># Normative Bayesian</span></span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list2[[cond]],  <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)         <span class="co"># Majority Vote</span></span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list4[[cond]],  <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)     <span class="co"># Exaggerated Feature</span></span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, beta_baseline,           <span class="at">col =</span> <span class="st">"grey"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)           <span class="co"># Uniform prior</span></span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Observed bar</span></span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>  full_d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a>  which_list <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(condition <span class="sc">==</span> cond) <span class="sc">%&gt;%</span></span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="dv">96</span>) <span class="sc">%&gt;%</span></span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">right_join</span>(full_d, <span class="at">by =</span> <span class="st">"d"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">count =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(count), <span class="dv">0</span>, count),</span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">proportion =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(proportion), <span class="dv">0</span>, proportion)</span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(d)</span>
<span id="cb224-42"><a href="#cb224-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb224-43"><a href="#cb224-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb224-44"><a href="#cb224-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rect</span>(</span>
<span id="cb224-45"><a href="#cb224-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">xleft =</span> j <span class="sc">-</span> <span class="fl">0.4</span>,</span>
<span id="cb224-46"><a href="#cb224-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">xright =</span> j <span class="sc">+</span> <span class="fl">0.4</span>,</span>
<span id="cb224-47"><a href="#cb224-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">ybottom =</span> <span class="dv">0</span>,</span>
<span id="cb224-48"><a href="#cb224-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">ytop =</span> which_list<span class="sc">$</span>proportion[j],</span>
<span id="cb224-49"><a href="#cb224-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb224-50"><a href="#cb224-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span></span>
<span id="cb224-51"><a href="#cb224-51" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb224-52"><a href="#cb224-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb224-53"><a href="#cb224-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-54"><a href="#cb224-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">"Cond"</span>, cond), <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">0.5</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb224-55"><a href="#cb224-55" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Legend (manual, outside loop) ----</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"center"</span>,</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Normative Bayesian"</span>, <span class="st">"Diversity Heuristic"</span>, <span class="st">"Majority Vote"</span>, <span class="st">"Observed"</span>, <span class="st">"Uniform Prior"</span>),</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.8</span>), <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.8</span>), <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.8</span>), <span class="fu">rgb</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">"grey"</span>),</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">15</span>, <span class="cn">NA</span>),</span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">pt.cex =</span> <span class="dv">2</span>,</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-16-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" aria-hidden="true" tabindex="-1"></a>collapse_map <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb226-5"><a href="#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">condition =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>, <span class="dv">2</span>,<span class="dv">10</span>, <span class="dv">3</span>,<span class="dv">12</span>, <span class="dv">4</span>,<span class="dv">11</span>, <span class="dv">5</span>,<span class="dv">13</span>, <span class="dv">6</span>,<span class="dv">14</span>, <span class="dv">7</span>,<span class="dv">15</span>, <span class="dv">8</span>,<span class="dv">16</span>),</span>
<span id="cb226-6"><a href="#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">collapsed =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">each =</span> <span class="dv">2</span>)</span>
<span id="cb226-7"><a href="#cb226-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb226-8"><a href="#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="#cb226-9" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">collapsed =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">d =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb226-10"><a href="#cb226-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-11"><a href="#cb226-11" aria-hidden="true" tabindex="-1"></a>all_data_collapsed <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span></span>
<span id="cb226-12"><a href="#cb226-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(collapse_map, <span class="at">by =</span> <span class="st">"condition"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb226-13"><a href="#cb226-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(collapsed, d) <span class="sc">%&gt;%</span></span>
<span id="cb226-14"><a href="#cb226-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">sum</span>(count), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb226-15"><a href="#cb226-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(grid, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"collapsed"</span>, <span class="st">"d"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb226-16"><a href="#cb226-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> tidyr<span class="sc">::</span><span class="fu">replace_na</span>(count, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb226-17"><a href="#cb226-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(collapsed) <span class="sc">%&gt;%</span></span>
<span id="cb226-18"><a href="#cb226-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> count <span class="sc">/</span> <span class="fu">sum</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb226-19"><a href="#cb226-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb226-20"><a href="#cb226-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-21"><a href="#cb226-21" aria-hidden="true" tabindex="-1"></a>layout_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb226-22"><a href="#cb226-22" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(layout_matrix)</span>
<span id="cb226-23"><a href="#cb226-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb226-24"><a href="#cb226-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb226-25"><a href="#cb226-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-26"><a href="#cb226-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb226-27"><a href="#cb226-27" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb226-28"><a href="#cb226-28" aria-hidden="true" tabindex="-1"></a>  beta_baseline <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb226-29"><a href="#cb226-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-30"><a href="#cb226-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">6</span>), <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>),</span>
<span id="cb226-31"><a href="#cb226-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">axes =</span> <span class="cn">FALSE</span>)</span>
<span id="cb226-32"><a href="#cb226-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-33"><a href="#cb226-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">tck =</span> <span class="sc">-</span><span class="fl">0.02</span>, <span class="at">cex.axis =</span> <span class="fl">0.7</span>)</span>
<span id="cb226-34"><a href="#cb226-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>),</span>
<span id="cb226-35"><a href="#cb226-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">tck =</span> <span class="sc">-</span><span class="fl">0.02</span>, <span class="at">cex.axis =</span> <span class="fl">0.7</span>, <span class="at">las =</span> <span class="dv">1</span>)</span>
<span id="cb226-36"><a href="#cb226-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">"Decision"</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb226-37"><a href="#cb226-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">"Proportion"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb226-38"><a href="#cb226-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-39"><a href="#cb226-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- model predictions (NOT averaged) ---</span></span>
<span id="cb226-40"><a href="#cb226-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list[[cond]],      <span class="at">col =</span> <span class="st">"green"</span>,     <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># NB (first of pair)</span></span>
<span id="cb226-41"><a href="#cb226-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lines(x, integral_list[[cond + 8]],  col = "green",     lwd = 2, lty = 2)  # NB (counterbalanced mate)</span></span>
<span id="cb226-42"><a href="#cb226-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-43"><a href="#cb226-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list2[[cond]],     <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># MV (first)</span></span>
<span id="cb226-44"><a href="#cb226-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lines(x, integral_list2[[cond + 8]], col = "lightblue", lwd = 2, lty = 2)  # MV (mate)</span></span>
<span id="cb226-45"><a href="#cb226-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-46"><a href="#cb226-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list4[[cond]],     <span class="at">col =</span> <span class="st">"red"</span>,       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># EF (first)</span></span>
<span id="cb226-47"><a href="#cb226-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lines(x, integral_list4[[cond + 8]], col = "red",       lwd = 2, lty = 2)  # EF (mate)</span></span>
<span id="cb226-48"><a href="#cb226-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-49"><a href="#cb226-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, beta_baseline,              <span class="at">col =</span> <span class="st">"grey"</span>,      <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># Uniform prior</span></span>
<span id="cb226-50"><a href="#cb226-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-51"><a href="#cb226-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- observed bars (collapsed) ---</span></span>
<span id="cb226-52"><a href="#cb226-52" aria-hidden="true" tabindex="-1"></a>  which_list <span class="ot">&lt;-</span> all_data_collapsed <span class="sc">%&gt;%</span></span>
<span id="cb226-53"><a href="#cb226-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(collapsed <span class="sc">==</span> cond) <span class="sc">%&gt;%</span></span>
<span id="cb226-54"><a href="#cb226-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(d)</span>
<span id="cb226-55"><a href="#cb226-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-56"><a href="#cb226-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb226-57"><a href="#cb226-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rect</span>(</span>
<span id="cb226-58"><a href="#cb226-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">xleft  =</span> j <span class="sc">-</span> <span class="fl">0.4</span>,</span>
<span id="cb226-59"><a href="#cb226-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">xright =</span> j <span class="sc">+</span> <span class="fl">0.4</span>,</span>
<span id="cb226-60"><a href="#cb226-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">ybottom =</span> <span class="dv">0</span>,</span>
<span id="cb226-61"><a href="#cb226-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">ytop    =</span> which_list<span class="sc">$</span>proportion[j],</span>
<span id="cb226-62"><a href="#cb226-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb226-63"><a href="#cb226-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span></span>
<span id="cb226-64"><a href="#cb226-64" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb226-65"><a href="#cb226-65" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb226-66"><a href="#cb226-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-67"><a href="#cb226-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">"Cond"</span>, cond, <span class="st">"(="</span>, cond, <span class="st">"&amp;"</span>, cond <span class="sc">+</span> <span class="dv">8</span>, <span class="st">")"</span>), <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">0.5</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb226-68"><a href="#cb226-68" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Legend ----</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"center"</span>,</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"NB (first)"</span>, <span class="st">"NB (mate)"</span>,</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"MV (first)"</span>, <span class="st">"MV (mate)"</span>,</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"EF (first)"</span>, <span class="st">"EF (mate)"</span>,</span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Observed (collapsed)"</span>, <span class="st">"Uniform Prior"</span>),</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"green"</span>, <span class="st">"green"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightblue"</span>, <span class="st">"red"</span>, <span class="st">"red"</span>, <span class="fu">rgb</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>), <span class="st">"grey"</span>),</span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">2</span>),</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">15</span>, <span class="cn">NA</span>),</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.cex =</span> <span class="dv">2</span>,</span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>layout_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(layout_matrix)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cond <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a>  beta_baseline <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">plot</span>(</span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>    x, integral_list[[cond]],</span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">6.5</span>),</span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">""</span>, <span class="at">ylab =</span> <span class="st">""</span>, <span class="at">axes =</span> <span class="cn">FALSE</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">cex.axis =</span> <span class="fl">0.85</span>, <span class="at">lwd =</span> <span class="fl">0.8</span>, <span class="at">lwd.ticks =</span> <span class="fl">0.8</span>)</span>
<span id="cb228-17"><a href="#cb228-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>),</span>
<span id="cb228-18"><a href="#cb228-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex.axis =</span> <span class="fl">0.85</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">0.8</span>, <span class="at">lwd.ticks =</span> <span class="fl">0.8</span>)</span>
<span id="cb228-19"><a href="#cb228-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-20"><a href="#cb228-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">" "</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">1.2</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb228-21"><a href="#cb228-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="st">"Proportion"</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="fl">1.4</span>, <span class="at">cex =</span> <span class="fl">0.9</span>)</span>
<span id="cb228-22"><a href="#cb228-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-23"><a href="#cb228-23" aria-hidden="true" tabindex="-1"></a>   <span class="co"># Full frame (box)</span></span>
<span id="cb228-24"><a href="#cb228-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">box</span>(<span class="at">lwd =</span> <span class="fl">0.8</span>)</span>
<span id="cb228-25"><a href="#cb228-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-26"><a href="#cb228-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-27"><a href="#cb228-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- model predictions (NOT averaged) ---</span></span>
<span id="cb228-28"><a href="#cb228-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list[[cond]],      <span class="at">col =</span> <span class="st">"gold"</span>,     <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># NB (first of pair)</span></span>
<span id="cb228-29"><a href="#cb228-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lines(x, integral_list[[cond + 8]],  col = "green",     lwd = 2, lty = 2)  # NB (counterbalanced mate)</span></span>
<span id="cb228-30"><a href="#cb228-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-31"><a href="#cb228-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list2[[cond]],     <span class="at">col =</span> <span class="st">"#00A86B"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># MV (first)</span></span>
<span id="cb228-32"><a href="#cb228-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lines(x, integral_list2[[cond + 8]], col = "lightblue", lwd = 2, lty = 2)  # MV (mate)</span></span>
<span id="cb228-33"><a href="#cb228-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-34"><a href="#cb228-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, integral_list4[[cond]],     <span class="at">col =</span> <span class="st">"#DAB1DA"</span>,       <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">1</span>)  <span class="co"># EF (first)</span></span>
<span id="cb228-35"><a href="#cb228-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#lines(x, integral_list4[[cond + 8]], col = "red",       lwd = 2, lty = 2)  # EF (mate)</span></span>
<span id="cb228-36"><a href="#cb228-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-37"><a href="#cb228-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, beta_baseline,              <span class="at">col =</span> <span class="st">"grey"</span>,      <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># Uniform prior</span></span>
<span id="cb228-38"><a href="#cb228-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-39"><a href="#cb228-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># --- observed bars (collapsed) ---</span></span>
<span id="cb228-40"><a href="#cb228-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb228-41"><a href="#cb228-41" aria-hidden="true" tabindex="-1"></a>  which_list <span class="ot">&lt;-</span> all_data_collapsed <span class="sc">%&gt;%</span></span>
<span id="cb228-42"><a href="#cb228-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(collapsed <span class="sc">==</span> cond) <span class="sc">%&gt;%</span></span>
<span id="cb228-43"><a href="#cb228-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(d)</span>
<span id="cb228-44"><a href="#cb228-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-45"><a href="#cb228-45" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb228-46"><a href="#cb228-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rect</span>(</span>
<span id="cb228-47"><a href="#cb228-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">xleft  =</span> j <span class="sc">-</span> <span class="fl">0.38</span>,</span>
<span id="cb228-48"><a href="#cb228-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">xright =</span> j <span class="sc">+</span> <span class="fl">0.38</span>,</span>
<span id="cb228-49"><a href="#cb228-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">ybottom =</span> <span class="dv">0</span>,</span>
<span id="cb228-50"><a href="#cb228-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">ytop    =</span> which_list<span class="sc">$</span>proportion[j],</span>
<span id="cb228-51"><a href="#cb228-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="fu">rgb</span>(<span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>, <span class="fl">0.35</span>),  <span class="co"># light gray fill</span></span>
<span id="cb228-52"><a href="#cb228-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">border =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">0.6</span></span>
<span id="cb228-53"><a href="#cb228-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb228-54"><a href="#cb228-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb228-55"><a href="#cb228-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-56"><a href="#cb228-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mtext</span>(<span class="fu">paste</span>(<span class="st">"Cond"</span>, cond, <span class="st">"(="</span>, cond, <span class="st">"&amp;"</span>, cond <span class="sc">+</span> <span class="dv">8</span>, <span class="st">")"</span>), <span class="at">side =</span> <span class="dv">3</span>, <span class="at">line =</span> <span class="fl">0.5</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb228-57"><a href="#cb228-57" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Legend ----</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"center"</span>,</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"NB"</span>, </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"MV"</span>,</span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>             <span class="st">"DW"</span>,</span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>             <span class="st">"Baseline"</span>),</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>( <span class="st">"gold"</span>, <span class="st">"#00A86B"</span>, <span class="st">"#DAB1DA"</span>, <span class="st">"grey"</span>),</span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb229-13"><a href="#cb229-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">pt.cex =</span> <span class="dv">2</span>,</span>
<span id="cb229-14"><a href="#cb229-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span></span>
<span id="cb229-15"><a href="#cb229-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>w_list_nb <span class="ot">&lt;-</span> <span class="fu">w_list3</span>(<span class="dv">100</span>)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>w_list_nb <span class="ot">&lt;-</span> w_list_nb [<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>]</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>w_list_mv <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>w_list_mv </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25 0.75 0.50 0.50 0.25 0.75 0.25 0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">2</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>w_list_ef <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(footgain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain)<span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain<span class="sc">+</span>footgain)<span class="sc">*</span>n),(<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(eargain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n), (<span class="dv">1</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">+</span>(footgain)<span class="sc">*</span><span class="dv">2</span><span class="sc">*</span>n))</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>w_list_ef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2500000 0.7500000 0.4000000 0.6000000 0.2083333 0.7916667 0.3125000
[8] 0.6875000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the values for each list</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>))  <span class="co"># Arrange plots in 2 rows, 4 columns</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through indices 1 to 8</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">height =</span> <span class="fu">c</span>(w_list_nb[i], w_list_mv[i], w_list_ef[i]),</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">beside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rgb</span>(<span class="dv">255</span>, <span class="dv">215</span>, <span class="dv">0</span>,   <span class="at">alpha =</span> <span class="dv">150</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>),   <span class="co"># gold</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">168</span>, <span class="dv">107</span>,  <span class="at">alpha =</span> <span class="dv">150</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>),   <span class="co"># green</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rgb</span>(<span class="dv">218</span>, <span class="dv">177</span>, <span class="dv">218</span>, <span class="at">alpha =</span> <span class="dv">150</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>) </span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="st">"NB"</span>, <span class="st">"MV"</span>, <span class="st">"DW"</span>),</span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Plot"</span>, i),</span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>),</span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">box</span>(<span class="at">lwd =</span> <span class="dv">1</span>)  <span class="co"># add frame</span></span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="data_analysis-tau-for-social-agent-exp3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>